[2024-10-05 17:53:44,558] INFO database_accessor.py execute_cmd :
[cmd] cp mkdb_acropora.conf /home/data/acropora_db/
[2024-10-05 17:53:44,561] INFO database_accessor.py logging_title :

########################
#### load fastq dir ####
########################
[2024-10-05 17:53:44,562] INFO database_accessor.py logging_title :

#################################
#### quality control : fastq ####
#################################
[2024-10-05 17:53:44,562] INFO database_accessor.py quality_control :
Processing sample: AS_ASTUS31_S161
[2024-10-05 17:53:44,562] INFO database_accessor.py execute_cmd :
[cmd] fastp -i /home/data/acropora/AS_ASTUS31_S161_L001_R1_001.fastq.gz -I /home/data/acropora/AS_ASTUS31_S161_L001_R2_001.fastq.gz -o /home/data/acropora_db/quality_control/AS_ASTUS31_S161_qc_R1.fastq.gz -O /home/data/acropora_db/quality_control/AS_ASTUS31_S161_qc_R2.fastq.gz -q 30 -f 0 -F 15 --cut_right --thread 8 --json /home/data/acropora_db/quality_control/AS_ASTUS31_S161_fastp.json --html /home/data/acropora_db/quality_control/AS_ASTUS31_S161_fastp.html
[2024-10-05 17:53:45,139] INFO database_accessor.py execute_cmd :
Read1 before filtering:
total reads: 162226
total bases: 12978080
Q20 bases: 12762049(98.3354%)
Q30 bases: 12317675(94.9114%)

Read2 before filtering:
total reads: 162226
total bases: 15249244
Q20 bases: 14935119(97.9401%)
Q30 bases: 14342176(94.0517%)

Read1 after filtering:
total reads: 158521
total bases: 12084495
Q20 bases: 11964325(99.0056%)
Q30 bases: 11633921(96.2715%)

Read2 after filtering:
total reads: 158521
total bases: 11411898
Q20 bases: 11287906(98.9135%)
Q30 bases: 10913654(95.634%)

Filtering result:
reads passed filter: 317042
reads failed due to low quality: 2624
reads failed due to too many N: 0
reads failed due to too short: 4786
reads with adapter trimmed: 58926
bases trimmed due to adapters: 1142077

Duplication rate: 56.3621%

Insert size peak (evaluated by paired-end reads): 95

JSON report: /home/data/acropora_db/quality_control/AS_ASTUS31_S161_fastp.json
HTML report: /home/data/acropora_db/quality_control/AS_ASTUS31_S161_fastp.html

fastp -i /home/data/acropora/AS_ASTUS31_S161_L001_R1_001.fastq.gz -I /home/data/acropora/AS_ASTUS31_S161_L001_R2_001.fastq.gz -o /home/data/acropora_db/quality_control/AS_ASTUS31_S161_qc_R1.fastq.gz -O /home/data/acropora_db/quality_control/AS_ASTUS31_S161_qc_R2.fastq.gz -q 30 -f 0 -F 15 --cut_right --thread 8 --json /home/data/acropora_db/quality_control/AS_ASTUS31_S161_fastp.json --html /home/data/acropora_db/quality_control/AS_ASTUS31_S161_fastp.html 
fastp v0.23.4, time used: 1 seconds

[2024-10-05 17:53:45,139] WARNING database_accessor.py quality_control :
fastp for AS_ASTUS31_S161 produced warnings: Read1 before filtering:
total reads: 162226
total bases: 12978080
Q20 bases: 12762049(98.3354%)
Q30 bases: 12317675(94.9114%)

Read2 before filtering:
total reads: 162226
total bases: 15249244
Q20 bases: 14935119(97.9401%)
Q30 bases: 14342176(94.0517%)

Read1 after filtering:
total reads: 158521
total bases: 12084495
Q20 bases: 11964325(99.0056%)
Q30 bases: 11633921(96.2715%)

Read2 after filtering:
total reads: 158521
total bases: 11411898
Q20 bases: 11287906(98.9135%)
Q30 bases: 10913654(95.634%)

Filtering result:
reads passed filter: 317042
reads failed due to low quality: 2624
reads failed due to too many N: 0
reads failed due to too short: 4786
reads with adapter trimmed: 58926
bases trimmed due to adapters: 1142077

Duplication rate: 56.3621%

Insert size peak (evaluated by paired-end reads): 95

JSON report: /home/data/acropora_db/quality_control/AS_ASTUS31_S161_fastp.json
HTML report: /home/data/acropora_db/quality_control/AS_ASTUS31_S161_fastp.html

fastp -i /home/data/acropora/AS_ASTUS31_S161_L001_R1_001.fastq.gz -I /home/data/acropora/AS_ASTUS31_S161_L001_R2_001.fastq.gz -o /home/data/acropora_db/quality_control/AS_ASTUS31_S161_qc_R1.fastq.gz -O /home/data/acropora_db/quality_control/AS_ASTUS31_S161_qc_R2.fastq.gz -q 30 -f 0 -F 15 --cut_right --thread 8 --json /home/data/acropora_db/quality_control/AS_ASTUS31_S161_fastp.json --html /home/data/acropora_db/quality_control/AS_ASTUS31_S161_fastp.html 
fastp v0.23.4, time used: 1 seconds

[2024-10-05 17:53:45,139] INFO database_accessor.py quality_control :
Finished processing sample: AS_ASTUS31_S161
[2024-10-05 17:53:45,139] INFO database_accessor.py quality_control :
Processing sample: AP_TS1_S1
[2024-10-05 17:53:45,139] INFO database_accessor.py execute_cmd :
[cmd] fastp -i /home/data/acropora/AP_TS1_S1_L001_R1_001.fastq.gz -I /home/data/acropora/AP_TS1_S1_L001_R2_001.fastq.gz -o /home/data/acropora_db/quality_control/AP_TS1_S1_qc_R1.fastq.gz -O /home/data/acropora_db/quality_control/AP_TS1_S1_qc_R2.fastq.gz -q 30 -f 0 -F 15 --cut_right --thread 8 --json /home/data/acropora_db/quality_control/AP_TS1_S1_fastp.json --html /home/data/acropora_db/quality_control/AP_TS1_S1_fastp.html
[2024-10-05 17:53:45,920] INFO database_accessor.py execute_cmd :
Read1 before filtering:
total reads: 248601
total bases: 19888080
Q20 bases: 19480257(97.9494%)
Q30 bases: 18588142(93.4637%)

Read2 before filtering:
total reads: 248601
total bases: 23617095
Q20 bases: 22812090(96.5914%)
Q30 bases: 21475937(90.9339%)

Read1 after filtering:
total reads: 231712
total bases: 17580299
Q20 bases: 17414800(99.0586%)
Q30 bases: 16830589(95.7355%)

Read2 after filtering:
total reads: 231712
total bases: 16739640
Q20 bases: 16514648(98.6559%)
Q30 bases: 15824490(94.533%)

Filtering result:
reads passed filter: 463424
reads failed due to low quality: 12162
reads failed due to too many N: 0
reads failed due to too short: 21616
reads with adapter trimmed: 99544
bases trimmed due to adapters: 1530502

Duplication rate: 64.4881%

Insert size peak (evaluated by paired-end reads): 71

JSON report: /home/data/acropora_db/quality_control/AP_TS1_S1_fastp.json
HTML report: /home/data/acropora_db/quality_control/AP_TS1_S1_fastp.html

fastp -i /home/data/acropora/AP_TS1_S1_L001_R1_001.fastq.gz -I /home/data/acropora/AP_TS1_S1_L001_R2_001.fastq.gz -o /home/data/acropora_db/quality_control/AP_TS1_S1_qc_R1.fastq.gz -O /home/data/acropora_db/quality_control/AP_TS1_S1_qc_R2.fastq.gz -q 30 -f 0 -F 15 --cut_right --thread 8 --json /home/data/acropora_db/quality_control/AP_TS1_S1_fastp.json --html /home/data/acropora_db/quality_control/AP_TS1_S1_fastp.html 
fastp v0.23.4, time used: 0 seconds

[2024-10-05 17:53:45,920] WARNING database_accessor.py quality_control :
fastp for AP_TS1_S1 produced warnings: Read1 before filtering:
total reads: 248601
total bases: 19888080
Q20 bases: 19480257(97.9494%)
Q30 bases: 18588142(93.4637%)

Read2 before filtering:
total reads: 248601
total bases: 23617095
Q20 bases: 22812090(96.5914%)
Q30 bases: 21475937(90.9339%)

Read1 after filtering:
total reads: 231712
total bases: 17580299
Q20 bases: 17414800(99.0586%)
Q30 bases: 16830589(95.7355%)

Read2 after filtering:
total reads: 231712
total bases: 16739640
Q20 bases: 16514648(98.6559%)
Q30 bases: 15824490(94.533%)

Filtering result:
reads passed filter: 463424
reads failed due to low quality: 12162
reads failed due to too many N: 0
reads failed due to too short: 21616
reads with adapter trimmed: 99544
bases trimmed due to adapters: 1530502

Duplication rate: 64.4881%

Insert size peak (evaluated by paired-end reads): 71

JSON report: /home/data/acropora_db/quality_control/AP_TS1_S1_fastp.json
HTML report: /home/data/acropora_db/quality_control/AP_TS1_S1_fastp.html

fastp -i /home/data/acropora/AP_TS1_S1_L001_R1_001.fastq.gz -I /home/data/acropora/AP_TS1_S1_L001_R2_001.fastq.gz -o /home/data/acropora_db/quality_control/AP_TS1_S1_qc_R1.fastq.gz -O /home/data/acropora_db/quality_control/AP_TS1_S1_qc_R2.fastq.gz -q 30 -f 0 -F 15 --cut_right --thread 8 --json /home/data/acropora_db/quality_control/AP_TS1_S1_fastp.json --html /home/data/acropora_db/quality_control/AP_TS1_S1_fastp.html 
fastp v0.23.4, time used: 0 seconds

[2024-10-05 17:53:45,920] INFO database_accessor.py quality_control :
Finished processing sample: AP_TS1_S1
[2024-10-05 17:53:45,920] INFO database_accessor.py quality_control :
Processing sample: AG_GAs11-67_S67
[2024-10-05 17:53:45,920] INFO database_accessor.py execute_cmd :
[cmd] fastp -i /home/data/acropora/AG_GAs11-67_S67_L001_R1_001.fastq.gz -I /home/data/acropora/AG_GAs11-67_S67_L001_R2_001.fastq.gz -o /home/data/acropora_db/quality_control/AG_GAs11-67_S67_qc_R1.fastq.gz -O /home/data/acropora_db/quality_control/AG_GAs11-67_S67_qc_R2.fastq.gz -q 30 -f 0 -F 15 --cut_right --thread 8 --json /home/data/acropora_db/quality_control/AG_GAs11-67_S67_fastp.json --html /home/data/acropora_db/quality_control/AG_GAs11-67_S67_fastp.html
[2024-10-05 17:53:46,404] INFO database_accessor.py execute_cmd :
Read1 before filtering:
total reads: 82521
total bases: 6601680
Q20 bases: 6416163(97.1899%)
Q30 bases: 6082997(92.1432%)

Read2 before filtering:
total reads: 82521
total bases: 7756974
Q20 bases: 7322026(94.3928%)
Q30 bases: 6779442(87.398%)

Read1 after filtering:
total reads: 79298
total bases: 5996604
Q20 bases: 5914403(98.6292%)
Q30 bases: 5679288(94.7084%)

Read2 after filtering:
total reads: 79298
total bases: 5490991
Q20 bases: 5383923(98.0501%)
Q30 bases: 5084929(92.6049%)

Filtering result:
reads passed filter: 158596
reads failed due to low quality: 2226
reads failed due to too many N: 0
reads failed due to too short: 4220
reads with adapter trimmed: 15980
bases trimmed due to adapters: 278157

Duplication rate: 41.8899%

Insert size peak (evaluated by paired-end reads): 64

JSON report: /home/data/acropora_db/quality_control/AG_GAs11-67_S67_fastp.json
HTML report: /home/data/acropora_db/quality_control/AG_GAs11-67_S67_fastp.html

fastp -i /home/data/acropora/AG_GAs11-67_S67_L001_R1_001.fastq.gz -I /home/data/acropora/AG_GAs11-67_S67_L001_R2_001.fastq.gz -o /home/data/acropora_db/quality_control/AG_GAs11-67_S67_qc_R1.fastq.gz -O /home/data/acropora_db/quality_control/AG_GAs11-67_S67_qc_R2.fastq.gz -q 30 -f 0 -F 15 --cut_right --thread 8 --json /home/data/acropora_db/quality_control/AG_GAs11-67_S67_fastp.json --html /home/data/acropora_db/quality_control/AG_GAs11-67_S67_fastp.html 
fastp v0.23.4, time used: 1 seconds

[2024-10-05 17:53:46,404] WARNING database_accessor.py quality_control :
fastp for AG_GAs11-67_S67 produced warnings: Read1 before filtering:
total reads: 82521
total bases: 6601680
Q20 bases: 6416163(97.1899%)
Q30 bases: 6082997(92.1432%)

Read2 before filtering:
total reads: 82521
total bases: 7756974
Q20 bases: 7322026(94.3928%)
Q30 bases: 6779442(87.398%)

Read1 after filtering:
total reads: 79298
total bases: 5996604
Q20 bases: 5914403(98.6292%)
Q30 bases: 5679288(94.7084%)

Read2 after filtering:
total reads: 79298
total bases: 5490991
Q20 bases: 5383923(98.0501%)
Q30 bases: 5084929(92.6049%)

Filtering result:
reads passed filter: 158596
reads failed due to low quality: 2226
reads failed due to too many N: 0
reads failed due to too short: 4220
reads with adapter trimmed: 15980
bases trimmed due to adapters: 278157

Duplication rate: 41.8899%

Insert size peak (evaluated by paired-end reads): 64

JSON report: /home/data/acropora_db/quality_control/AG_GAs11-67_S67_fastp.json
HTML report: /home/data/acropora_db/quality_control/AG_GAs11-67_S67_fastp.html

fastp -i /home/data/acropora/AG_GAs11-67_S67_L001_R1_001.fastq.gz -I /home/data/acropora/AG_GAs11-67_S67_L001_R2_001.fastq.gz -o /home/data/acropora_db/quality_control/AG_GAs11-67_S67_qc_R1.fastq.gz -O /home/data/acropora_db/quality_control/AG_GAs11-67_S67_qc_R2.fastq.gz -q 30 -f 0 -F 15 --cut_right --thread 8 --json /home/data/acropora_db/quality_control/AG_GAs11-67_S67_fastp.json --html /home/data/acropora_db/quality_control/AG_GAs11-67_S67_fastp.html 
fastp v0.23.4, time used: 1 seconds

[2024-10-05 17:53:46,404] INFO database_accessor.py quality_control :
Finished processing sample: AG_GAs11-67_S67
[2024-10-05 17:53:46,405] INFO database_accessor.py quality_control :
Processing sample: AM_A-1_S33
[2024-10-05 17:53:46,405] INFO database_accessor.py execute_cmd :
[cmd] fastp -i /home/data/acropora/AM_A-1_S33_L001_R1_001.fastq.gz -I /home/data/acropora/AM_A-1_S33_L001_R2_001.fastq.gz -o /home/data/acropora_db/quality_control/AM_A-1_S33_qc_R1.fastq.gz -O /home/data/acropora_db/quality_control/AM_A-1_S33_qc_R2.fastq.gz -q 30 -f 0 -F 15 --cut_right --thread 8 --json /home/data/acropora_db/quality_control/AM_A-1_S33_fastp.json --html /home/data/acropora_db/quality_control/AM_A-1_S33_fastp.html
[2024-10-05 17:53:46,893] INFO database_accessor.py execute_cmd :
Read1 before filtering:
total reads: 97107
total bases: 7768560
Q20 bases: 7647822(98.4458%)
Q30 bases: 7362598(94.7743%)

Read2 before filtering:
total reads: 97107
total bases: 9128058
Q20 bases: 8907264(97.5812%)
Q30 bases: 8496983(93.0864%)

Read1 after filtering:
total reads: 93866
total bases: 7066298
Q20 bases: 7008421(99.1809%)
Q30 bases: 6804930(96.3012%)

Read2 after filtering:
total reads: 93866
total bases: 6587867
Q20 bases: 6517391(98.9302%)
Q30 bases: 6285324(95.4076%)

Filtering result:
reads passed filter: 187732
reads failed due to low quality: 2370
reads failed due to too many N: 0
reads failed due to too short: 4112
reads with adapter trimmed: 50244
bases trimmed due to adapters: 883198

Duplication rate: 53.0343%

Insert size peak (evaluated by paired-end reads): 57

JSON report: /home/data/acropora_db/quality_control/AM_A-1_S33_fastp.json
HTML report: /home/data/acropora_db/quality_control/AM_A-1_S33_fastp.html

fastp -i /home/data/acropora/AM_A-1_S33_L001_R1_001.fastq.gz -I /home/data/acropora/AM_A-1_S33_L001_R2_001.fastq.gz -o /home/data/acropora_db/quality_control/AM_A-1_S33_qc_R1.fastq.gz -O /home/data/acropora_db/quality_control/AM_A-1_S33_qc_R2.fastq.gz -q 30 -f 0 -F 15 --cut_right --thread 8 --json /home/data/acropora_db/quality_control/AM_A-1_S33_fastp.json --html /home/data/acropora_db/quality_control/AM_A-1_S33_fastp.html 
fastp v0.23.4, time used: 0 seconds

[2024-10-05 17:53:46,893] WARNING database_accessor.py quality_control :
fastp for AM_A-1_S33 produced warnings: Read1 before filtering:
total reads: 97107
total bases: 7768560
Q20 bases: 7647822(98.4458%)
Q30 bases: 7362598(94.7743%)

Read2 before filtering:
total reads: 97107
total bases: 9128058
Q20 bases: 8907264(97.5812%)
Q30 bases: 8496983(93.0864%)

Read1 after filtering:
total reads: 93866
total bases: 7066298
Q20 bases: 7008421(99.1809%)
Q30 bases: 6804930(96.3012%)

Read2 after filtering:
total reads: 93866
total bases: 6587867
Q20 bases: 6517391(98.9302%)
Q30 bases: 6285324(95.4076%)

Filtering result:
reads passed filter: 187732
reads failed due to low quality: 2370
reads failed due to too many N: 0
reads failed due to too short: 4112
reads with adapter trimmed: 50244
bases trimmed due to adapters: 883198

Duplication rate: 53.0343%

Insert size peak (evaluated by paired-end reads): 57

JSON report: /home/data/acropora_db/quality_control/AM_A-1_S33_fastp.json
HTML report: /home/data/acropora_db/quality_control/AM_A-1_S33_fastp.html

fastp -i /home/data/acropora/AM_A-1_S33_L001_R1_001.fastq.gz -I /home/data/acropora/AM_A-1_S33_L001_R2_001.fastq.gz -o /home/data/acropora_db/quality_control/AM_A-1_S33_qc_R1.fastq.gz -O /home/data/acropora_db/quality_control/AM_A-1_S33_qc_R2.fastq.gz -q 30 -f 0 -F 15 --cut_right --thread 8 --json /home/data/acropora_db/quality_control/AM_A-1_S33_fastp.json --html /home/data/acropora_db/quality_control/AM_A-1_S33_fastp.html 
fastp v0.23.4, time used: 0 seconds

[2024-10-05 17:53:46,893] INFO database_accessor.py quality_control :
Finished processing sample: AM_A-1_S33
[2024-10-05 17:53:46,893] INFO database_accessor.py quality_control :
Quality control completed for all samples
[2024-10-05 17:53:46,893] INFO database_accessor.py logging_title :

####################
#### 接头修剪：fastq ####
####################
[2024-10-05 17:53:46,894] INFO database_accessor.py execute_cmd :
[cmd] fastp -i /home/data/acropora_db/quality_control/AS_ASTUS31_S161_qc_R1.fastq.gz -I /home/data/acropora_db/quality_control/AS_ASTUS31_S161_qc_R2.fastq.gz -o /home/data/acropora_db/adapter_trim/AS_ASTUS31_S161_at_R1.fastq.gz -O /home/data/acropora_db/adapter_trim/AS_ASTUS31_S161_at_R2.fastq.gz --adapter_sequence GTCAGATCGGAAGAGCACACGTCTGAACTCCAGTCAC --adapter_sequence_r2 CAGAGATCGGAAGAGCGTCGTGTAGGGAAAGAC --cut_right --cut_window_size 4 --cut_mean_quality 20 --length_required 36 --length_limit 150 --average_qual 19 --thread 8 --json /home/data/acropora_db/adapter_trim/AS_ASTUS31_S161_fastp.json --html /home/data/acropora_db/adapter_trim/AS_ASTUS31_S161_fastp.html
[2024-10-05 17:53:47,419] INFO database_accessor.py execute_cmd :
Read1 before filtering:
total reads: 158521
total bases: 12084495
Q20 bases: 11964325(99.0056%)
Q30 bases: 11633921(96.2715%)

Read2 before filtering:
total reads: 158521
total bases: 11411898
Q20 bases: 11287906(98.9135%)
Q30 bases: 10913654(95.634%)

Read1 after filtering:
total reads: 79051
total bases: 5841951
Q20 bases: 5798389(99.2543%)
Q30 bases: 5670180(97.0597%)

Read2 after filtering:
total reads: 79051
total bases: 5438862
Q20 bases: 5399343(99.2734%)
Q30 bases: 5262418(96.7559%)

Filtering result:
reads passed filter: 158102
reads failed due to low quality: 0
reads failed due to too many N: 0
reads failed due to too short: 158940
reads failed due to too long: 0
reads with adapter trimmed: 154518
bases trimmed due to adapters: 8207681

Duplication rate: 58.0768%

Insert size peak (evaluated by paired-end reads): 80

JSON report: /home/data/acropora_db/adapter_trim/AS_ASTUS31_S161_fastp.json
HTML report: /home/data/acropora_db/adapter_trim/AS_ASTUS31_S161_fastp.html

fastp -i /home/data/acropora_db/quality_control/AS_ASTUS31_S161_qc_R1.fastq.gz -I /home/data/acropora_db/quality_control/AS_ASTUS31_S161_qc_R2.fastq.gz -o /home/data/acropora_db/adapter_trim/AS_ASTUS31_S161_at_R1.fastq.gz -O /home/data/acropora_db/adapter_trim/AS_ASTUS31_S161_at_R2.fastq.gz --adapter_sequence GTCAGATCGGAAGAGCACACGTCTGAACTCCAGTCAC --adapter_sequence_r2 CAGAGATCGGAAGAGCGTCGTGTAGGGAAAGAC --cut_right --cut_window_size 4 --cut_mean_quality 20 --length_required 36 --length_limit 150 --average_qual 19 --thread 8 --json /home/data/acropora_db/adapter_trim/AS_ASTUS31_S161_fastp.json --html /home/data/acropora_db/adapter_trim/AS_ASTUS31_S161_fastp.html 
fastp v0.23.4, time used: 1 seconds

[2024-10-05 17:53:47,420] INFO database_accessor.py execute_cmd :
[cmd] fastp -i /home/data/acropora_db/quality_control/AP_TS1_S1_qc_R1.fastq.gz -I /home/data/acropora_db/quality_control/AP_TS1_S1_qc_R2.fastq.gz -o /home/data/acropora_db/adapter_trim/AP_TS1_S1_at_R1.fastq.gz -O /home/data/acropora_db/adapter_trim/AP_TS1_S1_at_R2.fastq.gz --adapter_sequence GTCAGATCGGAAGAGCACACGTCTGAACTCCAGTCAC --adapter_sequence_r2 CAGAGATCGGAAGAGCGTCGTGTAGGGAAAGAC --cut_right --cut_window_size 4 --cut_mean_quality 20 --length_required 36 --length_limit 150 --average_qual 19 --thread 8 --json /home/data/acropora_db/adapter_trim/AP_TS1_S1_fastp.json --html /home/data/acropora_db/adapter_trim/AP_TS1_S1_fastp.html
[2024-10-05 17:53:48,021] INFO database_accessor.py execute_cmd :
Read1 before filtering:
total reads: 231712
total bases: 17580299
Q20 bases: 17414800(99.0586%)
Q30 bases: 16830589(95.7355%)

Read2 before filtering:
total reads: 231712
total bases: 16739640
Q20 bases: 16514648(98.6559%)
Q30 bases: 15824490(94.533%)

Read1 after filtering:
total reads: 119529
total bases: 8749001
Q20 bases: 8688635(99.31%)
Q30 bases: 8447878(96.5582%)

Read2 after filtering:
total reads: 119529
total bases: 8129678
Q20 bases: 8057783(99.1156%)
Q30 bases: 7796800(95.9054%)

Filtering result:
reads passed filter: 239058
reads failed due to low quality: 20
reads failed due to too many N: 0
reads failed due to too short: 224346
reads failed due to too long: 0
reads with adapter trimmed: 223016
bases trimmed due to adapters: 11817632

Duplication rate: 68.6382%

Insert size peak (evaluated by paired-end reads): 56

JSON report: /home/data/acropora_db/adapter_trim/AP_TS1_S1_fastp.json
HTML report: /home/data/acropora_db/adapter_trim/AP_TS1_S1_fastp.html

fastp -i /home/data/acropora_db/quality_control/AP_TS1_S1_qc_R1.fastq.gz -I /home/data/acropora_db/quality_control/AP_TS1_S1_qc_R2.fastq.gz -o /home/data/acropora_db/adapter_trim/AP_TS1_S1_at_R1.fastq.gz -O /home/data/acropora_db/adapter_trim/AP_TS1_S1_at_R2.fastq.gz --adapter_sequence GTCAGATCGGAAGAGCACACGTCTGAACTCCAGTCAC --adapter_sequence_r2 CAGAGATCGGAAGAGCGTCGTGTAGGGAAAGAC --cut_right --cut_window_size 4 --cut_mean_quality 20 --length_required 36 --length_limit 150 --average_qual 19 --thread 8 --json /home/data/acropora_db/adapter_trim/AP_TS1_S1_fastp.json --html /home/data/acropora_db/adapter_trim/AP_TS1_S1_fastp.html 
fastp v0.23.4, time used: 1 seconds

[2024-10-05 17:53:48,021] INFO database_accessor.py execute_cmd :
[cmd] fastp -i /home/data/acropora_db/quality_control/AG_GAs11-67_S67_qc_R1.fastq.gz -I /home/data/acropora_db/quality_control/AG_GAs11-67_S67_qc_R2.fastq.gz -o /home/data/acropora_db/adapter_trim/AG_GAs11-67_S67_at_R1.fastq.gz -O /home/data/acropora_db/adapter_trim/AG_GAs11-67_S67_at_R2.fastq.gz --adapter_sequence GTCAGATCGGAAGAGCACACGTCTGAACTCCAGTCAC --adapter_sequence_r2 CAGAGATCGGAAGAGCGTCGTGTAGGGAAAGAC --cut_right --cut_window_size 4 --cut_mean_quality 20 --length_required 36 --length_limit 150 --average_qual 19 --thread 8 --json /home/data/acropora_db/adapter_trim/AG_GAs11-67_S67_fastp.json --html /home/data/acropora_db/adapter_trim/AG_GAs11-67_S67_fastp.html
[2024-10-05 17:53:48,420] INFO database_accessor.py execute_cmd :
Read1 before filtering:
total reads: 79298
total bases: 5996604
Q20 bases: 5914403(98.6292%)
Q30 bases: 5679288(94.7084%)

Read2 before filtering:
total reads: 79298
total bases: 5490991
Q20 bases: 5383923(98.0501%)
Q30 bases: 5084929(92.6049%)

Read1 after filtering:
total reads: 51622
total bases: 3958367
Q20 bases: 3921935(99.0796%)
Q30 bases: 3800062(96.0007%)

Read2 after filtering:
total reads: 51622
total bases: 3772927
Q20 bases: 3718987(98.5703%)
Q30 bases: 3556932(94.2751%)

Filtering result:
reads passed filter: 103244
reads failed due to low quality: 0
reads failed due to too many N: 0
reads failed due to too short: 55352
reads failed due to too long: 0
reads with adapter trimmed: 51133
bases trimmed due to adapters: 2655651

Duplication rate: 46.0642%

Insert size peak (evaluated by paired-end reads): 49

JSON report: /home/data/acropora_db/adapter_trim/AG_GAs11-67_S67_fastp.json
HTML report: /home/data/acropora_db/adapter_trim/AG_GAs11-67_S67_fastp.html

fastp -i /home/data/acropora_db/quality_control/AG_GAs11-67_S67_qc_R1.fastq.gz -I /home/data/acropora_db/quality_control/AG_GAs11-67_S67_qc_R2.fastq.gz -o /home/data/acropora_db/adapter_trim/AG_GAs11-67_S67_at_R1.fastq.gz -O /home/data/acropora_db/adapter_trim/AG_GAs11-67_S67_at_R2.fastq.gz --adapter_sequence GTCAGATCGGAAGAGCACACGTCTGAACTCCAGTCAC --adapter_sequence_r2 CAGAGATCGGAAGAGCGTCGTGTAGGGAAAGAC --cut_right --cut_window_size 4 --cut_mean_quality 20 --length_required 36 --length_limit 150 --average_qual 19 --thread 8 --json /home/data/acropora_db/adapter_trim/AG_GAs11-67_S67_fastp.json --html /home/data/acropora_db/adapter_trim/AG_GAs11-67_S67_fastp.html 
fastp v0.23.4, time used: 0 seconds

[2024-10-05 17:53:48,421] INFO database_accessor.py execute_cmd :
[cmd] fastp -i /home/data/acropora_db/quality_control/AM_A-1_S33_qc_R1.fastq.gz -I /home/data/acropora_db/quality_control/AM_A-1_S33_qc_R2.fastq.gz -o /home/data/acropora_db/adapter_trim/AM_A-1_S33_at_R1.fastq.gz -O /home/data/acropora_db/adapter_trim/AM_A-1_S33_at_R2.fastq.gz --adapter_sequence GTCAGATCGGAAGAGCACACGTCTGAACTCCAGTCAC --adapter_sequence_r2 CAGAGATCGGAAGAGCGTCGTGTAGGGAAAGAC --cut_right --cut_window_size 4 --cut_mean_quality 20 --length_required 36 --length_limit 150 --average_qual 19 --thread 8 --json /home/data/acropora_db/adapter_trim/AM_A-1_S33_fastp.json --html /home/data/acropora_db/adapter_trim/AM_A-1_S33_fastp.html
[2024-10-05 17:53:48,871] INFO database_accessor.py execute_cmd :
Read1 before filtering:
total reads: 93866
total bases: 7066298
Q20 bases: 7008421(99.1809%)
Q30 bases: 6804930(96.3012%)

Read2 before filtering:
total reads: 93866
total bases: 6587867
Q20 bases: 6517391(98.9302%)
Q30 bases: 6285324(95.4076%)

Read1 after filtering:
total reads: 70057
total bases: 5238507
Q20 bases: 5207195(99.4023%)
Q30 bases: 5082504(97.022%)

Read2 after filtering:
total reads: 70057
total bases: 4876236
Q20 bases: 4840109(99.2591%)
Q30 bases: 4707250(96.5345%)

Filtering result:
reads passed filter: 140114
reads failed due to low quality: 2
reads failed due to too many N: 0
reads failed due to too short: 47616
reads failed due to too long: 0
reads with adapter trimmed: 44894
bases trimmed due to adapters: 2404472

Duplication rate: 56.4027%

Insert size peak (evaluated by paired-end reads): 42

JSON report: /home/data/acropora_db/adapter_trim/AM_A-1_S33_fastp.json
HTML report: /home/data/acropora_db/adapter_trim/AM_A-1_S33_fastp.html

fastp -i /home/data/acropora_db/quality_control/AM_A-1_S33_qc_R1.fastq.gz -I /home/data/acropora_db/quality_control/AM_A-1_S33_qc_R2.fastq.gz -o /home/data/acropora_db/adapter_trim/AM_A-1_S33_at_R1.fastq.gz -O /home/data/acropora_db/adapter_trim/AM_A-1_S33_at_R2.fastq.gz --adapter_sequence GTCAGATCGGAAGAGCACACGTCTGAACTCCAGTCAC --adapter_sequence_r2 CAGAGATCGGAAGAGCGTCGTGTAGGGAAAGAC --cut_right --cut_window_size 4 --cut_mean_quality 20 --length_required 36 --length_limit 150 --average_qual 19 --thread 8 --json /home/data/acropora_db/adapter_trim/AM_A-1_S33_fastp.json --html /home/data/acropora_db/adapter_trim/AM_A-1_S33_fastp.html 
fastp v0.23.4, time used: 0 seconds

[2024-10-05 17:53:48,872] INFO database_accessor.py adapter_trim :
所有样本的接头修剪已完成
[2024-10-05 17:53:48,872] INFO database_accessor.py logging_title :

#########################
#### fastq 转换为 fasta ####
#########################
[2024-10-05 17:53:48,872] INFO database_accessor.py execute_cmd :
[cmd] seqkit fq2fa -o /home/data/acropora_db/fasta/AS_ASTUS31_S161.fasta.gz /home/data/acropora_db/adapter_trim/AS_ASTUS31_S161_at_R1.fastq.gz /home/data/acropora_db/adapter_trim/AS_ASTUS31_S161_at_R2.fastq.gz
[2024-10-05 17:53:49,155] INFO database_accessor.py execute_cmd :
[cmd] seqkit fq2fa -o /home/data/acropora_db/fasta/AP_TS1_S1.fasta.gz /home/data/acropora_db/adapter_trim/AP_TS1_S1_at_R1.fastq.gz /home/data/acropora_db/adapter_trim/AP_TS1_S1_at_R2.fastq.gz
[2024-10-05 17:53:49,505] INFO database_accessor.py execute_cmd :
[cmd] seqkit fq2fa -o /home/data/acropora_db/fasta/AG_GAs11-67_S67.fasta.gz /home/data/acropora_db/adapter_trim/AG_GAs11-67_S67_at_R1.fastq.gz /home/data/acropora_db/adapter_trim/AG_GAs11-67_S67_at_R2.fastq.gz
[2024-10-05 17:53:49,615] INFO database_accessor.py execute_cmd :
[cmd] seqkit fq2fa -o /home/data/acropora_db/fasta/AM_A-1_S33.fasta.gz /home/data/acropora_db/adapter_trim/AM_A-1_S33_at_R1.fastq.gz /home/data/acropora_db/adapter_trim/AM_A-1_S33_at_R2.fastq.gz
[2024-10-05 17:53:49,760] INFO database_accessor.py fastq_to_fasta :
所有样本的 FASTQ 到 FASTA 转换已完成
[2024-10-05 17:53:49,760] INFO database_accessor.py execute_cmd :
[cmd] seqkit seq -m 80 -M 80 /home/data/acropora_db/fasta/AS_ASTUS31_S161.fasta.gz | gzip > /home/data/acropora_db/fasta/AS_ASTUS31_S161_uniform.fasta.gz
[2024-10-05 17:53:50,374] INFO database_accessor.py execute_cmd :
[33m[WARN][0m you may switch on flag -g/--remove-gaps to remove spaces

[2024-10-05 17:53:50,374] INFO database_accessor.py execute_cmd :
[cmd] seqkit seq -m 80 -M 80 /home/data/acropora_db/fasta/AP_TS1_S1.fasta.gz | gzip > /home/data/acropora_db/fasta/AP_TS1_S1_uniform.fasta.gz
[2024-10-05 17:53:51,292] INFO database_accessor.py execute_cmd :
[33m[WARN][0m you may switch on flag -g/--remove-gaps to remove spaces

[2024-10-05 17:53:51,292] INFO database_accessor.py execute_cmd :
[cmd] seqkit seq -m 80 -M 80 /home/data/acropora_db/fasta/AG_GAs11-67_S67.fasta.gz | gzip > /home/data/acropora_db/fasta/AG_GAs11-67_S67_uniform.fasta.gz
[2024-10-05 17:53:51,683] INFO database_accessor.py execute_cmd :
[33m[WARN][0m you may switch on flag -g/--remove-gaps to remove spaces

[2024-10-05 17:53:51,683] INFO database_accessor.py execute_cmd :
[cmd] seqkit seq -m 80 -M 80 /home/data/acropora_db/fasta/AM_A-1_S33.fasta.gz | gzip > /home/data/acropora_db/fasta/AM_A-1_S33_uniform.fasta.gz
[2024-10-05 17:53:52,159] INFO database_accessor.py execute_cmd :
[33m[WARN][0m you may switch on flag -g/--remove-gaps to remove spaces

[2024-10-05 17:53:52,159] INFO database_accessor.py logging_title :

#################
#### ustacks ####
#################
[2024-10-05 17:53:52,160] INFO database_accessor.py stacks :
Running ustacks for sample: AS_ASTUS31_S161
[2024-10-05 17:53:52,160] INFO database_accessor.py stacks :
Command: ustacks -f /home/data/acropora_db/fasta/AS_ASTUS31_S161_uniform.fasta.gz -o /home/data/acropora_db/ustacks --name AS_ASTUS31_S161 -i 1 -m 3 -M 2 -p 8
[2024-10-05 17:53:52,160] INFO database_accessor.py execute_cmd :
[cmd] ustacks -f /home/data/acropora_db/fasta/AS_ASTUS31_S161_uniform.fasta.gz -o /home/data/acropora_db/ustacks --name AS_ASTUS31_S161 -i 1 -m 3 -M 2 -p 8
[2024-10-05 17:53:52,799] INFO database_accessor.py execute_cmd :
ustacks parameters selected:
  Input file: '/home/data/acropora_db/fasta/AS_ASTUS31_S161_uniform.fasta.gz'
  Sample ID: 1
  Min depth of coverage to create a stack (m): 3
  Repeat removal algorithm: enabled
  Max distance allowed between stacks (M): 2
  Max distance allowed to align secondary reads: 4
  Max number of stacks allowed per de novo locus: 3
  Deleveraging algorithm: disabled
  Gapped assembly: enabled
  Minimum alignment length: 0.8
  Model type: SNP
  Alpha significance level for model: 0.05

Loading RAD-Tags...
Warning: Input reads contained 28 uncalled nucleotides.

Loaded 53942 reads; formed:
  2358 stacks representing 34094 primary reads (63.2%)
  18039 secondary stacks representing 19848 secondary reads (36.8%)

Stack coverage: mean=14.46; stdev=53.71; max=1311; n_reads=34094(63.2%)
Removing repetitive stacks: cov > 176 (mean+3*stdev)...
  Blacklisted 206 stacks.
Coverage after repeat removal: mean=10.86; stdev=17.90; max=174; n_reads=23378(43.3%)

Assembling stacks (max. dist. M=2)...
  Assembled 2152 stacks into 1737; blacklisted 36 stacks.
Coverage after assembling stacks: mean=11.62; stdev=17.83; max=181; n_reads=19559(36.3%)

Merging secondary stacks (max. dist. N=4 from consensus)...
  Merged 7119 out of 19848 secondary reads (35.9%), 1155 merged with gapped alignments.
Coverage after merging secondary stacks: mean=15.85; stdev=23.02; max=217; n_reads=26678(49.5%)

Assembling stacks, allowing for gaps (min. match length 80.0%)...
  Assembled 1737 stacks into 1624 stacks.
Coverage after gapped assembly: mean=16.99; stdev=24.38; max=225; n_reads=26678(49.5%)

Merging secondary stacks, allowing for gaps (min. match length 80.0%)...
  Merged 2856 out of 12729 secondary reads (22.4%).
Coverage after merging gapped secondary stacks: mean=18.81; stdev=26.91; max=228; n_reads=29534(54.8%)

Final number of stacks built: 1624
Final coverage: mean=18.81; stdev=26.91; max=228; n_reads=29534(54.8%)
Calling consensus sequences and haplotypes for catalog assembly...
Writing tags, SNPs, and alleles files to '/home/data/acropora_db/ustacks/AS_ASTUS31_S161'...done.
ustacks is done.

[2024-10-05 17:53:52,799] INFO database_accessor.py stacks :
ustacks successfully processed sample: AS_ASTUS31_S161
[2024-10-05 17:53:52,799] INFO database_accessor.py stacks :
Running ustacks for sample: AP_TS1_S1
[2024-10-05 17:53:52,799] INFO database_accessor.py stacks :
Command: ustacks -f /home/data/acropora_db/fasta/AP_TS1_S1_uniform.fasta.gz -o /home/data/acropora_db/ustacks --name AP_TS1_S1 -i 2 -m 3 -M 2 -p 8
[2024-10-05 17:53:52,799] INFO database_accessor.py execute_cmd :
[cmd] ustacks -f /home/data/acropora_db/fasta/AP_TS1_S1_uniform.fasta.gz -o /home/data/acropora_db/ustacks --name AP_TS1_S1 -i 2 -m 3 -M 2 -p 8
[2024-10-05 17:53:54,035] INFO database_accessor.py execute_cmd :
ustacks parameters selected:
  Input file: '/home/data/acropora_db/fasta/AP_TS1_S1_uniform.fasta.gz'
  Sample ID: 2
  Min depth of coverage to create a stack (m): 3
  Repeat removal algorithm: enabled
  Max distance allowed between stacks (M): 2
  Max distance allowed to align secondary reads: 4
  Max number of stacks allowed per de novo locus: 3
  Deleveraging algorithm: disabled
  Gapped assembly: enabled
  Minimum alignment length: 0.8
  Model type: SNP
  Alpha significance level for model: 0.05

Loading RAD-Tags...

Loaded 132844 reads; formed:
  4103 stacks representing 106978 primary reads (80.5%)
  23273 secondary stacks representing 25866 secondary reads (19.5%)

Stack coverage: mean=26.07; stdev=162.96; max=3789; n_reads=106978(80.5%)
Removing repetitive stacks: cov > 515 (mean+3*stdev)...
  Blacklisted 810 stacks.
Coverage after repeat removal: mean=18.76; stdev=45.94; max=503; n_reads=61763(46.5%)

Assembling stacks (max. dist. M=2)...
  Assembled 3293 stacks into 2828; blacklisted 37 stacks.
Coverage after assembling stacks: mean=18.73; stdev=41.41; max=505; n_reads=51877(39.1%)

Merging secondary stacks (max. dist. N=4 from consensus)...
  Merged 10842 out of 25866 secondary reads (41.9%), 1929 merged with gapped alignments.
Coverage after merging secondary stacks: mean=22.64; stdev=48.36; max=558; n_reads=62719(47.2%)

Assembling stacks, allowing for gaps (min. match length 80.0%)...
  Assembled 2828 stacks into 2193 stacks.
Coverage after gapped assembly: mean=29.38; stdev=58.66; max=652; n_reads=62719(47.2%)

Merging secondary stacks, allowing for gaps (min. match length 80.0%)...
  Merged 5526 out of 15024 secondary reads (36.8%).
Coverage after merging gapped secondary stacks: mean=31.96; stdev=60.81; max=659; n_reads=68245(51.4%)

Final number of stacks built: 2193
Final coverage: mean=31.96; stdev=60.81; max=659; n_reads=68245(51.4%)
Calling consensus sequences and haplotypes for catalog assembly...
Writing tags, SNPs, and alleles files to '/home/data/acropora_db/ustacks/AP_TS1_S1'...done.
ustacks is done.

[2024-10-05 17:53:54,035] INFO database_accessor.py stacks :
ustacks successfully processed sample: AP_TS1_S1
[2024-10-05 17:53:54,035] INFO database_accessor.py stacks :
Running ustacks for sample: AG_GAs11-67_S67
[2024-10-05 17:53:54,035] INFO database_accessor.py stacks :
Command: ustacks -f /home/data/acropora_db/fasta/AG_GAs11-67_S67_uniform.fasta.gz -o /home/data/acropora_db/ustacks --name AG_GAs11-67_S67 -i 3 -m 3 -M 2 -p 8
[2024-10-05 17:53:54,035] INFO database_accessor.py execute_cmd :
[cmd] ustacks -f /home/data/acropora_db/fasta/AG_GAs11-67_S67_uniform.fasta.gz -o /home/data/acropora_db/ustacks --name AG_GAs11-67_S67 -i 3 -m 3 -M 2 -p 8
[2024-10-05 17:53:54,545] INFO database_accessor.py execute_cmd :
ustacks parameters selected:
  Input file: '/home/data/acropora_db/fasta/AG_GAs11-67_S67_uniform.fasta.gz'
  Sample ID: 3
  Min depth of coverage to create a stack (m): 3
  Repeat removal algorithm: enabled
  Max distance allowed between stacks (M): 2
  Max distance allowed to align secondary reads: 4
  Max number of stacks allowed per de novo locus: 3
  Deleveraging algorithm: disabled
  Gapped assembly: enabled
  Minimum alignment length: 0.8
  Model type: SNP
  Alpha significance level for model: 0.05

Loading RAD-Tags...
Warning: Input reads contained 1 uncalled nucleotides.

Loaded 42595 reads; formed:
  1734 stacks representing 29473 primary reads (69.2%)
  11868 secondary stacks representing 13122 secondary reads (30.8%)

Stack coverage: mean=17.00; stdev=60.60; max=1955; n_reads=29473(69.2%)
Removing repetitive stacks: cov > 199 (mean+3*stdev)...
  Blacklisted 121 stacks.
Coverage after repeat removal: mean=13.16; stdev=21.91; max=190; n_reads=21222(49.8%)

Assembling stacks (max. dist. M=2)...
  Assembled 1613 stacks into 1408; blacklisted 17 stacks.
Coverage after assembling stacks: mean=13.95; stdev=22.82; max=194; n_reads=19161(45.0%)

Merging secondary stacks (max. dist. N=4 from consensus)...
  Merged 4822 out of 13122 secondary reads (36.7%), 638 merged with gapped alignments.
Coverage after merging secondary stacks: mean=17.45; stdev=27.76; max=227; n_reads=23983(56.3%)

Assembling stacks, allowing for gaps (min. match length 80.0%)...
  Assembled 1408 stacks into 1304 stacks.
Coverage after gapped assembly: mean=18.88; stdev=29.88; max=227; n_reads=23983(56.3%)

Merging secondary stacks, allowing for gaps (min. match length 80.0%)...
  Merged 1512 out of 8300 secondary reads (18.2%).
Coverage after merging gapped secondary stacks: mean=20.07; stdev=30.85; max=228; n_reads=25495(59.9%)

Final number of stacks built: 1304
Final coverage: mean=20.07; stdev=30.85; max=228; n_reads=25495(59.9%)
Calling consensus sequences and haplotypes for catalog assembly...
Writing tags, SNPs, and alleles files to '/home/data/acropora_db/ustacks/AG_GAs11-67_S67'...done.
ustacks is done.

[2024-10-05 17:53:54,545] INFO database_accessor.py stacks :
ustacks successfully processed sample: AG_GAs11-67_S67
[2024-10-05 17:53:54,545] INFO database_accessor.py stacks :
Running ustacks for sample: AM_A-1_S33
[2024-10-05 17:53:54,545] INFO database_accessor.py stacks :
Command: ustacks -f /home/data/acropora_db/fasta/AM_A-1_S33_uniform.fasta.gz -o /home/data/acropora_db/ustacks --name AM_A-1_S33 -i 4 -m 3 -M 2 -p 8
[2024-10-05 17:53:54,546] INFO database_accessor.py execute_cmd :
[cmd] ustacks -f /home/data/acropora_db/fasta/AM_A-1_S33_uniform.fasta.gz -o /home/data/acropora_db/ustacks --name AM_A-1_S33 -i 4 -m 3 -M 2 -p 8
[2024-10-05 17:53:55,150] INFO database_accessor.py execute_cmd :
ustacks parameters selected:
  Input file: '/home/data/acropora_db/fasta/AM_A-1_S33_uniform.fasta.gz'
  Sample ID: 4
  Min depth of coverage to create a stack (m): 3
  Repeat removal algorithm: enabled
  Max distance allowed between stacks (M): 2
  Max distance allowed to align secondary reads: 4
  Max number of stacks allowed per de novo locus: 3
  Deleveraging algorithm: disabled
  Gapped assembly: enabled
  Minimum alignment length: 0.8
  Model type: SNP
  Alpha significance level for model: 0.05

Loading RAD-Tags...

Loaded 50057 reads; formed:
  2023 stacks representing 35081 primary reads (70.1%)
  13554 secondary stacks representing 14976 secondary reads (29.9%)

Stack coverage: mean=17.34; stdev=44.82; max=818; n_reads=35081(70.1%)
Removing repetitive stacks: cov > 152 (mean+3*stdev)...
  Blacklisted 98 stacks.
Coverage after repeat removal: mean=13.00; stdev=19.48; max=149; n_reads=25028(50.0%)

Assembling stacks (max. dist. M=2)...
  Assembled 1925 stacks into 1721; blacklisted 16 stacks.
Coverage after assembling stacks: mean=13.89; stdev=22.36; max=262; n_reads=23288(46.5%)

Merging secondary stacks (max. dist. N=4 from consensus)...
  Merged 5032 out of 14976 secondary reads (33.6%), 440 merged with gapped alignments.
Coverage after merging secondary stacks: mean=16.89; stdev=26.65; max=305; n_reads=28320(56.6%)

Assembling stacks, allowing for gaps (min. match length 80.0%)...
  Assembled 1721 stacks into 1565 stacks.
Coverage after gapped assembly: mean=18.62; stdev=28.95; max=305; n_reads=28320(56.6%)

Merging secondary stacks, allowing for gaps (min. match length 80.0%)...
  Merged 2580 out of 9944 secondary reads (25.9%).
Coverage after merging gapped secondary stacks: mean=20.32; stdev=30.62; max=306; n_reads=30900(61.7%)

Final number of stacks built: 1565
Final coverage: mean=20.32; stdev=30.62; max=306; n_reads=30900(61.7%)
Calling consensus sequences and haplotypes for catalog assembly...
Writing tags, SNPs, and alleles files to '/home/data/acropora_db/ustacks/AM_A-1_S33'...done.
ustacks is done.

[2024-10-05 17:53:55,150] INFO database_accessor.py stacks :
ustacks successfully processed sample: AM_A-1_S33
[2024-10-05 17:53:55,151] INFO database_accessor.py run :
stacks 处理完成
[2024-10-05 17:53:55,151] INFO database_accessor.py run :
当前 files_to_process: {'AS_ASTUS31_S161': '/home/data/acropora_db/ustacks/AS_ASTUS31_S161.tags.tsv.gz', 'AP_TS1_S1': '/home/data/acropora_db/ustacks/AP_TS1_S1.tags.tsv.gz', 'AG_GAs11-67_S67': '/home/data/acropora_db/ustacks/AG_GAs11-67_S67.tags.tsv.gz', 'AM_A-1_S33': '/home/data/acropora_db/ustacks/AM_A-1_S33.tags.tsv.gz'}
[2024-10-05 17:53:55,151] INFO database_accessor.py logging_title :

#################################
#### extract consensus fasta ####
#################################
[2024-10-05 17:53:55,151] INFO database_accessor.py extract_consensus_fasta :
[cmd] zcat /home/data/acropora_db/ustacks/AS_ASTUS31_S161.tags.tsv.gz | awk '{if($3=="consensus") {printf ">%s\n%s\n", $1, $4}}' > /home/data/acropora_db/consensus_fasta/AS_ASTUS31_S161.fa
[2024-10-05 17:53:55,151] INFO database_accessor.py execute_cmd :
[cmd] zcat /home/data/acropora_db/ustacks/AS_ASTUS31_S161.tags.tsv.gz | awk '{if($3=="consensus") {printf ">%s\n%s\n", $1, $4}}' > /home/data/acropora_db/consensus_fasta/AS_ASTUS31_S161.fa
[2024-10-05 17:53:55,177] INFO database_accessor.py extract_consensus_fasta :
成功生成共识序列文件: /home/data/acropora_db/consensus_fasta/AS_ASTUS31_S161.fa
[2024-10-05 17:53:55,177] INFO database_accessor.py extract_consensus_fasta :
检查生成的 FASTA 文件: /home/data/acropora_db/consensus_fasta/AS_ASTUS31_S161.fa
[2024-10-05 17:53:55,177] INFO database_accessor.py execute_cmd :
[cmd] head -n 10 /home/data/acropora_db/consensus_fasta/AS_ASTUS31_S161.fa
[2024-10-05 17:53:55,178] INFO database_accessor.py execute_cmd :
>1
ATCATCATCATCATCATCATCATCATCACCATCATCACCATCACCATCATCACGATCATCCGTCATCATCAAAATCGTCACCATCATCA
>1
CCTTCTCAAAACTTAGAACTGCTTATACAAATCTTCGAAAATGAAACAGGCTCGGAAATAAATGATTAACTTGTTCCCTTT
>1
CAGTTCCTTTGCGATGGTTTCAGGTTCGGAAAGCGCAGAAAAATGATTGAAAGAAATCATGGGAGTACGTTCACCGTGAAAA
>1
CTTGTCTTGAAAATATAAGACGATGTAAGGTGTTTCAATAGGTTTTGAAACTTCATTAGGCTTGATTTACAAATAGTTCTT
>1
CCATGAACAGAAAGCGGTAGAGGTGCCTTGATGTCAACGGAGCGCAATGATCGTTGAACTTCTCTTCTACAGCCTTAATCTT

[2024-10-05 17:53:55,178] INFO database_accessor.py extract_consensus_fasta :
[cmd] zcat /home/data/acropora_db/ustacks/AP_TS1_S1.tags.tsv.gz | awk '{if($3=="consensus") {printf ">%s\n%s\n", $1, $4}}' > /home/data/acropora_db/consensus_fasta/AP_TS1_S1.fa
[2024-10-05 17:53:55,178] INFO database_accessor.py execute_cmd :
[cmd] zcat /home/data/acropora_db/ustacks/AP_TS1_S1.tags.tsv.gz | awk '{if($3=="consensus") {printf ">%s\n%s\n", $1, $4}}' > /home/data/acropora_db/consensus_fasta/AP_TS1_S1.fa
[2024-10-05 17:53:55,247] INFO database_accessor.py extract_consensus_fasta :
成功生成共识序列文件: /home/data/acropora_db/consensus_fasta/AP_TS1_S1.fa
[2024-10-05 17:53:55,247] INFO database_accessor.py extract_consensus_fasta :
检查生成的 FASTA 文件: /home/data/acropora_db/consensus_fasta/AP_TS1_S1.fa
[2024-10-05 17:53:55,247] INFO database_accessor.py execute_cmd :
[cmd] head -n 10 /home/data/acropora_db/consensus_fasta/AP_TS1_S1.fa
[2024-10-05 17:53:55,248] INFO database_accessor.py execute_cmd :
>2
GACATGAACATTTGACGACACGATTTCAGTTTAGTGTTTTTTTTCCTCTTTGTCCAAAACGTTCATACCAATTTAATTCTA
>2
TCGCTTAAGCCGAAATAATTTAAAATAAATAATACCTGTAAGTGCTAAGTGGTCTACAGCAATTACCTACATAAAATGGTC
>2
CCTGTTTTTATTTTCATGACCTTTAAACAACCCGAGGGTTAGACAAACTAAAAAAAAAAGTAAAACGGAATAAGCTATTTAAAC
>2
CGCATCATTGTGTGGAGTTCTTGTTCTTCCGCTCTGTGCCCGGTCGCCGCCTCCTTCGCCTCCGCATCCGCCGTCTTGTCA
>2
CCTCTGTGGACCTTACGACCCTCAGTTCTGTGTCTTTCCTGAATGACATGTGTCGTGACAAGGCTGCTGACCCAACATACGA

[2024-10-05 17:53:55,249] INFO database_accessor.py extract_consensus_fasta :
[cmd] zcat /home/data/acropora_db/ustacks/AG_GAs11-67_S67.tags.tsv.gz | awk '{if($3=="consensus") {printf ">%s\n%s\n", $1, $4}}' > /home/data/acropora_db/consensus_fasta/AG_GAs11-67_S67.fa
[2024-10-05 17:53:55,249] INFO database_accessor.py execute_cmd :
[cmd] zcat /home/data/acropora_db/ustacks/AG_GAs11-67_S67.tags.tsv.gz | awk '{if($3=="consensus") {printf ">%s\n%s\n", $1, $4}}' > /home/data/acropora_db/consensus_fasta/AG_GAs11-67_S67.fa
[2024-10-05 17:53:55,270] INFO database_accessor.py extract_consensus_fasta :
成功生成共识序列文件: /home/data/acropora_db/consensus_fasta/AG_GAs11-67_S67.fa
[2024-10-05 17:53:55,270] INFO database_accessor.py extract_consensus_fasta :
检查生成的 FASTA 文件: /home/data/acropora_db/consensus_fasta/AG_GAs11-67_S67.fa
[2024-10-05 17:53:55,270] INFO database_accessor.py execute_cmd :
[cmd] head -n 10 /home/data/acropora_db/consensus_fasta/AG_GAs11-67_S67.fa
[2024-10-05 17:53:55,272] INFO database_accessor.py execute_cmd :
>3
TGGTATCATTTTTCTCGGTTTCCAGTTCCAGGGCTCAGCACCGCCAGAGGCTATGCACTCGCTTTTCAAACGGGTTCTCCAAA
>3
CTTGTGAAGCTCTTTGTGCCTCCAAGGTCGGTAGGTCTGACCTTTGAAGTCTTTTGAAGGTCGGTTGTGAGAAAAAGAGCCC
>3
ACAGCTGAAAGAAGAGAAATCGCTTTGAGCGTAGCAGAGGGCTCAAATGGTTTATGAGAAAATAGATCTGAAGAAGTTCACT
>3
CCATGCAGAATAGTTCTTCTCTCGCAGTATAGCTACCTTTTTGGACAGCTTGCTTTGTGCAGTCACAATCTCACCTTGTTC
>3
TCTGCGAAGCCCACATATGGACTACTGACAAATTGAGGGATCAGACCAGGATCCCAAGATACAAAATACTTGTCACACACCACC

[2024-10-05 17:53:55,272] INFO database_accessor.py extract_consensus_fasta :
[cmd] zcat /home/data/acropora_db/ustacks/AM_A-1_S33.tags.tsv.gz | awk '{if($3=="consensus") {printf ">%s\n%s\n", $1, $4}}' > /home/data/acropora_db/consensus_fasta/AM_A-1_S33.fa
[2024-10-05 17:53:55,272] INFO database_accessor.py execute_cmd :
[cmd] zcat /home/data/acropora_db/ustacks/AM_A-1_S33.tags.tsv.gz | awk '{if($3=="consensus") {printf ">%s\n%s\n", $1, $4}}' > /home/data/acropora_db/consensus_fasta/AM_A-1_S33.fa
[2024-10-05 17:53:55,297] INFO database_accessor.py extract_consensus_fasta :
成功生成共识序列文件: /home/data/acropora_db/consensus_fasta/AM_A-1_S33.fa
[2024-10-05 17:53:55,297] INFO database_accessor.py extract_consensus_fasta :
检查生成的 FASTA 文件: /home/data/acropora_db/consensus_fasta/AM_A-1_S33.fa
[2024-10-05 17:53:55,297] INFO database_accessor.py execute_cmd :
[cmd] head -n 10 /home/data/acropora_db/consensus_fasta/AM_A-1_S33.fa
[2024-10-05 17:53:55,298] INFO database_accessor.py execute_cmd :
>4
TCCCAAATAATGTCACCGTAGTCAAAAAGAGGAAGTATTACAGAATGATAAAGTGTCAACCGAGCGTCTAGTGGTAGAAGGT
>4
CAGTTCAGATGAGAAAGAATGGTTGTTGTATGATGCTGGACCTCGTAGTGTGCGATGTCCCTTAATTTGCTTACCACCAGCCAGTG
>4
TCCCCTGATTCCCCTATTAACTCTACAAAATTTGCTGGAAAAATGCCATAGTTGCCATCAGGACCACGTCACCACCACCACG
>4
AGTGTTACCATAATAGTTTTTTTTTTTTAATCTTGTGAGAGCGATGTTTCTAAAGCCTTTATGCAGAAATGATTTACTTAAA
>4
CCGTTGTGGTTGCTTGAGCTCCCTATTTCCTAAATTGTCCAGAGATGCACTAAATTTGAATTTACTAATGACGTCACACACCA

[2024-10-05 17:53:55,298] INFO database_accessor.py logging_title :

######################
#### make blastdb ####
######################
[2024-10-05 17:53:55,299] INFO database_accessor.py make_blastdb :
合并 FASTA 文件到: /home/data/acropora_db/blastdb/merged_consensus.fasta
[2024-10-05 17:53:55,299] INFO database_accessor.py execute_cmd :
[cmd] cat /home/data/acropora_db/consensus_fasta/AS_ASTUS31_S161.fa /home/data/acropora_db/consensus_fasta/AP_TS1_S1.fa /home/data/acropora_db/consensus_fasta/AG_GAs11-67_S67.fa /home/data/acropora_db/consensus_fasta/AM_A-1_S33.fa > /home/data/acropora_db/blastdb/merged_consensus.fasta
[2024-10-05 17:53:55,301] INFO database_accessor.py make_blastdb :
检查合并后的 FASTA 文件格式
[2024-10-05 17:53:55,301] INFO database_accessor.py execute_cmd :
[cmd] head -n 10 /home/data/acropora_db/blastdb/merged_consensus.fasta
[2024-10-05 17:53:55,302] INFO database_accessor.py execute_cmd :
>1
ATCATCATCATCATCATCATCATCATCACCATCATCACCATCACCATCATCACGATCATCCGTCATCATCAAAATCGTCACCATCATCA
>1
CCTTCTCAAAACTTAGAACTGCTTATACAAATCTTCGAAAATGAAACAGGCTCGGAAATAAATGATTAACTTGTTCCCTTT
>1
CAGTTCCTTTGCGATGGTTTCAGGTTCGGAAAGCGCAGAAAAATGATTGAAAGAAATCATGGGAGTACGTTCACCGTGAAAA
>1
CTTGTCTTGAAAATATAAGACGATGTAAGGTGTTTCAATAGGTTTTGAAACTTCATTAGGCTTGATTTACAAATAGTTCTT
>1
CCATGAACAGAAAGCGGTAGAGGTGCCTTGATGTCAACGGAGCGCAATGATCGTTGAACTTCTCTTCTACAGCCTTAATCTT

[2024-10-05 17:53:55,302] INFO database_accessor.py make_blastdb :
创建 BLAST 数据库: /home/data/acropora_db/blastdb/
[2024-10-05 17:53:55,302] INFO database_accessor.py execute_cmd :
[cmd] makeblastdb -in /home/data/acropora_db/blastdb/merged_consensus.fasta -out /home/data/acropora_db/blastdb/ -dbtype nucl -parse_seqids
[2024-10-05 17:53:55,321] INFO database_accessor.py execute_cmd :


Building a new DB, current time: 10/05/2024 17:53:55
New DB name:   /home/data/acropora_db/blastdb
New DB title:  /home/data/acropora_db/blastdb/merged_consensus.fasta
Sequence type: Nucleotide
Keep MBits: T
Maximum file size: 1000000000B



[2024-10-05 17:53:55,321] INFO database_accessor.py execute_cmd :
BLAST Database creation error: Error: Duplicate seq_ids are found: 
LCL|1


[2024-10-05 17:53:55,321] ERROR database_accessor.py make_blastdb :
BLAST 数据库创建失败: /home/data/acropora_db/blastdb/
[2024-10-05 17:53:55,322] INFO database_accessor.py run :
处理完成
[2024-10-05 17:53:55,322] INFO ACF.py execute_cmd :
[cmd] cd /home/data/acropora_db/ && tree . > tree.txt
[2024-10-05 17:53:55,327] INFO ACF.py write_analysis_complete_flag :
ANCAT_ANALYSIS_COMPLETED
[2024-10-05 17:55:48,410] INFO database_accessor.py execute_cmd :
[cmd] cp mkdb_acropora.conf /home/data/acropora_db/
[2024-10-05 17:55:48,412] INFO database_accessor.py logging_title :

########################
#### load fastq dir ####
########################
[2024-10-05 17:55:48,412] INFO database_accessor.py logging_title :

#################################
#### quality control : fastq ####
#################################
[2024-10-05 17:55:48,413] INFO database_accessor.py quality_control :
Processing sample: AG_GAs11-67_S67
[2024-10-05 17:55:48,413] INFO database_accessor.py execute_cmd :
[cmd] fastp -i /home/data/acropora/AG_GAs11-67_S67_L001_R1_001.fastq.gz -I /home/data/acropora/AG_GAs11-67_S67_L001_R2_001.fastq.gz -o /home/data/acropora_db/quality_control/AG_GAs11-67_S67_qc_R1.fastq.gz -O /home/data/acropora_db/quality_control/AG_GAs11-67_S67_qc_R2.fastq.gz -q 30 -f 0 -F 15 --cut_right --thread 8 --json /home/data/acropora_db/quality_control/AG_GAs11-67_S67_fastp.json --html /home/data/acropora_db/quality_control/AG_GAs11-67_S67_fastp.html
[2024-10-05 17:55:48,846] INFO database_accessor.py execute_cmd :
Read1 before filtering:
total reads: 82521
total bases: 6601680
Q20 bases: 6416163(97.1899%)
Q30 bases: 6082997(92.1432%)

Read2 before filtering:
total reads: 82521
total bases: 7756974
Q20 bases: 7322026(94.3928%)
Q30 bases: 6779442(87.398%)

Read1 after filtering:
total reads: 79298
total bases: 5996604
Q20 bases: 5914403(98.6292%)
Q30 bases: 5679288(94.7084%)

Read2 after filtering:
total reads: 79298
total bases: 5490991
Q20 bases: 5383923(98.0501%)
Q30 bases: 5084929(92.6049%)

Filtering result:
reads passed filter: 158596
reads failed due to low quality: 2226
reads failed due to too many N: 0
reads failed due to too short: 4220
reads with adapter trimmed: 15980
bases trimmed due to adapters: 278157

Duplication rate: 41.8899%

Insert size peak (evaluated by paired-end reads): 64

JSON report: /home/data/acropora_db/quality_control/AG_GAs11-67_S67_fastp.json
HTML report: /home/data/acropora_db/quality_control/AG_GAs11-67_S67_fastp.html

fastp -i /home/data/acropora/AG_GAs11-67_S67_L001_R1_001.fastq.gz -I /home/data/acropora/AG_GAs11-67_S67_L001_R2_001.fastq.gz -o /home/data/acropora_db/quality_control/AG_GAs11-67_S67_qc_R1.fastq.gz -O /home/data/acropora_db/quality_control/AG_GAs11-67_S67_qc_R2.fastq.gz -q 30 -f 0 -F 15 --cut_right --thread 8 --json /home/data/acropora_db/quality_control/AG_GAs11-67_S67_fastp.json --html /home/data/acropora_db/quality_control/AG_GAs11-67_S67_fastp.html 
fastp v0.23.4, time used: 0 seconds

[2024-10-05 17:55:48,846] WARNING database_accessor.py quality_control :
fastp for AG_GAs11-67_S67 produced warnings: Read1 before filtering:
total reads: 82521
total bases: 6601680
Q20 bases: 6416163(97.1899%)
Q30 bases: 6082997(92.1432%)

Read2 before filtering:
total reads: 82521
total bases: 7756974
Q20 bases: 7322026(94.3928%)
Q30 bases: 6779442(87.398%)

Read1 after filtering:
total reads: 79298
total bases: 5996604
Q20 bases: 5914403(98.6292%)
Q30 bases: 5679288(94.7084%)

Read2 after filtering:
total reads: 79298
total bases: 5490991
Q20 bases: 5383923(98.0501%)
Q30 bases: 5084929(92.6049%)

Filtering result:
reads passed filter: 158596
reads failed due to low quality: 2226
reads failed due to too many N: 0
reads failed due to too short: 4220
reads with adapter trimmed: 15980
bases trimmed due to adapters: 278157

Duplication rate: 41.8899%

Insert size peak (evaluated by paired-end reads): 64

JSON report: /home/data/acropora_db/quality_control/AG_GAs11-67_S67_fastp.json
HTML report: /home/data/acropora_db/quality_control/AG_GAs11-67_S67_fastp.html

fastp -i /home/data/acropora/AG_GAs11-67_S67_L001_R1_001.fastq.gz -I /home/data/acropora/AG_GAs11-67_S67_L001_R2_001.fastq.gz -o /home/data/acropora_db/quality_control/AG_GAs11-67_S67_qc_R1.fastq.gz -O /home/data/acropora_db/quality_control/AG_GAs11-67_S67_qc_R2.fastq.gz -q 30 -f 0 -F 15 --cut_right --thread 8 --json /home/data/acropora_db/quality_control/AG_GAs11-67_S67_fastp.json --html /home/data/acropora_db/quality_control/AG_GAs11-67_S67_fastp.html 
fastp v0.23.4, time used: 0 seconds

[2024-10-05 17:55:48,846] INFO database_accessor.py quality_control :
Finished processing sample: AG_GAs11-67_S67
[2024-10-05 17:55:48,846] INFO database_accessor.py quality_control :
Processing sample: AS_ASTUS31_S161
[2024-10-05 17:55:48,846] INFO database_accessor.py execute_cmd :
[cmd] fastp -i /home/data/acropora/AS_ASTUS31_S161_L001_R1_001.fastq.gz -I /home/data/acropora/AS_ASTUS31_S161_L001_R2_001.fastq.gz -o /home/data/acropora_db/quality_control/AS_ASTUS31_S161_qc_R1.fastq.gz -O /home/data/acropora_db/quality_control/AS_ASTUS31_S161_qc_R2.fastq.gz -q 30 -f 0 -F 15 --cut_right --thread 8 --json /home/data/acropora_db/quality_control/AS_ASTUS31_S161_fastp.json --html /home/data/acropora_db/quality_control/AS_ASTUS31_S161_fastp.html
[2024-10-05 17:55:49,471] INFO database_accessor.py execute_cmd :
Read1 before filtering:
total reads: 162226
total bases: 12978080
Q20 bases: 12762049(98.3354%)
Q30 bases: 12317675(94.9114%)

Read2 before filtering:
total reads: 162226
total bases: 15249244
Q20 bases: 14935119(97.9401%)
Q30 bases: 14342176(94.0517%)

Read1 after filtering:
total reads: 158521
total bases: 12084495
Q20 bases: 11964325(99.0056%)
Q30 bases: 11633921(96.2715%)

Read2 after filtering:
total reads: 158521
total bases: 11411898
Q20 bases: 11287906(98.9135%)
Q30 bases: 10913654(95.634%)

Filtering result:
reads passed filter: 317042
reads failed due to low quality: 2624
reads failed due to too many N: 0
reads failed due to too short: 4786
reads with adapter trimmed: 58926
bases trimmed due to adapters: 1142077

Duplication rate: 56.3621%

Insert size peak (evaluated by paired-end reads): 95

JSON report: /home/data/acropora_db/quality_control/AS_ASTUS31_S161_fastp.json
HTML report: /home/data/acropora_db/quality_control/AS_ASTUS31_S161_fastp.html

fastp -i /home/data/acropora/AS_ASTUS31_S161_L001_R1_001.fastq.gz -I /home/data/acropora/AS_ASTUS31_S161_L001_R2_001.fastq.gz -o /home/data/acropora_db/quality_control/AS_ASTUS31_S161_qc_R1.fastq.gz -O /home/data/acropora_db/quality_control/AS_ASTUS31_S161_qc_R2.fastq.gz -q 30 -f 0 -F 15 --cut_right --thread 8 --json /home/data/acropora_db/quality_control/AS_ASTUS31_S161_fastp.json --html /home/data/acropora_db/quality_control/AS_ASTUS31_S161_fastp.html 
fastp v0.23.4, time used: 1 seconds

[2024-10-05 17:55:49,471] WARNING database_accessor.py quality_control :
fastp for AS_ASTUS31_S161 produced warnings: Read1 before filtering:
total reads: 162226
total bases: 12978080
Q20 bases: 12762049(98.3354%)
Q30 bases: 12317675(94.9114%)

Read2 before filtering:
total reads: 162226
total bases: 15249244
Q20 bases: 14935119(97.9401%)
Q30 bases: 14342176(94.0517%)

Read1 after filtering:
total reads: 158521
total bases: 12084495
Q20 bases: 11964325(99.0056%)
Q30 bases: 11633921(96.2715%)

Read2 after filtering:
total reads: 158521
total bases: 11411898
Q20 bases: 11287906(98.9135%)
Q30 bases: 10913654(95.634%)

Filtering result:
reads passed filter: 317042
reads failed due to low quality: 2624
reads failed due to too many N: 0
reads failed due to too short: 4786
reads with adapter trimmed: 58926
bases trimmed due to adapters: 1142077

Duplication rate: 56.3621%

Insert size peak (evaluated by paired-end reads): 95

JSON report: /home/data/acropora_db/quality_control/AS_ASTUS31_S161_fastp.json
HTML report: /home/data/acropora_db/quality_control/AS_ASTUS31_S161_fastp.html

fastp -i /home/data/acropora/AS_ASTUS31_S161_L001_R1_001.fastq.gz -I /home/data/acropora/AS_ASTUS31_S161_L001_R2_001.fastq.gz -o /home/data/acropora_db/quality_control/AS_ASTUS31_S161_qc_R1.fastq.gz -O /home/data/acropora_db/quality_control/AS_ASTUS31_S161_qc_R2.fastq.gz -q 30 -f 0 -F 15 --cut_right --thread 8 --json /home/data/acropora_db/quality_control/AS_ASTUS31_S161_fastp.json --html /home/data/acropora_db/quality_control/AS_ASTUS31_S161_fastp.html 
fastp v0.23.4, time used: 1 seconds

[2024-10-05 17:55:49,471] INFO database_accessor.py quality_control :
Finished processing sample: AS_ASTUS31_S161
[2024-10-05 17:55:49,472] INFO database_accessor.py quality_control :
Processing sample: AM_A-1_S33
[2024-10-05 17:55:49,472] INFO database_accessor.py execute_cmd :
[cmd] fastp -i /home/data/acropora/AM_A-1_S33_L001_R1_001.fastq.gz -I /home/data/acropora/AM_A-1_S33_L001_R2_001.fastq.gz -o /home/data/acropora_db/quality_control/AM_A-1_S33_qc_R1.fastq.gz -O /home/data/acropora_db/quality_control/AM_A-1_S33_qc_R2.fastq.gz -q 30 -f 0 -F 15 --cut_right --thread 8 --json /home/data/acropora_db/quality_control/AM_A-1_S33_fastp.json --html /home/data/acropora_db/quality_control/AM_A-1_S33_fastp.html
[2024-10-05 17:55:49,905] INFO database_accessor.py execute_cmd :
Read1 before filtering:
total reads: 97107
total bases: 7768560
Q20 bases: 7647822(98.4458%)
Q30 bases: 7362598(94.7743%)

Read2 before filtering:
total reads: 97107
total bases: 9128058
Q20 bases: 8907264(97.5812%)
Q30 bases: 8496983(93.0864%)

Read1 after filtering:
total reads: 93866
total bases: 7066298
Q20 bases: 7008421(99.1809%)
Q30 bases: 6804930(96.3012%)

Read2 after filtering:
total reads: 93866
total bases: 6587867
Q20 bases: 6517391(98.9302%)
Q30 bases: 6285324(95.4076%)

Filtering result:
reads passed filter: 187732
reads failed due to low quality: 2370
reads failed due to too many N: 0
reads failed due to too short: 4112
reads with adapter trimmed: 50244
bases trimmed due to adapters: 883198

Duplication rate: 53.0343%

Insert size peak (evaluated by paired-end reads): 57

JSON report: /home/data/acropora_db/quality_control/AM_A-1_S33_fastp.json
HTML report: /home/data/acropora_db/quality_control/AM_A-1_S33_fastp.html

fastp -i /home/data/acropora/AM_A-1_S33_L001_R1_001.fastq.gz -I /home/data/acropora/AM_A-1_S33_L001_R2_001.fastq.gz -o /home/data/acropora_db/quality_control/AM_A-1_S33_qc_R1.fastq.gz -O /home/data/acropora_db/quality_control/AM_A-1_S33_qc_R2.fastq.gz -q 30 -f 0 -F 15 --cut_right --thread 8 --json /home/data/acropora_db/quality_control/AM_A-1_S33_fastp.json --html /home/data/acropora_db/quality_control/AM_A-1_S33_fastp.html 
fastp v0.23.4, time used: 0 seconds

[2024-10-05 17:55:49,905] WARNING database_accessor.py quality_control :
fastp for AM_A-1_S33 produced warnings: Read1 before filtering:
total reads: 97107
total bases: 7768560
Q20 bases: 7647822(98.4458%)
Q30 bases: 7362598(94.7743%)

Read2 before filtering:
total reads: 97107
total bases: 9128058
Q20 bases: 8907264(97.5812%)
Q30 bases: 8496983(93.0864%)

Read1 after filtering:
total reads: 93866
total bases: 7066298
Q20 bases: 7008421(99.1809%)
Q30 bases: 6804930(96.3012%)

Read2 after filtering:
total reads: 93866
total bases: 6587867
Q20 bases: 6517391(98.9302%)
Q30 bases: 6285324(95.4076%)

Filtering result:
reads passed filter: 187732
reads failed due to low quality: 2370
reads failed due to too many N: 0
reads failed due to too short: 4112
reads with adapter trimmed: 50244
bases trimmed due to adapters: 883198

Duplication rate: 53.0343%

Insert size peak (evaluated by paired-end reads): 57

JSON report: /home/data/acropora_db/quality_control/AM_A-1_S33_fastp.json
HTML report: /home/data/acropora_db/quality_control/AM_A-1_S33_fastp.html

fastp -i /home/data/acropora/AM_A-1_S33_L001_R1_001.fastq.gz -I /home/data/acropora/AM_A-1_S33_L001_R2_001.fastq.gz -o /home/data/acropora_db/quality_control/AM_A-1_S33_qc_R1.fastq.gz -O /home/data/acropora_db/quality_control/AM_A-1_S33_qc_R2.fastq.gz -q 30 -f 0 -F 15 --cut_right --thread 8 --json /home/data/acropora_db/quality_control/AM_A-1_S33_fastp.json --html /home/data/acropora_db/quality_control/AM_A-1_S33_fastp.html 
fastp v0.23.4, time used: 0 seconds

[2024-10-05 17:55:49,905] INFO database_accessor.py quality_control :
Finished processing sample: AM_A-1_S33
[2024-10-05 17:55:49,905] INFO database_accessor.py quality_control :
Processing sample: AP_TS1_S1
[2024-10-05 17:55:49,905] INFO database_accessor.py execute_cmd :
[cmd] fastp -i /home/data/acropora/AP_TS1_S1_L001_R1_001.fastq.gz -I /home/data/acropora/AP_TS1_S1_L001_R2_001.fastq.gz -o /home/data/acropora_db/quality_control/AP_TS1_S1_qc_R1.fastq.gz -O /home/data/acropora_db/quality_control/AP_TS1_S1_qc_R2.fastq.gz -q 30 -f 0 -F 15 --cut_right --thread 8 --json /home/data/acropora_db/quality_control/AP_TS1_S1_fastp.json --html /home/data/acropora_db/quality_control/AP_TS1_S1_fastp.html
[2024-10-05 17:55:50,648] INFO database_accessor.py execute_cmd :
Read1 before filtering:
total reads: 248601
total bases: 19888080
Q20 bases: 19480257(97.9494%)
Q30 bases: 18588142(93.4637%)

Read2 before filtering:
total reads: 248601
total bases: 23617095
Q20 bases: 22812090(96.5914%)
Q30 bases: 21475937(90.9339%)

Read1 after filtering:
total reads: 231712
total bases: 17580299
Q20 bases: 17414800(99.0586%)
Q30 bases: 16830589(95.7355%)

Read2 after filtering:
total reads: 231712
total bases: 16739640
Q20 bases: 16514648(98.6559%)
Q30 bases: 15824490(94.533%)

Filtering result:
reads passed filter: 463424
reads failed due to low quality: 12162
reads failed due to too many N: 0
reads failed due to too short: 21616
reads with adapter trimmed: 99544
bases trimmed due to adapters: 1530502

Duplication rate: 64.4881%

Insert size peak (evaluated by paired-end reads): 71

JSON report: /home/data/acropora_db/quality_control/AP_TS1_S1_fastp.json
HTML report: /home/data/acropora_db/quality_control/AP_TS1_S1_fastp.html

fastp -i /home/data/acropora/AP_TS1_S1_L001_R1_001.fastq.gz -I /home/data/acropora/AP_TS1_S1_L001_R2_001.fastq.gz -o /home/data/acropora_db/quality_control/AP_TS1_S1_qc_R1.fastq.gz -O /home/data/acropora_db/quality_control/AP_TS1_S1_qc_R2.fastq.gz -q 30 -f 0 -F 15 --cut_right --thread 8 --json /home/data/acropora_db/quality_control/AP_TS1_S1_fastp.json --html /home/data/acropora_db/quality_control/AP_TS1_S1_fastp.html 
fastp v0.23.4, time used: 1 seconds

[2024-10-05 17:55:50,648] WARNING database_accessor.py quality_control :
fastp for AP_TS1_S1 produced warnings: Read1 before filtering:
total reads: 248601
total bases: 19888080
Q20 bases: 19480257(97.9494%)
Q30 bases: 18588142(93.4637%)

Read2 before filtering:
total reads: 248601
total bases: 23617095
Q20 bases: 22812090(96.5914%)
Q30 bases: 21475937(90.9339%)

Read1 after filtering:
total reads: 231712
total bases: 17580299
Q20 bases: 17414800(99.0586%)
Q30 bases: 16830589(95.7355%)

Read2 after filtering:
total reads: 231712
total bases: 16739640
Q20 bases: 16514648(98.6559%)
Q30 bases: 15824490(94.533%)

Filtering result:
reads passed filter: 463424
reads failed due to low quality: 12162
reads failed due to too many N: 0
reads failed due to too short: 21616
reads with adapter trimmed: 99544
bases trimmed due to adapters: 1530502

Duplication rate: 64.4881%

Insert size peak (evaluated by paired-end reads): 71

JSON report: /home/data/acropora_db/quality_control/AP_TS1_S1_fastp.json
HTML report: /home/data/acropora_db/quality_control/AP_TS1_S1_fastp.html

fastp -i /home/data/acropora/AP_TS1_S1_L001_R1_001.fastq.gz -I /home/data/acropora/AP_TS1_S1_L001_R2_001.fastq.gz -o /home/data/acropora_db/quality_control/AP_TS1_S1_qc_R1.fastq.gz -O /home/data/acropora_db/quality_control/AP_TS1_S1_qc_R2.fastq.gz -q 30 -f 0 -F 15 --cut_right --thread 8 --json /home/data/acropora_db/quality_control/AP_TS1_S1_fastp.json --html /home/data/acropora_db/quality_control/AP_TS1_S1_fastp.html 
fastp v0.23.4, time used: 1 seconds

[2024-10-05 17:55:50,648] INFO database_accessor.py quality_control :
Finished processing sample: AP_TS1_S1
[2024-10-05 17:55:50,648] INFO database_accessor.py quality_control :
Quality control completed for all samples
[2024-10-05 17:55:50,648] INFO database_accessor.py logging_title :

####################
#### 接头修剪：fastq ####
####################
[2024-10-05 17:55:50,649] INFO database_accessor.py execute_cmd :
[cmd] fastp -i /home/data/acropora_db/quality_control/AG_GAs11-67_S67_qc_R1.fastq.gz -I /home/data/acropora_db/quality_control/AG_GAs11-67_S67_qc_R2.fastq.gz -o /home/data/acropora_db/adapter_trim/AG_GAs11-67_S67_at_R1.fastq.gz -O /home/data/acropora_db/adapter_trim/AG_GAs11-67_S67_at_R2.fastq.gz --adapter_sequence GTCAGATCGGAAGAGCACACGTCTGAACTCCAGTCAC --adapter_sequence_r2 CAGAGATCGGAAGAGCGTCGTGTAGGGAAAGAC --cut_right --cut_window_size 4 --cut_mean_quality 20 --length_required 36 --length_limit 150 --average_qual 19 --thread 8 --json /home/data/acropora_db/adapter_trim/AG_GAs11-67_S67_fastp.json --html /home/data/acropora_db/adapter_trim/AG_GAs11-67_S67_fastp.html
[2024-10-05 17:55:51,031] INFO database_accessor.py execute_cmd :
Read1 before filtering:
total reads: 79298
total bases: 5996604
Q20 bases: 5914403(98.6292%)
Q30 bases: 5679288(94.7084%)

Read2 before filtering:
total reads: 79298
total bases: 5490991
Q20 bases: 5383923(98.0501%)
Q30 bases: 5084929(92.6049%)

Read1 after filtering:
total reads: 51622
total bases: 3958367
Q20 bases: 3921935(99.0796%)
Q30 bases: 3800062(96.0007%)

Read2 after filtering:
total reads: 51622
total bases: 3772927
Q20 bases: 3718987(98.5703%)
Q30 bases: 3556932(94.2751%)

Filtering result:
reads passed filter: 103244
reads failed due to low quality: 0
reads failed due to too many N: 0
reads failed due to too short: 55352
reads failed due to too long: 0
reads with adapter trimmed: 51133
bases trimmed due to adapters: 2655651

Duplication rate: 46.0642%

Insert size peak (evaluated by paired-end reads): 49

JSON report: /home/data/acropora_db/adapter_trim/AG_GAs11-67_S67_fastp.json
HTML report: /home/data/acropora_db/adapter_trim/AG_GAs11-67_S67_fastp.html

fastp -i /home/data/acropora_db/quality_control/AG_GAs11-67_S67_qc_R1.fastq.gz -I /home/data/acropora_db/quality_control/AG_GAs11-67_S67_qc_R2.fastq.gz -o /home/data/acropora_db/adapter_trim/AG_GAs11-67_S67_at_R1.fastq.gz -O /home/data/acropora_db/adapter_trim/AG_GAs11-67_S67_at_R2.fastq.gz --adapter_sequence GTCAGATCGGAAGAGCACACGTCTGAACTCCAGTCAC --adapter_sequence_r2 CAGAGATCGGAAGAGCGTCGTGTAGGGAAAGAC --cut_right --cut_window_size 4 --cut_mean_quality 20 --length_required 36 --length_limit 150 --average_qual 19 --thread 8 --json /home/data/acropora_db/adapter_trim/AG_GAs11-67_S67_fastp.json --html /home/data/acropora_db/adapter_trim/AG_GAs11-67_S67_fastp.html 
fastp v0.23.4, time used: 1 seconds

[2024-10-05 17:55:51,032] INFO database_accessor.py execute_cmd :
[cmd] fastp -i /home/data/acropora_db/quality_control/AS_ASTUS31_S161_qc_R1.fastq.gz -I /home/data/acropora_db/quality_control/AS_ASTUS31_S161_qc_R2.fastq.gz -o /home/data/acropora_db/adapter_trim/AS_ASTUS31_S161_at_R1.fastq.gz -O /home/data/acropora_db/adapter_trim/AS_ASTUS31_S161_at_R2.fastq.gz --adapter_sequence GTCAGATCGGAAGAGCACACGTCTGAACTCCAGTCAC --adapter_sequence_r2 CAGAGATCGGAAGAGCGTCGTGTAGGGAAAGAC --cut_right --cut_window_size 4 --cut_mean_quality 20 --length_required 36 --length_limit 150 --average_qual 19 --thread 8 --json /home/data/acropora_db/adapter_trim/AS_ASTUS31_S161_fastp.json --html /home/data/acropora_db/adapter_trim/AS_ASTUS31_S161_fastp.html
[2024-10-05 17:55:51,520] INFO database_accessor.py execute_cmd :
Read1 before filtering:
total reads: 158521
total bases: 12084495
Q20 bases: 11964325(99.0056%)
Q30 bases: 11633921(96.2715%)

Read2 before filtering:
total reads: 158521
total bases: 11411898
Q20 bases: 11287906(98.9135%)
Q30 bases: 10913654(95.634%)

Read1 after filtering:
total reads: 79051
total bases: 5841951
Q20 bases: 5798389(99.2543%)
Q30 bases: 5670180(97.0597%)

Read2 after filtering:
total reads: 79051
total bases: 5438862
Q20 bases: 5399343(99.2734%)
Q30 bases: 5262418(96.7559%)

Filtering result:
reads passed filter: 158102
reads failed due to low quality: 0
reads failed due to too many N: 0
reads failed due to too short: 158940
reads failed due to too long: 0
reads with adapter trimmed: 154518
bases trimmed due to adapters: 8207681

Duplication rate: 58.0768%

Insert size peak (evaluated by paired-end reads): 80

JSON report: /home/data/acropora_db/adapter_trim/AS_ASTUS31_S161_fastp.json
HTML report: /home/data/acropora_db/adapter_trim/AS_ASTUS31_S161_fastp.html

fastp -i /home/data/acropora_db/quality_control/AS_ASTUS31_S161_qc_R1.fastq.gz -I /home/data/acropora_db/quality_control/AS_ASTUS31_S161_qc_R2.fastq.gz -o /home/data/acropora_db/adapter_trim/AS_ASTUS31_S161_at_R1.fastq.gz -O /home/data/acropora_db/adapter_trim/AS_ASTUS31_S161_at_R2.fastq.gz --adapter_sequence GTCAGATCGGAAGAGCACACGTCTGAACTCCAGTCAC --adapter_sequence_r2 CAGAGATCGGAAGAGCGTCGTGTAGGGAAAGAC --cut_right --cut_window_size 4 --cut_mean_quality 20 --length_required 36 --length_limit 150 --average_qual 19 --thread 8 --json /home/data/acropora_db/adapter_trim/AS_ASTUS31_S161_fastp.json --html /home/data/acropora_db/adapter_trim/AS_ASTUS31_S161_fastp.html 
fastp v0.23.4, time used: 0 seconds

[2024-10-05 17:55:51,520] INFO database_accessor.py execute_cmd :
[cmd] fastp -i /home/data/acropora_db/quality_control/AM_A-1_S33_qc_R1.fastq.gz -I /home/data/acropora_db/quality_control/AM_A-1_S33_qc_R2.fastq.gz -o /home/data/acropora_db/adapter_trim/AM_A-1_S33_at_R1.fastq.gz -O /home/data/acropora_db/adapter_trim/AM_A-1_S33_at_R2.fastq.gz --adapter_sequence GTCAGATCGGAAGAGCACACGTCTGAACTCCAGTCAC --adapter_sequence_r2 CAGAGATCGGAAGAGCGTCGTGTAGGGAAAGAC --cut_right --cut_window_size 4 --cut_mean_quality 20 --length_required 36 --length_limit 150 --average_qual 19 --thread 8 --json /home/data/acropora_db/adapter_trim/AM_A-1_S33_fastp.json --html /home/data/acropora_db/adapter_trim/AM_A-1_S33_fastp.html
[2024-10-05 17:55:51,951] INFO database_accessor.py execute_cmd :
Read1 before filtering:
total reads: 93866
total bases: 7066298
Q20 bases: 7008421(99.1809%)
Q30 bases: 6804930(96.3012%)

Read2 before filtering:
total reads: 93866
total bases: 6587867
Q20 bases: 6517391(98.9302%)
Q30 bases: 6285324(95.4076%)

Read1 after filtering:
total reads: 70057
total bases: 5238507
Q20 bases: 5207195(99.4023%)
Q30 bases: 5082504(97.022%)

Read2 after filtering:
total reads: 70057
total bases: 4876236
Q20 bases: 4840109(99.2591%)
Q30 bases: 4707250(96.5345%)

Filtering result:
reads passed filter: 140114
reads failed due to low quality: 2
reads failed due to too many N: 0
reads failed due to too short: 47616
reads failed due to too long: 0
reads with adapter trimmed: 44894
bases trimmed due to adapters: 2404472

Duplication rate: 56.4027%

Insert size peak (evaluated by paired-end reads): 42

JSON report: /home/data/acropora_db/adapter_trim/AM_A-1_S33_fastp.json
HTML report: /home/data/acropora_db/adapter_trim/AM_A-1_S33_fastp.html

fastp -i /home/data/acropora_db/quality_control/AM_A-1_S33_qc_R1.fastq.gz -I /home/data/acropora_db/quality_control/AM_A-1_S33_qc_R2.fastq.gz -o /home/data/acropora_db/adapter_trim/AM_A-1_S33_at_R1.fastq.gz -O /home/data/acropora_db/adapter_trim/AM_A-1_S33_at_R2.fastq.gz --adapter_sequence GTCAGATCGGAAGAGCACACGTCTGAACTCCAGTCAC --adapter_sequence_r2 CAGAGATCGGAAGAGCGTCGTGTAGGGAAAGAC --cut_right --cut_window_size 4 --cut_mean_quality 20 --length_required 36 --length_limit 150 --average_qual 19 --thread 8 --json /home/data/acropora_db/adapter_trim/AM_A-1_S33_fastp.json --html /home/data/acropora_db/adapter_trim/AM_A-1_S33_fastp.html 
fastp v0.23.4, time used: 0 seconds

[2024-10-05 17:55:51,951] INFO database_accessor.py execute_cmd :
[cmd] fastp -i /home/data/acropora_db/quality_control/AP_TS1_S1_qc_R1.fastq.gz -I /home/data/acropora_db/quality_control/AP_TS1_S1_qc_R2.fastq.gz -o /home/data/acropora_db/adapter_trim/AP_TS1_S1_at_R1.fastq.gz -O /home/data/acropora_db/adapter_trim/AP_TS1_S1_at_R2.fastq.gz --adapter_sequence GTCAGATCGGAAGAGCACACGTCTGAACTCCAGTCAC --adapter_sequence_r2 CAGAGATCGGAAGAGCGTCGTGTAGGGAAAGAC --cut_right --cut_window_size 4 --cut_mean_quality 20 --length_required 36 --length_limit 150 --average_qual 19 --thread 8 --json /home/data/acropora_db/adapter_trim/AP_TS1_S1_fastp.json --html /home/data/acropora_db/adapter_trim/AP_TS1_S1_fastp.html
[2024-10-05 17:55:52,513] INFO database_accessor.py execute_cmd :
Read1 before filtering:
total reads: 231712
total bases: 17580299
Q20 bases: 17414800(99.0586%)
Q30 bases: 16830589(95.7355%)

Read2 before filtering:
total reads: 231712
total bases: 16739640
Q20 bases: 16514648(98.6559%)
Q30 bases: 15824490(94.533%)

Read1 after filtering:
total reads: 119529
total bases: 8749001
Q20 bases: 8688635(99.31%)
Q30 bases: 8447878(96.5582%)

Read2 after filtering:
total reads: 119529
total bases: 8129678
Q20 bases: 8057783(99.1156%)
Q30 bases: 7796800(95.9054%)

Filtering result:
reads passed filter: 239058
reads failed due to low quality: 20
reads failed due to too many N: 0
reads failed due to too short: 224346
reads failed due to too long: 0
reads with adapter trimmed: 223016
bases trimmed due to adapters: 11817632

Duplication rate: 68.6382%

Insert size peak (evaluated by paired-end reads): 56

JSON report: /home/data/acropora_db/adapter_trim/AP_TS1_S1_fastp.json
HTML report: /home/data/acropora_db/adapter_trim/AP_TS1_S1_fastp.html

fastp -i /home/data/acropora_db/quality_control/AP_TS1_S1_qc_R1.fastq.gz -I /home/data/acropora_db/quality_control/AP_TS1_S1_qc_R2.fastq.gz -o /home/data/acropora_db/adapter_trim/AP_TS1_S1_at_R1.fastq.gz -O /home/data/acropora_db/adapter_trim/AP_TS1_S1_at_R2.fastq.gz --adapter_sequence GTCAGATCGGAAGAGCACACGTCTGAACTCCAGTCAC --adapter_sequence_r2 CAGAGATCGGAAGAGCGTCGTGTAGGGAAAGAC --cut_right --cut_window_size 4 --cut_mean_quality 20 --length_required 36 --length_limit 150 --average_qual 19 --thread 8 --json /home/data/acropora_db/adapter_trim/AP_TS1_S1_fastp.json --html /home/data/acropora_db/adapter_trim/AP_TS1_S1_fastp.html 
fastp v0.23.4, time used: 1 seconds

[2024-10-05 17:55:52,514] INFO database_accessor.py adapter_trim :
所有样本的接头修剪已完成
[2024-10-05 17:55:52,514] INFO database_accessor.py logging_title :

#########################
#### fastq 转换为 fasta ####
#########################
[2024-10-05 17:55:52,514] INFO database_accessor.py execute_cmd :
[cmd] seqkit fq2fa -o /home/data/acropora_db/fasta/AG_GAs11-67_S67.fasta.gz /home/data/acropora_db/adapter_trim/AG_GAs11-67_S67_at_R1.fastq.gz /home/data/acropora_db/adapter_trim/AG_GAs11-67_S67_at_R2.fastq.gz
[2024-10-05 17:55:52,621] INFO database_accessor.py execute_cmd :
[cmd] seqkit fq2fa -o /home/data/acropora_db/fasta/AS_ASTUS31_S161.fasta.gz /home/data/acropora_db/adapter_trim/AS_ASTUS31_S161_at_R1.fastq.gz /home/data/acropora_db/adapter_trim/AS_ASTUS31_S161_at_R2.fastq.gz
[2024-10-05 17:55:52,906] INFO database_accessor.py execute_cmd :
[cmd] seqkit fq2fa -o /home/data/acropora_db/fasta/AM_A-1_S33.fasta.gz /home/data/acropora_db/adapter_trim/AM_A-1_S33_at_R1.fastq.gz /home/data/acropora_db/adapter_trim/AM_A-1_S33_at_R2.fastq.gz
[2024-10-05 17:55:53,043] INFO database_accessor.py execute_cmd :
[cmd] seqkit fq2fa -o /home/data/acropora_db/fasta/AP_TS1_S1.fasta.gz /home/data/acropora_db/adapter_trim/AP_TS1_S1_at_R1.fastq.gz /home/data/acropora_db/adapter_trim/AP_TS1_S1_at_R2.fastq.gz
[2024-10-05 17:55:53,393] INFO database_accessor.py fastq_to_fasta :
所有样本的 FASTQ 到 FASTA 转换已完成
[2024-10-05 17:55:53,393] INFO database_accessor.py execute_cmd :
[cmd] seqkit seq -m 80 -M 80 /home/data/acropora_db/fasta/AG_GAs11-67_S67.fasta.gz | gzip > /home/data/acropora_db/fasta/AG_GAs11-67_S67_uniform.fasta.gz
[2024-10-05 17:55:53,784] INFO database_accessor.py execute_cmd :
[33m[WARN][0m you may switch on flag -g/--remove-gaps to remove spaces

[2024-10-05 17:55:53,784] INFO database_accessor.py execute_cmd :
[cmd] seqkit seq -m 80 -M 80 /home/data/acropora_db/fasta/AS_ASTUS31_S161.fasta.gz | gzip > /home/data/acropora_db/fasta/AS_ASTUS31_S161_uniform.fasta.gz
[2024-10-05 17:55:54,293] INFO database_accessor.py execute_cmd :
[33m[WARN][0m you may switch on flag -g/--remove-gaps to remove spaces

[2024-10-05 17:55:54,293] INFO database_accessor.py execute_cmd :
[cmd] seqkit seq -m 80 -M 80 /home/data/acropora_db/fasta/AM_A-1_S33.fasta.gz | gzip > /home/data/acropora_db/fasta/AM_A-1_S33_uniform.fasta.gz
[2024-10-05 17:55:54,767] INFO database_accessor.py execute_cmd :
[33m[WARN][0m you may switch on flag -g/--remove-gaps to remove spaces

[2024-10-05 17:55:54,767] INFO database_accessor.py execute_cmd :
[cmd] seqkit seq -m 80 -M 80 /home/data/acropora_db/fasta/AP_TS1_S1.fasta.gz | gzip > /home/data/acropora_db/fasta/AP_TS1_S1_uniform.fasta.gz
[2024-10-05 17:55:55,673] INFO database_accessor.py execute_cmd :
[33m[WARN][0m you may switch on flag -g/--remove-gaps to remove spaces

[2024-10-05 17:55:55,673] INFO database_accessor.py logging_title :

#################
#### ustacks ####
#################
[2024-10-05 17:55:55,673] INFO database_accessor.py stacks :
Running ustacks for sample: AG_GAs11-67_S67
[2024-10-05 17:55:55,673] INFO database_accessor.py stacks :
Command: ustacks -f /home/data/acropora_db/fasta/AG_GAs11-67_S67_uniform.fasta.gz -o /home/data/acropora_db/ustacks --name AG_GAs11-67_S67 -i 1 -m 3 -M 2 -p 8
[2024-10-05 17:55:55,673] INFO database_accessor.py execute_cmd :
[cmd] ustacks -f /home/data/acropora_db/fasta/AG_GAs11-67_S67_uniform.fasta.gz -o /home/data/acropora_db/ustacks --name AG_GAs11-67_S67 -i 1 -m 3 -M 2 -p 8
[2024-10-05 17:55:56,137] INFO database_accessor.py execute_cmd :
ustacks parameters selected:
  Input file: '/home/data/acropora_db/fasta/AG_GAs11-67_S67_uniform.fasta.gz'
  Sample ID: 1
  Min depth of coverage to create a stack (m): 3
  Repeat removal algorithm: enabled
  Max distance allowed between stacks (M): 2
  Max distance allowed to align secondary reads: 4
  Max number of stacks allowed per de novo locus: 3
  Deleveraging algorithm: disabled
  Gapped assembly: enabled
  Minimum alignment length: 0.8
  Model type: SNP
  Alpha significance level for model: 0.05

Loading RAD-Tags...
Warning: Input reads contained 1 uncalled nucleotides.

Loaded 42595 reads; formed:
  1734 stacks representing 29473 primary reads (69.2%)
  11868 secondary stacks representing 13122 secondary reads (30.8%)

Stack coverage: mean=17.00; stdev=60.60; max=1955; n_reads=29473(69.2%)
Removing repetitive stacks: cov > 199 (mean+3*stdev)...
  Blacklisted 121 stacks.
Coverage after repeat removal: mean=13.16; stdev=21.91; max=190; n_reads=21222(49.8%)

Assembling stacks (max. dist. M=2)...
  Assembled 1613 stacks into 1408; blacklisted 17 stacks.
Coverage after assembling stacks: mean=13.95; stdev=22.82; max=194; n_reads=19161(45.0%)

Merging secondary stacks (max. dist. N=4 from consensus)...
  Merged 4822 out of 13122 secondary reads (36.7%), 638 merged with gapped alignments.
Coverage after merging secondary stacks: mean=17.45; stdev=27.76; max=227; n_reads=23983(56.3%)

Assembling stacks, allowing for gaps (min. match length 80.0%)...
  Assembled 1408 stacks into 1304 stacks.
Coverage after gapped assembly: mean=18.88; stdev=29.74; max=227; n_reads=23983(56.3%)

Merging secondary stacks, allowing for gaps (min. match length 80.0%)...
  Merged 1510 out of 8300 secondary reads (18.2%).
Coverage after merging gapped secondary stacks: mean=20.07; stdev=30.70; max=228; n_reads=25493(59.8%)

Final number of stacks built: 1304
Final coverage: mean=20.07; stdev=30.70; max=228; n_reads=25493(59.8%)
Calling consensus sequences and haplotypes for catalog assembly...
Writing tags, SNPs, and alleles files to '/home/data/acropora_db/ustacks/AG_GAs11-67_S67'...done.
ustacks is done.

[2024-10-05 17:55:56,137] INFO database_accessor.py stacks :
ustacks successfully processed sample: AG_GAs11-67_S67
[2024-10-05 17:55:56,137] INFO database_accessor.py stacks :
Running ustacks for sample: AS_ASTUS31_S161
[2024-10-05 17:55:56,137] INFO database_accessor.py stacks :
Command: ustacks -f /home/data/acropora_db/fasta/AS_ASTUS31_S161_uniform.fasta.gz -o /home/data/acropora_db/ustacks --name AS_ASTUS31_S161 -i 2 -m 3 -M 2 -p 8
[2024-10-05 17:55:56,137] INFO database_accessor.py execute_cmd :
[cmd] ustacks -f /home/data/acropora_db/fasta/AS_ASTUS31_S161_uniform.fasta.gz -o /home/data/acropora_db/ustacks --name AS_ASTUS31_S161 -i 2 -m 3 -M 2 -p 8
[2024-10-05 17:55:56,768] INFO database_accessor.py execute_cmd :
ustacks parameters selected:
  Input file: '/home/data/acropora_db/fasta/AS_ASTUS31_S161_uniform.fasta.gz'
  Sample ID: 2
  Min depth of coverage to create a stack (m): 3
  Repeat removal algorithm: enabled
  Max distance allowed between stacks (M): 2
  Max distance allowed to align secondary reads: 4
  Max number of stacks allowed per de novo locus: 3
  Deleveraging algorithm: disabled
  Gapped assembly: enabled
  Minimum alignment length: 0.8
  Model type: SNP
  Alpha significance level for model: 0.05

Loading RAD-Tags...
Warning: Input reads contained 28 uncalled nucleotides.

Loaded 53942 reads; formed:
  2358 stacks representing 34094 primary reads (63.2%)
  18039 secondary stacks representing 19848 secondary reads (36.8%)

Stack coverage: mean=14.46; stdev=53.71; max=1311; n_reads=34094(63.2%)
Removing repetitive stacks: cov > 176 (mean+3*stdev)...
  Blacklisted 206 stacks.
Coverage after repeat removal: mean=10.86; stdev=17.90; max=174; n_reads=23378(43.3%)

Assembling stacks (max. dist. M=2)...
  Assembled 2152 stacks into 1737; blacklisted 36 stacks.
Coverage after assembling stacks: mean=11.62; stdev=17.83; max=181; n_reads=19559(36.3%)

Merging secondary stacks (max. dist. N=4 from consensus)...
  Merged 7119 out of 19848 secondary reads (35.9%), 1155 merged with gapped alignments.
Coverage after merging secondary stacks: mean=15.85; stdev=23.02; max=217; n_reads=26678(49.5%)

Assembling stacks, allowing for gaps (min. match length 80.0%)...
  Assembled 1737 stacks into 1624 stacks.
Coverage after gapped assembly: mean=16.99; stdev=24.37; max=225; n_reads=26678(49.5%)

Merging secondary stacks, allowing for gaps (min. match length 80.0%)...
  Merged 2862 out of 12729 secondary reads (22.5%).
Coverage after merging gapped secondary stacks: mean=18.82; stdev=26.89; max=228; n_reads=29540(54.8%)

Final number of stacks built: 1624
Final coverage: mean=18.82; stdev=26.89; max=228; n_reads=29540(54.8%)
Calling consensus sequences and haplotypes for catalog assembly...
Writing tags, SNPs, and alleles files to '/home/data/acropora_db/ustacks/AS_ASTUS31_S161'...done.
ustacks is done.

[2024-10-05 17:55:56,769] INFO database_accessor.py stacks :
ustacks successfully processed sample: AS_ASTUS31_S161
[2024-10-05 17:55:56,769] INFO database_accessor.py stacks :
Running ustacks for sample: AM_A-1_S33
[2024-10-05 17:55:56,769] INFO database_accessor.py stacks :
Command: ustacks -f /home/data/acropora_db/fasta/AM_A-1_S33_uniform.fasta.gz -o /home/data/acropora_db/ustacks --name AM_A-1_S33 -i 3 -m 3 -M 2 -p 8
[2024-10-05 17:55:56,769] INFO database_accessor.py execute_cmd :
[cmd] ustacks -f /home/data/acropora_db/fasta/AM_A-1_S33_uniform.fasta.gz -o /home/data/acropora_db/ustacks --name AM_A-1_S33 -i 3 -m 3 -M 2 -p 8
[2024-10-05 17:55:57,341] INFO database_accessor.py execute_cmd :
ustacks parameters selected:
  Input file: '/home/data/acropora_db/fasta/AM_A-1_S33_uniform.fasta.gz'
  Sample ID: 3
  Min depth of coverage to create a stack (m): 3
  Repeat removal algorithm: enabled
  Max distance allowed between stacks (M): 2
  Max distance allowed to align secondary reads: 4
  Max number of stacks allowed per de novo locus: 3
  Deleveraging algorithm: disabled
  Gapped assembly: enabled
  Minimum alignment length: 0.8
  Model type: SNP
  Alpha significance level for model: 0.05

Loading RAD-Tags...

Loaded 50057 reads; formed:
  2023 stacks representing 35081 primary reads (70.1%)
  13554 secondary stacks representing 14976 secondary reads (29.9%)

Stack coverage: mean=17.34; stdev=44.82; max=818; n_reads=35081(70.1%)
Removing repetitive stacks: cov > 152 (mean+3*stdev)...
  Blacklisted 98 stacks.
Coverage after repeat removal: mean=13.00; stdev=19.48; max=149; n_reads=25028(50.0%)

Assembling stacks (max. dist. M=2)...
  Assembled 1925 stacks into 1721; blacklisted 16 stacks.
Coverage after assembling stacks: mean=13.89; stdev=22.36; max=262; n_reads=23288(46.5%)

Merging secondary stacks (max. dist. N=4 from consensus)...
  Merged 5032 out of 14976 secondary reads (33.6%), 440 merged with gapped alignments.
Coverage after merging secondary stacks: mean=16.89; stdev=26.65; max=305; n_reads=28320(56.6%)

Assembling stacks, allowing for gaps (min. match length 80.0%)...
  Assembled 1721 stacks into 1565 stacks.
Coverage after gapped assembly: mean=18.62; stdev=28.76; max=305; n_reads=28320(56.6%)

Merging secondary stacks, allowing for gaps (min. match length 80.0%)...
  Merged 2581 out of 9944 secondary reads (26.0%).
Coverage after merging gapped secondary stacks: mean=20.32; stdev=30.45; max=306; n_reads=30901(61.7%)

Final number of stacks built: 1565
Final coverage: mean=20.32; stdev=30.45; max=306; n_reads=30901(61.7%)
Calling consensus sequences and haplotypes for catalog assembly...
Writing tags, SNPs, and alleles files to '/home/data/acropora_db/ustacks/AM_A-1_S33'...done.
ustacks is done.

[2024-10-05 17:55:57,342] INFO database_accessor.py stacks :
ustacks successfully processed sample: AM_A-1_S33
[2024-10-05 17:55:57,342] INFO database_accessor.py stacks :
Running ustacks for sample: AP_TS1_S1
[2024-10-05 17:55:57,342] INFO database_accessor.py stacks :
Command: ustacks -f /home/data/acropora_db/fasta/AP_TS1_S1_uniform.fasta.gz -o /home/data/acropora_db/ustacks --name AP_TS1_S1 -i 4 -m 3 -M 2 -p 8
[2024-10-05 17:55:57,342] INFO database_accessor.py execute_cmd :
[cmd] ustacks -f /home/data/acropora_db/fasta/AP_TS1_S1_uniform.fasta.gz -o /home/data/acropora_db/ustacks --name AP_TS1_S1 -i 4 -m 3 -M 2 -p 8
[2024-10-05 17:55:58,507] INFO database_accessor.py execute_cmd :
ustacks parameters selected:
  Input file: '/home/data/acropora_db/fasta/AP_TS1_S1_uniform.fasta.gz'
  Sample ID: 4
  Min depth of coverage to create a stack (m): 3
  Repeat removal algorithm: enabled
  Max distance allowed between stacks (M): 2
  Max distance allowed to align secondary reads: 4
  Max number of stacks allowed per de novo locus: 3
  Deleveraging algorithm: disabled
  Gapped assembly: enabled
  Minimum alignment length: 0.8
  Model type: SNP
  Alpha significance level for model: 0.05

Loading RAD-Tags...

Loaded 132844 reads; formed:
  4103 stacks representing 106978 primary reads (80.5%)
  23273 secondary stacks representing 25866 secondary reads (19.5%)

Stack coverage: mean=26.07; stdev=162.96; max=3789; n_reads=106978(80.5%)
Removing repetitive stacks: cov > 515 (mean+3*stdev)...
  Blacklisted 810 stacks.
Coverage after repeat removal: mean=18.76; stdev=45.94; max=503; n_reads=61763(46.5%)

Assembling stacks (max. dist. M=2)...
  Assembled 3293 stacks into 2828; blacklisted 37 stacks.
Coverage after assembling stacks: mean=18.73; stdev=41.41; max=505; n_reads=51877(39.1%)

Merging secondary stacks (max. dist. N=4 from consensus)...
  Merged 10842 out of 25866 secondary reads (41.9%), 1929 merged with gapped alignments.
Coverage after merging secondary stacks: mean=22.64; stdev=48.36; max=558; n_reads=62719(47.2%)

Assembling stacks, allowing for gaps (min. match length 80.0%)...
  Assembled 2828 stacks into 2190 stacks.
Coverage after gapped assembly: mean=29.42; stdev=59.81; max=729; n_reads=62719(47.2%)

Merging secondary stacks, allowing for gaps (min. match length 80.0%)...
  Merged 5523 out of 15024 secondary reads (36.8%).
Coverage after merging gapped secondary stacks: mean=32.01; stdev=62.02; max=735; n_reads=68242(51.4%)

Final number of stacks built: 2190
Final coverage: mean=32.01; stdev=62.02; max=735; n_reads=68242(51.4%)
Calling consensus sequences and haplotypes for catalog assembly...
Writing tags, SNPs, and alleles files to '/home/data/acropora_db/ustacks/AP_TS1_S1'...done.
ustacks is done.

[2024-10-05 17:55:58,507] INFO database_accessor.py stacks :
ustacks successfully processed sample: AP_TS1_S1
[2024-10-05 17:55:58,508] INFO database_accessor.py run :
stacks 处理完成
[2024-10-05 17:55:58,508] INFO database_accessor.py run :
当前 files_to_process: {'AG_GAs11-67_S67': '/home/data/acropora_db/ustacks/AG_GAs11-67_S67.tags.tsv.gz', 'AS_ASTUS31_S161': '/home/data/acropora_db/ustacks/AS_ASTUS31_S161.tags.tsv.gz', 'AM_A-1_S33': '/home/data/acropora_db/ustacks/AM_A-1_S33.tags.tsv.gz', 'AP_TS1_S1': '/home/data/acropora_db/ustacks/AP_TS1_S1.tags.tsv.gz'}
[2024-10-05 17:55:58,508] INFO database_accessor.py logging_title :

#################################
#### extract consensus fasta ####
#################################
[2024-10-05 17:55:58,508] INFO database_accessor.py extract_consensus_fasta :
[cmd] zcat /home/data/acropora_db/ustacks/AG_GAs11-67_S67.tags.tsv.gz | awk '{if($3=="consensus") {printf ">AG_GAs11-67_S67_%s\n%s\n", $1, $4}}' > /home/data/acropora_db/consensus_fasta/AG_GAs11-67_S67.fa
[2024-10-05 17:55:58,508] INFO database_accessor.py execute_cmd :
[cmd] zcat /home/data/acropora_db/ustacks/AG_GAs11-67_S67.tags.tsv.gz | awk '{if($3=="consensus") {printf ">AG_GAs11-67_S67_%s\n%s\n", $1, $4}}' > /home/data/acropora_db/consensus_fasta/AG_GAs11-67_S67.fa
[2024-10-05 17:55:58,530] INFO database_accessor.py extract_consensus_fasta :
成功生成共识序列文件: /home/data/acropora_db/consensus_fasta/AG_GAs11-67_S67.fa
[2024-10-05 17:55:58,530] INFO database_accessor.py extract_consensus_fasta :
检查生成的 FASTA 文件: /home/data/acropora_db/consensus_fasta/AG_GAs11-67_S67.fa
[2024-10-05 17:55:58,530] INFO database_accessor.py execute_cmd :
[cmd] head -n 10 /home/data/acropora_db/consensus_fasta/AG_GAs11-67_S67.fa
[2024-10-05 17:55:58,531] INFO database_accessor.py execute_cmd :
>AG_GAs11-67_S67_1
ACTACCGCTACGCCTACCCCTTTCCTCACGTCCATGTATACATCTACTACCCCTACCACGATATTAACCACTACCCTCCC
>AG_GAs11-67_S67_1
CCTAACAACTGACAGTTGATCTTGTCTCATTTCTTTTACTAGATTTGATTTGCTTTGACACATTAATTCCTTCAAAGTTTGA
>AG_GAs11-67_S67_1
TCCCGCGATACGACTTGCCTCGGTTGTTCCACGAGGGCTGTTTTTGCCGCCCCGATGGCGGTGTCGCTCTCAATAAAAAAGAGC
>AG_GAs11-67_S67_1
CCAATTTCTTGGCCTCCCTGTTCACCCCAGCAGCTTTGCAATCGGGTATCTCACCATCAGATGCCCGAGTACCTTTCATTTCT
>AG_GAs11-67_S67_1
GACGACGACGAAGACGACGACAACGACGACAACGACGACAATGACGACAATGACGACAACAAGGACAACGACAACGGCAACGACAA

[2024-10-05 17:55:58,531] INFO database_accessor.py extract_consensus_fasta :
[cmd] zcat /home/data/acropora_db/ustacks/AS_ASTUS31_S161.tags.tsv.gz | awk '{if($3=="consensus") {printf ">AS_ASTUS31_S161_%s\n%s\n", $1, $4}}' > /home/data/acropora_db/consensus_fasta/AS_ASTUS31_S161.fa
[2024-10-05 17:55:58,531] INFO database_accessor.py execute_cmd :
[cmd] zcat /home/data/acropora_db/ustacks/AS_ASTUS31_S161.tags.tsv.gz | awk '{if($3=="consensus") {printf ">AS_ASTUS31_S161_%s\n%s\n", $1, $4}}' > /home/data/acropora_db/consensus_fasta/AS_ASTUS31_S161.fa
[2024-10-05 17:55:58,556] INFO database_accessor.py extract_consensus_fasta :
成功生成共识序列文件: /home/data/acropora_db/consensus_fasta/AS_ASTUS31_S161.fa
[2024-10-05 17:55:58,556] INFO database_accessor.py extract_consensus_fasta :
检查生成的 FASTA 文件: /home/data/acropora_db/consensus_fasta/AS_ASTUS31_S161.fa
[2024-10-05 17:55:58,556] INFO database_accessor.py execute_cmd :
[cmd] head -n 10 /home/data/acropora_db/consensus_fasta/AS_ASTUS31_S161.fa
[2024-10-05 17:55:58,557] INFO database_accessor.py execute_cmd :
>AS_ASTUS31_S161_2
ATCATCATCATCATCATCATCATCATCACCATCATCACCATCACCATCATCACGATCATCCGTCATCATCAAAATCGTCACCATCATCA
>AS_ASTUS31_S161_2
CCTTCTCAAAACTTAGAACTGCTTATACAAATCTTCGAAAATGAAACAGGCTCGGAAATAAATGATTAACTTGTTCCCTTT
>AS_ASTUS31_S161_2
CAGTTCCTTTGCGATGGTTTCAGGTTCGGAAAGCGCAGAAAAATGATTGAAAGAAATCATGGGAGTACGTTCACCGTGAAAA
>AS_ASTUS31_S161_2
CTTGTCTTGAAAATATAAGACGATGTAAGGTGTTTCAATAGGTTTTGAAACTTCATTAGGCTTGATTTACAAATAGTTCTT
>AS_ASTUS31_S161_2
CCATGAACAGAAAGCGGTAGAGGTGCCTTGATGTCAACGGAGCGCAATGATCGTTGAACTTCTCTTCTACAGCCTTAATCTT

[2024-10-05 17:55:58,557] INFO database_accessor.py extract_consensus_fasta :
[cmd] zcat /home/data/acropora_db/ustacks/AM_A-1_S33.tags.tsv.gz | awk '{if($3=="consensus") {printf ">AM_A-1_S33_%s\n%s\n", $1, $4}}' > /home/data/acropora_db/consensus_fasta/AM_A-1_S33.fa
[2024-10-05 17:55:58,557] INFO database_accessor.py execute_cmd :
[cmd] zcat /home/data/acropora_db/ustacks/AM_A-1_S33.tags.tsv.gz | awk '{if($3=="consensus") {printf ">AM_A-1_S33_%s\n%s\n", $1, $4}}' > /home/data/acropora_db/consensus_fasta/AM_A-1_S33.fa
[2024-10-05 17:55:58,582] INFO database_accessor.py extract_consensus_fasta :
成功生成共识序列文件: /home/data/acropora_db/consensus_fasta/AM_A-1_S33.fa
[2024-10-05 17:55:58,582] INFO database_accessor.py extract_consensus_fasta :
检查生成的 FASTA 文件: /home/data/acropora_db/consensus_fasta/AM_A-1_S33.fa
[2024-10-05 17:55:58,582] INFO database_accessor.py execute_cmd :
[cmd] head -n 10 /home/data/acropora_db/consensus_fasta/AM_A-1_S33.fa
[2024-10-05 17:55:58,583] INFO database_accessor.py execute_cmd :
>AM_A-1_S33_3
CCTTGTCCTGTTCTTGGTTGGTTGATCGATAGTATCACCTGGGCAGATGTCAGGCAGCCATGGAGCCGTCTCTCTTCTTAGC
>AM_A-1_S33_3
CCAGAACGGTTGTTTACGCCGTTACTCGTATCTTTAAACCAGACTTTGCAGGCATTAATTTCGTTACAGCTCTACTTGGAAA
>AM_A-1_S33_3
TTCCACATTACCATTGTTTGTCAGCACTACTTTGATCGATATCAGAGATAAAGTCAACGCTAAATGAATCCCAGATATCATCGT
>AM_A-1_S33_3
CCTTGTCTCTTGGTTGCTTGTTTGGTTGTCACTTGTTTGTTGCTGACTTGTTTGTTACTTGTTACTGAATCATTTCTTTGTA
>AM_A-1_S33_3
GAAGGGCTAACGCTCGAAAGGTCAGCTTTGTAATCTAATTAGAAAGTGACGACGAAGGGCTAACACTCGAAACGTCATCGT

[2024-10-05 17:55:58,583] INFO database_accessor.py extract_consensus_fasta :
[cmd] zcat /home/data/acropora_db/ustacks/AP_TS1_S1.tags.tsv.gz | awk '{if($3=="consensus") {printf ">AP_TS1_S1_%s\n%s\n", $1, $4}}' > /home/data/acropora_db/consensus_fasta/AP_TS1_S1.fa
[2024-10-05 17:55:58,583] INFO database_accessor.py execute_cmd :
[cmd] zcat /home/data/acropora_db/ustacks/AP_TS1_S1.tags.tsv.gz | awk '{if($3=="consensus") {printf ">AP_TS1_S1_%s\n%s\n", $1, $4}}' > /home/data/acropora_db/consensus_fasta/AP_TS1_S1.fa
[2024-10-05 17:55:58,650] INFO database_accessor.py extract_consensus_fasta :
成功生成共识序列文件: /home/data/acropora_db/consensus_fasta/AP_TS1_S1.fa
[2024-10-05 17:55:58,650] INFO database_accessor.py extract_consensus_fasta :
检查生成的 FASTA 文件: /home/data/acropora_db/consensus_fasta/AP_TS1_S1.fa
[2024-10-05 17:55:58,650] INFO database_accessor.py execute_cmd :
[cmd] head -n 10 /home/data/acropora_db/consensus_fasta/AP_TS1_S1.fa
[2024-10-05 17:55:58,651] INFO database_accessor.py execute_cmd :
>AP_TS1_S1_4
TGTTCTACCACACCCTGAACACTCCAATGTCTATGTTTCCCAACCTTATGAAGCGATACCGGACCAACTCCATATTTTGCAGG
>AP_TS1_S1_4
TCGTTTCCAAAGACTTCGCGCTCGCGTCGGTTTTTTGGTTTTTTTCCGACTAAGTTCGGGTTCCTCGTCTTCTTCTTCGGAAC
>AP_TS1_S1_4
CTTCTCTCTTCCAGTCTCTGCCTGTATTTTTCATGAGCTCGTCTAATGCATGAAATAAACTCCTTGTTGAAGTCCATGGCATG
>AP_TS1_S1_4
ACACAACATTCGACAGAAGGAACATGGATGAATATGGCCCCTTACTGGAATTGAACATCTGCAAAATAGGTCCGGTACAAGG
>AP_TS1_S1_4
CCCTTTTTACTCAGAACAAATGTAAGATGGCTGGAATTTCGTTAGTTCAAATTACCATATGACTTGATCTGCATTCGCTTT

[2024-10-05 17:55:58,651] INFO database_accessor.py logging_title :

######################
#### make blastdb ####
######################
[2024-10-05 17:55:58,651] INFO database_accessor.py make_blastdb :
合并 FASTA 文件到: /home/data/acropora_db/blastdb/merged_consensus.fasta
[2024-10-05 17:55:58,652] INFO database_accessor.py execute_cmd :
[cmd] cat /home/data/acropora_db/consensus_fasta/AG_GAs11-67_S67.fa /home/data/acropora_db/consensus_fasta/AS_ASTUS31_S161.fa /home/data/acropora_db/consensus_fasta/AM_A-1_S33.fa /home/data/acropora_db/consensus_fasta/AP_TS1_S1.fa > /home/data/acropora_db/blastdb/merged_consensus.fasta
[2024-10-05 17:55:58,654] INFO database_accessor.py make_blastdb :
检查合并后的 FASTA 文件格式
[2024-10-05 17:55:58,654] INFO database_accessor.py execute_cmd :
[cmd] head -n 10 /home/data/acropora_db/blastdb/merged_consensus.fasta
[2024-10-05 17:55:58,655] INFO database_accessor.py execute_cmd :
>AG_GAs11-67_S67_1
ACTACCGCTACGCCTACCCCTTTCCTCACGTCCATGTATACATCTACTACCCCTACCACGATATTAACCACTACCCTCCC
>AG_GAs11-67_S67_1
CCTAACAACTGACAGTTGATCTTGTCTCATTTCTTTTACTAGATTTGATTTGCTTTGACACATTAATTCCTTCAAAGTTTGA
>AG_GAs11-67_S67_1
TCCCGCGATACGACTTGCCTCGGTTGTTCCACGAGGGCTGTTTTTGCCGCCCCGATGGCGGTGTCGCTCTCAATAAAAAAGAGC
>AG_GAs11-67_S67_1
CCAATTTCTTGGCCTCCCTGTTCACCCCAGCAGCTTTGCAATCGGGTATCTCACCATCAGATGCCCGAGTACCTTTCATTTCT
>AG_GAs11-67_S67_1
GACGACGACGAAGACGACGACAACGACGACAACGACGACAATGACGACAATGACGACAACAAGGACAACGACAACGGCAACGACAA

[2024-10-05 17:55:58,655] INFO database_accessor.py make_blastdb :
创建 BLAST 数据库: /home/data/acropora_db/blastdb/
[2024-10-05 17:55:58,655] INFO database_accessor.py execute_cmd :
[cmd] makeblastdb -in /home/data/acropora_db/blastdb/merged_consensus.fasta -out /home/data/acropora_db/blastdb/ -dbtype nucl -parse_seqids
[2024-10-05 17:55:58,675] INFO database_accessor.py execute_cmd :


Building a new DB, current time: 10/05/2024 17:55:58
New DB name:   /home/data/acropora_db/blastdb
New DB title:  /home/data/acropora_db/blastdb/merged_consensus.fasta
Sequence type: Nucleotide
Deleted existing Nucleotide BLAST database named /home/data/acropora_db/blastdb
Keep MBits: T
Maximum file size: 1000000000B



[2024-10-05 17:55:58,675] INFO database_accessor.py execute_cmd :
BLAST Database creation error: Error: Duplicate seq_ids are found: 
LCL|AG_GAS11-67_S67_1


[2024-10-05 17:55:58,675] ERROR database_accessor.py make_blastdb :
BLAST 数据库创建失败: /home/data/acropora_db/blastdb/
[2024-10-05 17:55:58,675] INFO database_accessor.py run :
处理��成
[2024-10-05 17:55:58,676] INFO ACF.py execute_cmd :
[cmd] cd /home/data/acropora_db/ && tree . > tree.txt
[2024-10-05 17:55:58,679] INFO ACF.py write_analysis_complete_flag :
ANCAT_ANALYSIS_COMPLETED
[2024-10-05 17:58:08,728] INFO database_accessor.py execute_cmd :
[cmd] cp mkdb_acropora.conf /home/data/acropora_db/
[2024-10-05 17:58:08,730] INFO database_accessor.py logging_title :

########################
#### load fastq dir ####
########################
[2024-10-05 17:58:08,731] INFO database_accessor.py logging_title :

#################################
#### quality control : fastq ####
#################################
[2024-10-05 17:58:08,731] INFO database_accessor.py quality_control :
Processing sample: AG_GAs11-67_S67
[2024-10-05 17:58:08,731] INFO database_accessor.py execute_cmd :
[cmd] fastp -i /home/data/acropora/AG_GAs11-67_S67_L001_R1_001.fastq.gz -I /home/data/acropora/AG_GAs11-67_S67_L001_R2_001.fastq.gz -o /home/data/acropora_db/quality_control/AG_GAs11-67_S67_qc_R1.fastq.gz -O /home/data/acropora_db/quality_control/AG_GAs11-67_S67_qc_R2.fastq.gz -q 30 -f 0 -F 15 --cut_right --thread 8 --json /home/data/acropora_db/quality_control/AG_GAs11-67_S67_fastp.json --html /home/data/acropora_db/quality_control/AG_GAs11-67_S67_fastp.html
[2024-10-05 17:58:09,173] INFO database_accessor.py execute_cmd :
Read1 before filtering:
total reads: 82521
total bases: 6601680
Q20 bases: 6416163(97.1899%)
Q30 bases: 6082997(92.1432%)

Read2 before filtering:
total reads: 82521
total bases: 7756974
Q20 bases: 7322026(94.3928%)
Q30 bases: 6779442(87.398%)

Read1 after filtering:
total reads: 79298
total bases: 5996604
Q20 bases: 5914403(98.6292%)
Q30 bases: 5679288(94.7084%)

Read2 after filtering:
total reads: 79298
total bases: 5490991
Q20 bases: 5383923(98.0501%)
Q30 bases: 5084929(92.6049%)

Filtering result:
reads passed filter: 158596
reads failed due to low quality: 2226
reads failed due to too many N: 0
reads failed due to too short: 4220
reads with adapter trimmed: 15980
bases trimmed due to adapters: 278157

Duplication rate: 41.8899%

Insert size peak (evaluated by paired-end reads): 64

JSON report: /home/data/acropora_db/quality_control/AG_GAs11-67_S67_fastp.json
HTML report: /home/data/acropora_db/quality_control/AG_GAs11-67_S67_fastp.html

fastp -i /home/data/acropora/AG_GAs11-67_S67_L001_R1_001.fastq.gz -I /home/data/acropora/AG_GAs11-67_S67_L001_R2_001.fastq.gz -o /home/data/acropora_db/quality_control/AG_GAs11-67_S67_qc_R1.fastq.gz -O /home/data/acropora_db/quality_control/AG_GAs11-67_S67_qc_R2.fastq.gz -q 30 -f 0 -F 15 --cut_right --thread 8 --json /home/data/acropora_db/quality_control/AG_GAs11-67_S67_fastp.json --html /home/data/acropora_db/quality_control/AG_GAs11-67_S67_fastp.html 
fastp v0.23.4, time used: 1 seconds

[2024-10-05 17:58:09,173] WARNING database_accessor.py quality_control :
fastp for AG_GAs11-67_S67 produced warnings: Read1 before filtering:
total reads: 82521
total bases: 6601680
Q20 bases: 6416163(97.1899%)
Q30 bases: 6082997(92.1432%)

Read2 before filtering:
total reads: 82521
total bases: 7756974
Q20 bases: 7322026(94.3928%)
Q30 bases: 6779442(87.398%)

Read1 after filtering:
total reads: 79298
total bases: 5996604
Q20 bases: 5914403(98.6292%)
Q30 bases: 5679288(94.7084%)

Read2 after filtering:
total reads: 79298
total bases: 5490991
Q20 bases: 5383923(98.0501%)
Q30 bases: 5084929(92.6049%)

Filtering result:
reads passed filter: 158596
reads failed due to low quality: 2226
reads failed due to too many N: 0
reads failed due to too short: 4220
reads with adapter trimmed: 15980
bases trimmed due to adapters: 278157

Duplication rate: 41.8899%

Insert size peak (evaluated by paired-end reads): 64

JSON report: /home/data/acropora_db/quality_control/AG_GAs11-67_S67_fastp.json
HTML report: /home/data/acropora_db/quality_control/AG_GAs11-67_S67_fastp.html

fastp -i /home/data/acropora/AG_GAs11-67_S67_L001_R1_001.fastq.gz -I /home/data/acropora/AG_GAs11-67_S67_L001_R2_001.fastq.gz -o /home/data/acropora_db/quality_control/AG_GAs11-67_S67_qc_R1.fastq.gz -O /home/data/acropora_db/quality_control/AG_GAs11-67_S67_qc_R2.fastq.gz -q 30 -f 0 -F 15 --cut_right --thread 8 --json /home/data/acropora_db/quality_control/AG_GAs11-67_S67_fastp.json --html /home/data/acropora_db/quality_control/AG_GAs11-67_S67_fastp.html 
fastp v0.23.4, time used: 1 seconds

[2024-10-05 17:58:09,173] INFO database_accessor.py quality_control :
Finished processing sample: AG_GAs11-67_S67
[2024-10-05 17:58:09,173] INFO database_accessor.py quality_control :
Processing sample: AS_ASTUS31_S161
[2024-10-05 17:58:09,173] INFO database_accessor.py execute_cmd :
[cmd] fastp -i /home/data/acropora/AS_ASTUS31_S161_L001_R1_001.fastq.gz -I /home/data/acropora/AS_ASTUS31_S161_L001_R2_001.fastq.gz -o /home/data/acropora_db/quality_control/AS_ASTUS31_S161_qc_R1.fastq.gz -O /home/data/acropora_db/quality_control/AS_ASTUS31_S161_qc_R2.fastq.gz -q 30 -f 0 -F 15 --cut_right --thread 8 --json /home/data/acropora_db/quality_control/AS_ASTUS31_S161_fastp.json --html /home/data/acropora_db/quality_control/AS_ASTUS31_S161_fastp.html
[2024-10-05 17:58:09,749] INFO database_accessor.py execute_cmd :
Read1 before filtering:
total reads: 162226
total bases: 12978080
Q20 bases: 12762049(98.3354%)
Q30 bases: 12317675(94.9114%)

Read2 before filtering:
total reads: 162226
total bases: 15249244
Q20 bases: 14935119(97.9401%)
Q30 bases: 14342176(94.0517%)

Read1 after filtering:
total reads: 158521
total bases: 12084495
Q20 bases: 11964325(99.0056%)
Q30 bases: 11633921(96.2715%)

Read2 after filtering:
total reads: 158521
total bases: 11411898
Q20 bases: 11287906(98.9135%)
Q30 bases: 10913654(95.634%)

Filtering result:
reads passed filter: 317042
reads failed due to low quality: 2624
reads failed due to too many N: 0
reads failed due to too short: 4786
reads with adapter trimmed: 58926
bases trimmed due to adapters: 1142077

Duplication rate: 56.3621%

Insert size peak (evaluated by paired-end reads): 95

JSON report: /home/data/acropora_db/quality_control/AS_ASTUS31_S161_fastp.json
HTML report: /home/data/acropora_db/quality_control/AS_ASTUS31_S161_fastp.html

fastp -i /home/data/acropora/AS_ASTUS31_S161_L001_R1_001.fastq.gz -I /home/data/acropora/AS_ASTUS31_S161_L001_R2_001.fastq.gz -o /home/data/acropora_db/quality_control/AS_ASTUS31_S161_qc_R1.fastq.gz -O /home/data/acropora_db/quality_control/AS_ASTUS31_S161_qc_R2.fastq.gz -q 30 -f 0 -F 15 --cut_right --thread 8 --json /home/data/acropora_db/quality_control/AS_ASTUS31_S161_fastp.json --html /home/data/acropora_db/quality_control/AS_ASTUS31_S161_fastp.html 
fastp v0.23.4, time used: 0 seconds

[2024-10-05 17:58:09,750] WARNING database_accessor.py quality_control :
fastp for AS_ASTUS31_S161 produced warnings: Read1 before filtering:
total reads: 162226
total bases: 12978080
Q20 bases: 12762049(98.3354%)
Q30 bases: 12317675(94.9114%)

Read2 before filtering:
total reads: 162226
total bases: 15249244
Q20 bases: 14935119(97.9401%)
Q30 bases: 14342176(94.0517%)

Read1 after filtering:
total reads: 158521
total bases: 12084495
Q20 bases: 11964325(99.0056%)
Q30 bases: 11633921(96.2715%)

Read2 after filtering:
total reads: 158521
total bases: 11411898
Q20 bases: 11287906(98.9135%)
Q30 bases: 10913654(95.634%)

Filtering result:
reads passed filter: 317042
reads failed due to low quality: 2624
reads failed due to too many N: 0
reads failed due to too short: 4786
reads with adapter trimmed: 58926
bases trimmed due to adapters: 1142077

Duplication rate: 56.3621%

Insert size peak (evaluated by paired-end reads): 95

JSON report: /home/data/acropora_db/quality_control/AS_ASTUS31_S161_fastp.json
HTML report: /home/data/acropora_db/quality_control/AS_ASTUS31_S161_fastp.html

fastp -i /home/data/acropora/AS_ASTUS31_S161_L001_R1_001.fastq.gz -I /home/data/acropora/AS_ASTUS31_S161_L001_R2_001.fastq.gz -o /home/data/acropora_db/quality_control/AS_ASTUS31_S161_qc_R1.fastq.gz -O /home/data/acropora_db/quality_control/AS_ASTUS31_S161_qc_R2.fastq.gz -q 30 -f 0 -F 15 --cut_right --thread 8 --json /home/data/acropora_db/quality_control/AS_ASTUS31_S161_fastp.json --html /home/data/acropora_db/quality_control/AS_ASTUS31_S161_fastp.html 
fastp v0.23.4, time used: 0 seconds

[2024-10-05 17:58:09,750] INFO database_accessor.py quality_control :
Finished processing sample: AS_ASTUS31_S161
[2024-10-05 17:58:09,750] INFO database_accessor.py quality_control :
Processing sample: AP_TS1_S1
[2024-10-05 17:58:09,750] INFO database_accessor.py execute_cmd :
[cmd] fastp -i /home/data/acropora/AP_TS1_S1_L001_R1_001.fastq.gz -I /home/data/acropora/AP_TS1_S1_L001_R2_001.fastq.gz -o /home/data/acropora_db/quality_control/AP_TS1_S1_qc_R1.fastq.gz -O /home/data/acropora_db/quality_control/AP_TS1_S1_qc_R2.fastq.gz -q 30 -f 0 -F 15 --cut_right --thread 8 --json /home/data/acropora_db/quality_control/AP_TS1_S1_fastp.json --html /home/data/acropora_db/quality_control/AP_TS1_S1_fastp.html
[2024-10-05 17:58:10,471] INFO database_accessor.py execute_cmd :
Read1 before filtering:
total reads: 248601
total bases: 19888080
Q20 bases: 19480257(97.9494%)
Q30 bases: 18588142(93.4637%)

Read2 before filtering:
total reads: 248601
total bases: 23617095
Q20 bases: 22812090(96.5914%)
Q30 bases: 21475937(90.9339%)

Read1 after filtering:
total reads: 231712
total bases: 17580299
Q20 bases: 17414800(99.0586%)
Q30 bases: 16830589(95.7355%)

Read2 after filtering:
total reads: 231712
total bases: 16739640
Q20 bases: 16514648(98.6559%)
Q30 bases: 15824490(94.533%)

Filtering result:
reads passed filter: 463424
reads failed due to low quality: 12162
reads failed due to too many N: 0
reads failed due to too short: 21616
reads with adapter trimmed: 99544
bases trimmed due to adapters: 1530502

Duplication rate: 64.4881%

Insert size peak (evaluated by paired-end reads): 71

JSON report: /home/data/acropora_db/quality_control/AP_TS1_S1_fastp.json
HTML report: /home/data/acropora_db/quality_control/AP_TS1_S1_fastp.html

fastp -i /home/data/acropora/AP_TS1_S1_L001_R1_001.fastq.gz -I /home/data/acropora/AP_TS1_S1_L001_R2_001.fastq.gz -o /home/data/acropora_db/quality_control/AP_TS1_S1_qc_R1.fastq.gz -O /home/data/acropora_db/quality_control/AP_TS1_S1_qc_R2.fastq.gz -q 30 -f 0 -F 15 --cut_right --thread 8 --json /home/data/acropora_db/quality_control/AP_TS1_S1_fastp.json --html /home/data/acropora_db/quality_control/AP_TS1_S1_fastp.html 
fastp v0.23.4, time used: 1 seconds

[2024-10-05 17:58:10,471] WARNING database_accessor.py quality_control :
fastp for AP_TS1_S1 produced warnings: Read1 before filtering:
total reads: 248601
total bases: 19888080
Q20 bases: 19480257(97.9494%)
Q30 bases: 18588142(93.4637%)

Read2 before filtering:
total reads: 248601
total bases: 23617095
Q20 bases: 22812090(96.5914%)
Q30 bases: 21475937(90.9339%)

Read1 after filtering:
total reads: 231712
total bases: 17580299
Q20 bases: 17414800(99.0586%)
Q30 bases: 16830589(95.7355%)

Read2 after filtering:
total reads: 231712
total bases: 16739640
Q20 bases: 16514648(98.6559%)
Q30 bases: 15824490(94.533%)

Filtering result:
reads passed filter: 463424
reads failed due to low quality: 12162
reads failed due to too many N: 0
reads failed due to too short: 21616
reads with adapter trimmed: 99544
bases trimmed due to adapters: 1530502

Duplication rate: 64.4881%

Insert size peak (evaluated by paired-end reads): 71

JSON report: /home/data/acropora_db/quality_control/AP_TS1_S1_fastp.json
HTML report: /home/data/acropora_db/quality_control/AP_TS1_S1_fastp.html

fastp -i /home/data/acropora/AP_TS1_S1_L001_R1_001.fastq.gz -I /home/data/acropora/AP_TS1_S1_L001_R2_001.fastq.gz -o /home/data/acropora_db/quality_control/AP_TS1_S1_qc_R1.fastq.gz -O /home/data/acropora_db/quality_control/AP_TS1_S1_qc_R2.fastq.gz -q 30 -f 0 -F 15 --cut_right --thread 8 --json /home/data/acropora_db/quality_control/AP_TS1_S1_fastp.json --html /home/data/acropora_db/quality_control/AP_TS1_S1_fastp.html 
fastp v0.23.4, time used: 1 seconds

[2024-10-05 17:58:10,471] INFO database_accessor.py quality_control :
Finished processing sample: AP_TS1_S1
[2024-10-05 17:58:10,471] INFO database_accessor.py quality_control :
Processing sample: AM_A-1_S33
[2024-10-05 17:58:10,471] INFO database_accessor.py execute_cmd :
[cmd] fastp -i /home/data/acropora/AM_A-1_S33_L001_R1_001.fastq.gz -I /home/data/acropora/AM_A-1_S33_L001_R2_001.fastq.gz -o /home/data/acropora_db/quality_control/AM_A-1_S33_qc_R1.fastq.gz -O /home/data/acropora_db/quality_control/AM_A-1_S33_qc_R2.fastq.gz -q 30 -f 0 -F 15 --cut_right --thread 8 --json /home/data/acropora_db/quality_control/AM_A-1_S33_fastp.json --html /home/data/acropora_db/quality_control/AM_A-1_S33_fastp.html
[2024-10-05 17:58:10,886] INFO database_accessor.py execute_cmd :
Read1 before filtering:
total reads: 97107
total bases: 7768560
Q20 bases: 7647822(98.4458%)
Q30 bases: 7362598(94.7743%)

Read2 before filtering:
total reads: 97107
total bases: 9128058
Q20 bases: 8907264(97.5812%)
Q30 bases: 8496983(93.0864%)

Read1 after filtering:
total reads: 93866
total bases: 7066298
Q20 bases: 7008421(99.1809%)
Q30 bases: 6804930(96.3012%)

Read2 after filtering:
total reads: 93866
total bases: 6587867
Q20 bases: 6517391(98.9302%)
Q30 bases: 6285324(95.4076%)

Filtering result:
reads passed filter: 187732
reads failed due to low quality: 2370
reads failed due to too many N: 0
reads failed due to too short: 4112
reads with adapter trimmed: 50244
bases trimmed due to adapters: 883198

Duplication rate: 53.0343%

Insert size peak (evaluated by paired-end reads): 57

JSON report: /home/data/acropora_db/quality_control/AM_A-1_S33_fastp.json
HTML report: /home/data/acropora_db/quality_control/AM_A-1_S33_fastp.html

fastp -i /home/data/acropora/AM_A-1_S33_L001_R1_001.fastq.gz -I /home/data/acropora/AM_A-1_S33_L001_R2_001.fastq.gz -o /home/data/acropora_db/quality_control/AM_A-1_S33_qc_R1.fastq.gz -O /home/data/acropora_db/quality_control/AM_A-1_S33_qc_R2.fastq.gz -q 30 -f 0 -F 15 --cut_right --thread 8 --json /home/data/acropora_db/quality_control/AM_A-1_S33_fastp.json --html /home/data/acropora_db/quality_control/AM_A-1_S33_fastp.html 
fastp v0.23.4, time used: 0 seconds

[2024-10-05 17:58:10,886] WARNING database_accessor.py quality_control :
fastp for AM_A-1_S33 produced warnings: Read1 before filtering:
total reads: 97107
total bases: 7768560
Q20 bases: 7647822(98.4458%)
Q30 bases: 7362598(94.7743%)

Read2 before filtering:
total reads: 97107
total bases: 9128058
Q20 bases: 8907264(97.5812%)
Q30 bases: 8496983(93.0864%)

Read1 after filtering:
total reads: 93866
total bases: 7066298
Q20 bases: 7008421(99.1809%)
Q30 bases: 6804930(96.3012%)

Read2 after filtering:
total reads: 93866
total bases: 6587867
Q20 bases: 6517391(98.9302%)
Q30 bases: 6285324(95.4076%)

Filtering result:
reads passed filter: 187732
reads failed due to low quality: 2370
reads failed due to too many N: 0
reads failed due to too short: 4112
reads with adapter trimmed: 50244
bases trimmed due to adapters: 883198

Duplication rate: 53.0343%

Insert size peak (evaluated by paired-end reads): 57

JSON report: /home/data/acropora_db/quality_control/AM_A-1_S33_fastp.json
HTML report: /home/data/acropora_db/quality_control/AM_A-1_S33_fastp.html

fastp -i /home/data/acropora/AM_A-1_S33_L001_R1_001.fastq.gz -I /home/data/acropora/AM_A-1_S33_L001_R2_001.fastq.gz -o /home/data/acropora_db/quality_control/AM_A-1_S33_qc_R1.fastq.gz -O /home/data/acropora_db/quality_control/AM_A-1_S33_qc_R2.fastq.gz -q 30 -f 0 -F 15 --cut_right --thread 8 --json /home/data/acropora_db/quality_control/AM_A-1_S33_fastp.json --html /home/data/acropora_db/quality_control/AM_A-1_S33_fastp.html 
fastp v0.23.4, time used: 0 seconds

[2024-10-05 17:58:10,886] INFO database_accessor.py quality_control :
Finished processing sample: AM_A-1_S33
[2024-10-05 17:58:10,886] INFO database_accessor.py quality_control :
Quality control completed for all samples
[2024-10-05 17:58:10,886] INFO database_accessor.py logging_title :

####################
#### 接头修剪：fastq ####
####################
[2024-10-05 17:58:10,886] INFO database_accessor.py execute_cmd :
[cmd] fastp -i /home/data/acropora_db/quality_control/AG_GAs11-67_S67_qc_R1.fastq.gz -I /home/data/acropora_db/quality_control/AG_GAs11-67_S67_qc_R2.fastq.gz -o /home/data/acropora_db/adapter_trim/AG_GAs11-67_S67_at_R1.fastq.gz -O /home/data/acropora_db/adapter_trim/AG_GAs11-67_S67_at_R2.fastq.gz --adapter_sequence GTCAGATCGGAAGAGCACACGTCTGAACTCCAGTCAC --adapter_sequence_r2 CAGAGATCGGAAGAGCGTCGTGTAGGGAAAGAC --cut_right --cut_window_size 4 --cut_mean_quality 20 --length_required 36 --length_limit 150 --average_qual 19 --thread 8 --json /home/data/acropora_db/adapter_trim/AG_GAs11-67_S67_fastp.json --html /home/data/acropora_db/adapter_trim/AG_GAs11-67_S67_fastp.html
[2024-10-05 17:58:11,281] INFO database_accessor.py execute_cmd :
Read1 before filtering:
total reads: 79298
total bases: 5996604
Q20 bases: 5914403(98.6292%)
Q30 bases: 5679288(94.7084%)

Read2 before filtering:
total reads: 79298
total bases: 5490991
Q20 bases: 5383923(98.0501%)
Q30 bases: 5084929(92.6049%)

Read1 after filtering:
total reads: 51622
total bases: 3958367
Q20 bases: 3921935(99.0796%)
Q30 bases: 3800062(96.0007%)

Read2 after filtering:
total reads: 51622
total bases: 3772927
Q20 bases: 3718987(98.5703%)
Q30 bases: 3556932(94.2751%)

Filtering result:
reads passed filter: 103244
reads failed due to low quality: 0
reads failed due to too many N: 0
reads failed due to too short: 55352
reads failed due to too long: 0
reads with adapter trimmed: 51133
bases trimmed due to adapters: 2655651

Duplication rate: 46.0642%

Insert size peak (evaluated by paired-end reads): 49

JSON report: /home/data/acropora_db/adapter_trim/AG_GAs11-67_S67_fastp.json
HTML report: /home/data/acropora_db/adapter_trim/AG_GAs11-67_S67_fastp.html

fastp -i /home/data/acropora_db/quality_control/AG_GAs11-67_S67_qc_R1.fastq.gz -I /home/data/acropora_db/quality_control/AG_GAs11-67_S67_qc_R2.fastq.gz -o /home/data/acropora_db/adapter_trim/AG_GAs11-67_S67_at_R1.fastq.gz -O /home/data/acropora_db/adapter_trim/AG_GAs11-67_S67_at_R2.fastq.gz --adapter_sequence GTCAGATCGGAAGAGCACACGTCTGAACTCCAGTCAC --adapter_sequence_r2 CAGAGATCGGAAGAGCGTCGTGTAGGGAAAGAC --cut_right --cut_window_size 4 --cut_mean_quality 20 --length_required 36 --length_limit 150 --average_qual 19 --thread 8 --json /home/data/acropora_db/adapter_trim/AG_GAs11-67_S67_fastp.json --html /home/data/acropora_db/adapter_trim/AG_GAs11-67_S67_fastp.html 
fastp v0.23.4, time used: 1 seconds

[2024-10-05 17:58:11,281] INFO database_accessor.py execute_cmd :
[cmd] fastp -i /home/data/acropora_db/quality_control/AS_ASTUS31_S161_qc_R1.fastq.gz -I /home/data/acropora_db/quality_control/AS_ASTUS31_S161_qc_R2.fastq.gz -o /home/data/acropora_db/adapter_trim/AS_ASTUS31_S161_at_R1.fastq.gz -O /home/data/acropora_db/adapter_trim/AS_ASTUS31_S161_at_R2.fastq.gz --adapter_sequence GTCAGATCGGAAGAGCACACGTCTGAACTCCAGTCAC --adapter_sequence_r2 CAGAGATCGGAAGAGCGTCGTGTAGGGAAAGAC --cut_right --cut_window_size 4 --cut_mean_quality 20 --length_required 36 --length_limit 150 --average_qual 19 --thread 8 --json /home/data/acropora_db/adapter_trim/AS_ASTUS31_S161_fastp.json --html /home/data/acropora_db/adapter_trim/AS_ASTUS31_S161_fastp.html
[2024-10-05 17:58:11,752] INFO database_accessor.py execute_cmd :
Read1 before filtering:
total reads: 158521
total bases: 12084495
Q20 bases: 11964325(99.0056%)
Q30 bases: 11633921(96.2715%)

Read2 before filtering:
total reads: 158521
total bases: 11411898
Q20 bases: 11287906(98.9135%)
Q30 bases: 10913654(95.634%)

Read1 after filtering:
total reads: 79051
total bases: 5841951
Q20 bases: 5798389(99.2543%)
Q30 bases: 5670180(97.0597%)

Read2 after filtering:
total reads: 79051
total bases: 5438862
Q20 bases: 5399343(99.2734%)
Q30 bases: 5262418(96.7559%)

Filtering result:
reads passed filter: 158102
reads failed due to low quality: 0
reads failed due to too many N: 0
reads failed due to too short: 158940
reads failed due to too long: 0
reads with adapter trimmed: 154518
bases trimmed due to adapters: 8207681

Duplication rate: 58.0768%

Insert size peak (evaluated by paired-end reads): 80

JSON report: /home/data/acropora_db/adapter_trim/AS_ASTUS31_S161_fastp.json
HTML report: /home/data/acropora_db/adapter_trim/AS_ASTUS31_S161_fastp.html

fastp -i /home/data/acropora_db/quality_control/AS_ASTUS31_S161_qc_R1.fastq.gz -I /home/data/acropora_db/quality_control/AS_ASTUS31_S161_qc_R2.fastq.gz -o /home/data/acropora_db/adapter_trim/AS_ASTUS31_S161_at_R1.fastq.gz -O /home/data/acropora_db/adapter_trim/AS_ASTUS31_S161_at_R2.fastq.gz --adapter_sequence GTCAGATCGGAAGAGCACACGTCTGAACTCCAGTCAC --adapter_sequence_r2 CAGAGATCGGAAGAGCGTCGTGTAGGGAAAGAC --cut_right --cut_window_size 4 --cut_mean_quality 20 --length_required 36 --length_limit 150 --average_qual 19 --thread 8 --json /home/data/acropora_db/adapter_trim/AS_ASTUS31_S161_fastp.json --html /home/data/acropora_db/adapter_trim/AS_ASTUS31_S161_fastp.html 
fastp v0.23.4, time used: 0 seconds

[2024-10-05 17:58:11,753] INFO database_accessor.py execute_cmd :
[cmd] fastp -i /home/data/acropora_db/quality_control/AP_TS1_S1_qc_R1.fastq.gz -I /home/data/acropora_db/quality_control/AP_TS1_S1_qc_R2.fastq.gz -o /home/data/acropora_db/adapter_trim/AP_TS1_S1_at_R1.fastq.gz -O /home/data/acropora_db/adapter_trim/AP_TS1_S1_at_R2.fastq.gz --adapter_sequence GTCAGATCGGAAGAGCACACGTCTGAACTCCAGTCAC --adapter_sequence_r2 CAGAGATCGGAAGAGCGTCGTGTAGGGAAAGAC --cut_right --cut_window_size 4 --cut_mean_quality 20 --length_required 36 --length_limit 150 --average_qual 19 --thread 8 --json /home/data/acropora_db/adapter_trim/AP_TS1_S1_fastp.json --html /home/data/acropora_db/adapter_trim/AP_TS1_S1_fastp.html
[2024-10-05 17:58:12,333] INFO database_accessor.py execute_cmd :
Read1 before filtering:
total reads: 231712
total bases: 17580299
Q20 bases: 17414800(99.0586%)
Q30 bases: 16830589(95.7355%)

Read2 before filtering:
total reads: 231712
total bases: 16739640
Q20 bases: 16514648(98.6559%)
Q30 bases: 15824490(94.533%)

Read1 after filtering:
total reads: 119529
total bases: 8749001
Q20 bases: 8688635(99.31%)
Q30 bases: 8447878(96.5582%)

Read2 after filtering:
total reads: 119529
total bases: 8129678
Q20 bases: 8057783(99.1156%)
Q30 bases: 7796800(95.9054%)

Filtering result:
reads passed filter: 239058
reads failed due to low quality: 20
reads failed due to too many N: 0
reads failed due to too short: 224346
reads failed due to too long: 0
reads with adapter trimmed: 223016
bases trimmed due to adapters: 11817632

Duplication rate: 68.6382%

Insert size peak (evaluated by paired-end reads): 56

JSON report: /home/data/acropora_db/adapter_trim/AP_TS1_S1_fastp.json
HTML report: /home/data/acropora_db/adapter_trim/AP_TS1_S1_fastp.html

fastp -i /home/data/acropora_db/quality_control/AP_TS1_S1_qc_R1.fastq.gz -I /home/data/acropora_db/quality_control/AP_TS1_S1_qc_R2.fastq.gz -o /home/data/acropora_db/adapter_trim/AP_TS1_S1_at_R1.fastq.gz -O /home/data/acropora_db/adapter_trim/AP_TS1_S1_at_R2.fastq.gz --adapter_sequence GTCAGATCGGAAGAGCACACGTCTGAACTCCAGTCAC --adapter_sequence_r2 CAGAGATCGGAAGAGCGTCGTGTAGGGAAAGAC --cut_right --cut_window_size 4 --cut_mean_quality 20 --length_required 36 --length_limit 150 --average_qual 19 --thread 8 --json /home/data/acropora_db/adapter_trim/AP_TS1_S1_fastp.json --html /home/data/acropora_db/adapter_trim/AP_TS1_S1_fastp.html 
fastp v0.23.4, time used: 1 seconds

[2024-10-05 17:58:12,333] INFO database_accessor.py execute_cmd :
[cmd] fastp -i /home/data/acropora_db/quality_control/AM_A-1_S33_qc_R1.fastq.gz -I /home/data/acropora_db/quality_control/AM_A-1_S33_qc_R2.fastq.gz -o /home/data/acropora_db/adapter_trim/AM_A-1_S33_at_R1.fastq.gz -O /home/data/acropora_db/adapter_trim/AM_A-1_S33_at_R2.fastq.gz --adapter_sequence GTCAGATCGGAAGAGCACACGTCTGAACTCCAGTCAC --adapter_sequence_r2 CAGAGATCGGAAGAGCGTCGTGTAGGGAAAGAC --cut_right --cut_window_size 4 --cut_mean_quality 20 --length_required 36 --length_limit 150 --average_qual 19 --thread 8 --json /home/data/acropora_db/adapter_trim/AM_A-1_S33_fastp.json --html /home/data/acropora_db/adapter_trim/AM_A-1_S33_fastp.html
[2024-10-05 17:58:12,746] INFO database_accessor.py execute_cmd :
Read1 before filtering:
total reads: 93866
total bases: 7066298
Q20 bases: 7008421(99.1809%)
Q30 bases: 6804930(96.3012%)

Read2 before filtering:
total reads: 93866
total bases: 6587867
Q20 bases: 6517391(98.9302%)
Q30 bases: 6285324(95.4076%)

Read1 after filtering:
total reads: 70057
total bases: 5238507
Q20 bases: 5207195(99.4023%)
Q30 bases: 5082504(97.022%)

Read2 after filtering:
total reads: 70057
total bases: 4876236
Q20 bases: 4840109(99.2591%)
Q30 bases: 4707250(96.5345%)

Filtering result:
reads passed filter: 140114
reads failed due to low quality: 2
reads failed due to too many N: 0
reads failed due to too short: 47616
reads failed due to too long: 0
reads with adapter trimmed: 44894
bases trimmed due to adapters: 2404472

Duplication rate: 56.4027%

Insert size peak (evaluated by paired-end reads): 42

JSON report: /home/data/acropora_db/adapter_trim/AM_A-1_S33_fastp.json
HTML report: /home/data/acropora_db/adapter_trim/AM_A-1_S33_fastp.html

fastp -i /home/data/acropora_db/quality_control/AM_A-1_S33_qc_R1.fastq.gz -I /home/data/acropora_db/quality_control/AM_A-1_S33_qc_R2.fastq.gz -o /home/data/acropora_db/adapter_trim/AM_A-1_S33_at_R1.fastq.gz -O /home/data/acropora_db/adapter_trim/AM_A-1_S33_at_R2.fastq.gz --adapter_sequence GTCAGATCGGAAGAGCACACGTCTGAACTCCAGTCAC --adapter_sequence_r2 CAGAGATCGGAAGAGCGTCGTGTAGGGAAAGAC --cut_right --cut_window_size 4 --cut_mean_quality 20 --length_required 36 --length_limit 150 --average_qual 19 --thread 8 --json /home/data/acropora_db/adapter_trim/AM_A-1_S33_fastp.json --html /home/data/acropora_db/adapter_trim/AM_A-1_S33_fastp.html 
fastp v0.23.4, time used: 0 seconds

[2024-10-05 17:58:12,746] INFO database_accessor.py adapter_trim :
所有样本的接头修剪已完成
[2024-10-05 17:58:12,746] INFO database_accessor.py logging_title :

#########################
#### fastq 转换为 fasta ####
#########################
[2024-10-05 17:58:12,747] INFO database_accessor.py execute_cmd :
[cmd] seqkit fq2fa -o /home/data/acropora_db/fasta/AG_GAs11-67_S67.fasta.gz /home/data/acropora_db/adapter_trim/AG_GAs11-67_S67_at_R1.fastq.gz /home/data/acropora_db/adapter_trim/AG_GAs11-67_S67_at_R2.fastq.gz
[2024-10-05 17:58:12,858] INFO database_accessor.py execute_cmd :
[cmd] seqkit fq2fa -o /home/data/acropora_db/fasta/AS_ASTUS31_S161.fasta.gz /home/data/acropora_db/adapter_trim/AS_ASTUS31_S161_at_R1.fastq.gz /home/data/acropora_db/adapter_trim/AS_ASTUS31_S161_at_R2.fastq.gz
[2024-10-05 17:58:13,210] INFO database_accessor.py execute_cmd :
[cmd] seqkit fq2fa -o /home/data/acropora_db/fasta/AP_TS1_S1.fasta.gz /home/data/acropora_db/adapter_trim/AP_TS1_S1_at_R1.fastq.gz /home/data/acropora_db/adapter_trim/AP_TS1_S1_at_R2.fastq.gz
[2024-10-05 17:58:13,603] INFO database_accessor.py execute_cmd :
[cmd] seqkit fq2fa -o /home/data/acropora_db/fasta/AM_A-1_S33.fasta.gz /home/data/acropora_db/adapter_trim/AM_A-1_S33_at_R1.fastq.gz /home/data/acropora_db/adapter_trim/AM_A-1_S33_at_R2.fastq.gz
[2024-10-05 17:58:13,754] INFO database_accessor.py fastq_to_fasta :
所有样本的 FASTQ 到 FASTA 转换已完成
[2024-10-05 17:58:13,754] INFO database_accessor.py execute_cmd :
[cmd] seqkit seq -m 80 -M 80 /home/data/acropora_db/fasta/AG_GAs11-67_S67.fasta.gz | gzip > /home/data/acropora_db/fasta/AG_GAs11-67_S67_uniform.fasta.gz
[2024-10-05 17:58:14,143] INFO database_accessor.py execute_cmd :
[33m[WARN][0m you may switch on flag -g/--remove-gaps to remove spaces

[2024-10-05 17:58:14,144] INFO database_accessor.py execute_cmd :
[cmd] seqkit seq -m 80 -M 80 /home/data/acropora_db/fasta/AS_ASTUS31_S161.fasta.gz | gzip > /home/data/acropora_db/fasta/AS_ASTUS31_S161_uniform.fasta.gz
[2024-10-05 17:58:14,650] INFO database_accessor.py execute_cmd :
[33m[WARN][0m you may switch on flag -g/--remove-gaps to remove spaces

[2024-10-05 17:58:14,650] INFO database_accessor.py execute_cmd :
[cmd] seqkit seq -m 80 -M 80 /home/data/acropora_db/fasta/AP_TS1_S1.fasta.gz | gzip > /home/data/acropora_db/fasta/AP_TS1_S1_uniform.fasta.gz
[2024-10-05 17:58:15,560] INFO database_accessor.py execute_cmd :
[33m[WARN][0m you may switch on flag -g/--remove-gaps to remove spaces

[2024-10-05 17:58:15,560] INFO database_accessor.py execute_cmd :
[cmd] seqkit seq -m 80 -M 80 /home/data/acropora_db/fasta/AM_A-1_S33.fasta.gz | gzip > /home/data/acropora_db/fasta/AM_A-1_S33_uniform.fasta.gz
[2024-10-05 17:58:16,044] INFO database_accessor.py execute_cmd :
[33m[WARN][0m you may switch on flag -g/--remove-gaps to remove spaces

[2024-10-05 17:58:16,044] INFO database_accessor.py logging_title :

#################
#### ustacks ####
#################
[2024-10-05 17:58:16,044] INFO database_accessor.py stacks :
Running ustacks for sample: AG_GAs11-67_S67
[2024-10-05 17:58:16,044] INFO database_accessor.py stacks :
Command: ustacks -f /home/data/acropora_db/fasta/AG_GAs11-67_S67_uniform.fasta.gz -o /home/data/acropora_db/ustacks --name AG_GAs11-67_S67 -i 1 -m 3 -M 2 -p 8
[2024-10-05 17:58:16,045] INFO database_accessor.py execute_cmd :
[cmd] ustacks -f /home/data/acropora_db/fasta/AG_GAs11-67_S67_uniform.fasta.gz -o /home/data/acropora_db/ustacks --name AG_GAs11-67_S67 -i 1 -m 3 -M 2 -p 8
[2024-10-05 17:58:16,508] INFO database_accessor.py execute_cmd :
ustacks parameters selected:
  Input file: '/home/data/acropora_db/fasta/AG_GAs11-67_S67_uniform.fasta.gz'
  Sample ID: 1
  Min depth of coverage to create a stack (m): 3
  Repeat removal algorithm: enabled
  Max distance allowed between stacks (M): 2
  Max distance allowed to align secondary reads: 4
  Max number of stacks allowed per de novo locus: 3
  Deleveraging algorithm: disabled
  Gapped assembly: enabled
  Minimum alignment length: 0.8
  Model type: SNP
  Alpha significance level for model: 0.05

Loading RAD-Tags...
Warning: Input reads contained 1 uncalled nucleotides.

Loaded 42595 reads; formed:
  1734 stacks representing 29473 primary reads (69.2%)
  11868 secondary stacks representing 13122 secondary reads (30.8%)

Stack coverage: mean=17.00; stdev=60.60; max=1955; n_reads=29473(69.2%)
Removing repetitive stacks: cov > 199 (mean+3*stdev)...
  Blacklisted 121 stacks.
Coverage after repeat removal: mean=13.16; stdev=21.91; max=190; n_reads=21222(49.8%)

Assembling stacks (max. dist. M=2)...
  Assembled 1613 stacks into 1408; blacklisted 17 stacks.
Coverage after assembling stacks: mean=13.95; stdev=22.82; max=194; n_reads=19161(45.0%)

Merging secondary stacks (max. dist. N=4 from consensus)...
  Merged 4822 out of 13122 secondary reads (36.7%), 638 merged with gapped alignments.
Coverage after merging secondary stacks: mean=17.45; stdev=27.76; max=227; n_reads=23983(56.3%)

Assembling stacks, allowing for gaps (min. match length 80.0%)...
  Assembled 1408 stacks into 1304 stacks.
Coverage after gapped assembly: mean=18.88; stdev=29.87; max=227; n_reads=23983(56.3%)

Merging secondary stacks, allowing for gaps (min. match length 80.0%)...
  Merged 1510 out of 8300 secondary reads (18.2%).
Coverage after merging gapped secondary stacks: mean=20.07; stdev=30.84; max=228; n_reads=25493(59.8%)

Final number of stacks built: 1304
Final coverage: mean=20.07; stdev=30.84; max=228; n_reads=25493(59.8%)
Calling consensus sequences and haplotypes for catalog assembly...
Writing tags, SNPs, and alleles files to '/home/data/acropora_db/ustacks/AG_GAs11-67_S67'...done.
ustacks is done.

[2024-10-05 17:58:16,509] INFO database_accessor.py stacks :
ustacks successfully processed sample: AG_GAs11-67_S67
[2024-10-05 17:58:16,509] INFO database_accessor.py stacks :
Running ustacks for sample: AS_ASTUS31_S161
[2024-10-05 17:58:16,509] INFO database_accessor.py stacks :
Command: ustacks -f /home/data/acropora_db/fasta/AS_ASTUS31_S161_uniform.fasta.gz -o /home/data/acropora_db/ustacks --name AS_ASTUS31_S161 -i 2 -m 3 -M 2 -p 8
[2024-10-05 17:58:16,509] INFO database_accessor.py execute_cmd :
[cmd] ustacks -f /home/data/acropora_db/fasta/AS_ASTUS31_S161_uniform.fasta.gz -o /home/data/acropora_db/ustacks --name AS_ASTUS31_S161 -i 2 -m 3 -M 2 -p 8
[2024-10-05 17:58:17,141] INFO database_accessor.py execute_cmd :
ustacks parameters selected:
  Input file: '/home/data/acropora_db/fasta/AS_ASTUS31_S161_uniform.fasta.gz'
  Sample ID: 2
  Min depth of coverage to create a stack (m): 3
  Repeat removal algorithm: enabled
  Max distance allowed between stacks (M): 2
  Max distance allowed to align secondary reads: 4
  Max number of stacks allowed per de novo locus: 3
  Deleveraging algorithm: disabled
  Gapped assembly: enabled
  Minimum alignment length: 0.8
  Model type: SNP
  Alpha significance level for model: 0.05

Loading RAD-Tags...
Warning: Input reads contained 28 uncalled nucleotides.

Loaded 53942 reads; formed:
  2358 stacks representing 34094 primary reads (63.2%)
  18039 secondary stacks representing 19848 secondary reads (36.8%)

Stack coverage: mean=14.46; stdev=53.71; max=1311; n_reads=34094(63.2%)
Removing repetitive stacks: cov > 176 (mean+3*stdev)...
  Blacklisted 206 stacks.
Coverage after repeat removal: mean=10.86; stdev=17.90; max=174; n_reads=23378(43.3%)

Assembling stacks (max. dist. M=2)...
  Assembled 2152 stacks into 1737; blacklisted 36 stacks.
Coverage after assembling stacks: mean=11.62; stdev=17.83; max=181; n_reads=19559(36.3%)

Merging secondary stacks (max. dist. N=4 from consensus)...
  Merged 7119 out of 19848 secondary reads (35.9%), 1155 merged with gapped alignments.
Coverage after merging secondary stacks: mean=15.85; stdev=23.02; max=217; n_reads=26678(49.5%)

Assembling stacks, allowing for gaps (min. match length 80.0%)...
  Assembled 1737 stacks into 1624 stacks.
Coverage after gapped assembly: mean=16.99; stdev=24.35; max=225; n_reads=26678(49.5%)

Merging secondary stacks, allowing for gaps (min. match length 80.0%)...
  Merged 2842 out of 12729 secondary reads (22.3%).
Coverage after merging gapped secondary stacks: mean=18.80; stdev=27.02; max=228; n_reads=29520(54.7%)

Final number of stacks built: 1624
Final coverage: mean=18.80; stdev=27.02; max=228; n_reads=29520(54.7%)
Calling consensus sequences and haplotypes for catalog assembly...
Writing tags, SNPs, and alleles files to '/home/data/acropora_db/ustacks/AS_ASTUS31_S161'...done.
ustacks is done.

[2024-10-05 17:58:17,142] INFO database_accessor.py stacks :
ustacks successfully processed sample: AS_ASTUS31_S161
[2024-10-05 17:58:17,142] INFO database_accessor.py stacks :
Running ustacks for sample: AP_TS1_S1
[2024-10-05 17:58:17,142] INFO database_accessor.py stacks :
Command: ustacks -f /home/data/acropora_db/fasta/AP_TS1_S1_uniform.fasta.gz -o /home/data/acropora_db/ustacks --name AP_TS1_S1 -i 3 -m 3 -M 2 -p 8
[2024-10-05 17:58:17,142] INFO database_accessor.py execute_cmd :
[cmd] ustacks -f /home/data/acropora_db/fasta/AP_TS1_S1_uniform.fasta.gz -o /home/data/acropora_db/ustacks --name AP_TS1_S1 -i 3 -m 3 -M 2 -p 8
[2024-10-05 17:58:18,286] INFO database_accessor.py execute_cmd :
ustacks parameters selected:
  Input file: '/home/data/acropora_db/fasta/AP_TS1_S1_uniform.fasta.gz'
  Sample ID: 3
  Min depth of coverage to create a stack (m): 3
  Repeat removal algorithm: enabled
  Max distance allowed between stacks (M): 2
  Max distance allowed to align secondary reads: 4
  Max number of stacks allowed per de novo locus: 3
  Deleveraging algorithm: disabled
  Gapped assembly: enabled
  Minimum alignment length: 0.8
  Model type: SNP
  Alpha significance level for model: 0.05

Loading RAD-Tags...

Loaded 132844 reads; formed:
  4103 stacks representing 106978 primary reads (80.5%)
  23273 secondary stacks representing 25866 secondary reads (19.5%)

Stack coverage: mean=26.07; stdev=162.96; max=3789; n_reads=106978(80.5%)
Removing repetitive stacks: cov > 515 (mean+3*stdev)...
  Blacklisted 810 stacks.
Coverage after repeat removal: mean=18.76; stdev=45.94; max=503; n_reads=61763(46.5%)

Assembling stacks (max. dist. M=2)...
  Assembled 3293 stacks into 2828; blacklisted 37 stacks.
Coverage after assembling stacks: mean=18.73; stdev=41.41; max=505; n_reads=51877(39.1%)

Merging secondary stacks (max. dist. N=4 from consensus)...
  Merged 10842 out of 25866 secondary reads (41.9%), 1929 merged with gapped alignments.
Coverage after merging secondary stacks: mean=22.64; stdev=48.36; max=558; n_reads=62719(47.2%)

Assembling stacks, allowing for gaps (min. match length 80.0%)...
  Assembled 2828 stacks into 2191 stacks.
Coverage after gapped assembly: mean=29.40; stdev=58.53; max=652; n_reads=62719(47.2%)

Merging secondary stacks, allowing for gaps (min. match length 80.0%)...
  Merged 5525 out of 15024 secondary reads (36.8%).
Coverage after merging gapped secondary stacks: mean=31.99; stdev=60.63; max=659; n_reads=68244(51.4%)

Final number of stacks built: 2191
Final coverage: mean=31.99; stdev=60.63; max=659; n_reads=68244(51.4%)
Calling consensus sequences and haplotypes for catalog assembly...
Writing tags, SNPs, and alleles files to '/home/data/acropora_db/ustacks/AP_TS1_S1'...done.
ustacks is done.

[2024-10-05 17:58:18,286] INFO database_accessor.py stacks :
ustacks successfully processed sample: AP_TS1_S1
[2024-10-05 17:58:18,286] INFO database_accessor.py stacks :
Running ustacks for sample: AM_A-1_S33
[2024-10-05 17:58:18,286] INFO database_accessor.py stacks :
Command: ustacks -f /home/data/acropora_db/fasta/AM_A-1_S33_uniform.fasta.gz -o /home/data/acropora_db/ustacks --name AM_A-1_S33 -i 4 -m 3 -M 2 -p 8
[2024-10-05 17:58:18,286] INFO database_accessor.py execute_cmd :
[cmd] ustacks -f /home/data/acropora_db/fasta/AM_A-1_S33_uniform.fasta.gz -o /home/data/acropora_db/ustacks --name AM_A-1_S33 -i 4 -m 3 -M 2 -p 8
[2024-10-05 17:58:18,842] INFO database_accessor.py execute_cmd :
ustacks parameters selected:
  Input file: '/home/data/acropora_db/fasta/AM_A-1_S33_uniform.fasta.gz'
  Sample ID: 4
  Min depth of coverage to create a stack (m): 3
  Repeat removal algorithm: enabled
  Max distance allowed between stacks (M): 2
  Max distance allowed to align secondary reads: 4
  Max number of stacks allowed per de novo locus: 3
  Deleveraging algorithm: disabled
  Gapped assembly: enabled
  Minimum alignment length: 0.8
  Model type: SNP
  Alpha significance level for model: 0.05

Loading RAD-Tags...

Loaded 50057 reads; formed:
  2023 stacks representing 35081 primary reads (70.1%)
  13554 secondary stacks representing 14976 secondary reads (29.9%)

Stack coverage: mean=17.34; stdev=44.82; max=818; n_reads=35081(70.1%)
Removing repetitive stacks: cov > 152 (mean+3*stdev)...
  Blacklisted 98 stacks.
Coverage after repeat removal: mean=13.00; stdev=19.48; max=149; n_reads=25028(50.0%)

Assembling stacks (max. dist. M=2)...
  Assembled 1925 stacks into 1721; blacklisted 16 stacks.
Coverage after assembling stacks: mean=13.89; stdev=22.36; max=262; n_reads=23288(46.5%)

Merging secondary stacks (max. dist. N=4 from consensus)...
  Merged 5032 out of 14976 secondary reads (33.6%), 440 merged with gapped alignments.
Coverage after merging secondary stacks: mean=16.89; stdev=26.65; max=305; n_reads=28320(56.6%)

Assembling stacks, allowing for gaps (min. match length 80.0%)...
  Assembled 1721 stacks into 1565 stacks.
Coverage after gapped assembly: mean=18.62; stdev=28.92; max=305; n_reads=28320(56.6%)

Merging secondary stacks, allowing for gaps (min. match length 80.0%)...
  Merged 2579 out of 9944 secondary reads (25.9%).
Coverage after merging gapped secondary stacks: mean=20.31; stdev=30.59; max=306; n_reads=30899(61.7%)

Final number of stacks built: 1565
Final coverage: mean=20.31; stdev=30.59; max=306; n_reads=30899(61.7%)
Calling consensus sequences and haplotypes for catalog assembly...
Writing tags, SNPs, and alleles files to '/home/data/acropora_db/ustacks/AM_A-1_S33'...done.
ustacks is done.

[2024-10-05 17:58:18,842] INFO database_accessor.py stacks :
ustacks successfully processed sample: AM_A-1_S33
[2024-10-05 17:58:18,842] INFO database_accessor.py run :
stacks 处理完成
[2024-10-05 17:58:18,842] INFO database_accessor.py run :
当前 files_to_process: {'AG_GAs11-67_S67': '/home/data/acropora_db/ustacks/AG_GAs11-67_S67.tags.tsv.gz', 'AS_ASTUS31_S161': '/home/data/acropora_db/ustacks/AS_ASTUS31_S161.tags.tsv.gz', 'AP_TS1_S1': '/home/data/acropora_db/ustacks/AP_TS1_S1.tags.tsv.gz', 'AM_A-1_S33': '/home/data/acropora_db/ustacks/AM_A-1_S33.tags.tsv.gz'}
[2024-10-05 17:58:18,842] INFO database_accessor.py logging_title :

#################################
#### extract consensus fasta ####
#################################
[2024-10-05 17:58:18,843] INFO database_accessor.py extract_consensus_fasta :
[cmd] zcat /home/data/acropora_db/ustacks/AG_GAs11-67_S67.tags.tsv.gz | awk '{if($3=="consensus") {printf ">AG_GAs11-67_S67_%d\n%s\n", NR, $4}}' > /home/data/acropora_db/consensus_fasta/AG_GAs11-67_S67.fa
[2024-10-05 17:58:18,843] INFO database_accessor.py execute_cmd :
[cmd] zcat /home/data/acropora_db/ustacks/AG_GAs11-67_S67.tags.tsv.gz | awk '{if($3=="consensus") {printf ">AG_GAs11-67_S67_%d\n%s\n", NR, $4}}' > /home/data/acropora_db/consensus_fasta/AG_GAs11-67_S67.fa
[2024-10-05 17:58:18,864] INFO database_accessor.py extract_consensus_fasta :
成功生成共识序列文件: /home/data/acropora_db/consensus_fasta/AG_GAs11-67_S67.fa
[2024-10-05 17:58:18,864] INFO database_accessor.py extract_consensus_fasta :
检查生成的 FASTA 文件: /home/data/acropora_db/consensus_fasta/AG_GAs11-67_S67.fa
[2024-10-05 17:58:18,864] INFO database_accessor.py execute_cmd :
[cmd] head -n 10 /home/data/acropora_db/consensus_fasta/AG_GAs11-67_S67.fa
[2024-10-05 17:58:18,865] INFO database_accessor.py execute_cmd :
>AG_GAs11-67_S67_2
TTCTGGTCCTCCTCCTTCTCCTTCTCGTTCTTGTTCTTGTTCGTGTTGTCGTTGCCGTTGTCGTTGTCCTTGTTGTCGTCATTGTCGTCATT
>AG_GAs11-67_S67_28
GACAATGATCAGTTTTTTTTTTTCACTGCAAAGAAAGTAAAAATGTAAATAATGACCTAGTTATGAGAAGCAAAGAAATGCAAAA
>AG_GAs11-67_S67_51
ATGTCATGTGCTCATAACTTCTCAGGGAAATGCCTCATGGTTTTAATCCTAACCAAGAAACTACAAATTCAACTCTAATAT
>AG_GAs11-67_S67_186
CCTCTTCGTCCTTTTCTTCCTTGTCTTCTTCGTCATCTCCTTCTTCCTCATCCTCTTCGTCCTTCTAGGGAAATCATGGCGA
>AG_GAs11-67_S67_310
GGGTGTCATATGACTCAAAGGGTAAGCTTTTTATCAATAACATTTCCGCACAAAATTTACTGTCAAACAAGTGAGGATATTT

[2024-10-05 17:58:18,865] INFO database_accessor.py extract_consensus_fasta :
[cmd] zcat /home/data/acropora_db/ustacks/AS_ASTUS31_S161.tags.tsv.gz | awk '{if($3=="consensus") {printf ">AS_ASTUS31_S161_%d\n%s\n", NR, $4}}' > /home/data/acropora_db/consensus_fasta/AS_ASTUS31_S161.fa
[2024-10-05 17:58:18,865] INFO database_accessor.py execute_cmd :
[cmd] zcat /home/data/acropora_db/ustacks/AS_ASTUS31_S161.tags.tsv.gz | awk '{if($3=="consensus") {printf ">AS_ASTUS31_S161_%d\n%s\n", NR, $4}}' > /home/data/acropora_db/consensus_fasta/AS_ASTUS31_S161.fa
[2024-10-05 17:58:18,890] INFO database_accessor.py extract_consensus_fasta :
成功生成共识序列文件: /home/data/acropora_db/consensus_fasta/AS_ASTUS31_S161.fa
[2024-10-05 17:58:18,890] INFO database_accessor.py extract_consensus_fasta :
检查生成的 FASTA 文件: /home/data/acropora_db/consensus_fasta/AS_ASTUS31_S161.fa
[2024-10-05 17:58:18,890] INFO database_accessor.py execute_cmd :
[cmd] head -n 10 /home/data/acropora_db/consensus_fasta/AS_ASTUS31_S161.fa
[2024-10-05 17:58:18,891] INFO database_accessor.py execute_cmd :
>AS_ASTUS31_S161_2
CGCAAAGATAGTATTTGTATGGTTAACTTGCTGGAAATACCGCGAATGATAGTTTTTTTTCTTTTTAATTACATGACTGAAATTAA
>AS_ASTUS31_S161_41
CCTACCTGTGCTACTGTTAATGGCGAAGAATCCTAAACTATTCTCAGCAGTGATGGAGTAAGACAAAACCCCATCCTCGCA
>AS_ASTUS31_S161_56
CCCAGGATCCGTGCCCAATCCGTAGGCTTACACTAAGTACTGACCCGGGAGCTTGAAAGCACGTTATTCACGCATGATTCACT
>AS_ASTUS31_S161_106
GCTGCTGCTACTGCTACTGCCACTGCTCCTGCTCCTGCTACTGCTCCTGCTACTGCTGCTGCTACCACTACTACTACTGCTACTACT
>AS_ASTUS31_S161_203
ATGATGATTTTCATAAAAAATAATACGTGCTACGTTGTGTTACAGAGAACGCAATTCGTTTGGTTTTTAAGATTTAATAACTAC

[2024-10-05 17:58:18,891] INFO database_accessor.py extract_consensus_fasta :
[cmd] zcat /home/data/acropora_db/ustacks/AP_TS1_S1.tags.tsv.gz | awk '{if($3=="consensus") {printf ">AP_TS1_S1_%d\n%s\n", NR, $4}}' > /home/data/acropora_db/consensus_fasta/AP_TS1_S1.fa
[2024-10-05 17:58:18,891] INFO database_accessor.py execute_cmd :
[cmd] zcat /home/data/acropora_db/ustacks/AP_TS1_S1.tags.tsv.gz | awk '{if($3=="consensus") {printf ">AP_TS1_S1_%d\n%s\n", NR, $4}}' > /home/data/acropora_db/consensus_fasta/AP_TS1_S1.fa
[2024-10-05 17:58:18,959] INFO database_accessor.py extract_consensus_fasta :
成功生成共识序列文件: /home/data/acropora_db/consensus_fasta/AP_TS1_S1.fa
[2024-10-05 17:58:18,959] INFO database_accessor.py extract_consensus_fasta :
检查生成的 FASTA 文件: /home/data/acropora_db/consensus_fasta/AP_TS1_S1.fa
[2024-10-05 17:58:18,959] INFO database_accessor.py execute_cmd :
[cmd] head -n 10 /home/data/acropora_db/consensus_fasta/AP_TS1_S1.fa
[2024-10-05 17:58:18,960] INFO database_accessor.py execute_cmd :
>AP_TS1_S1_2
GACATGAACATTTGACGACACGATTTCAGTTTAGTGTTTTTTTTCCTCTTTGTCCAAAACGTTCATACCAATTTAATTCTA
>AP_TS1_S1_19
TCGCTTAAGCCGAAATAATTTAAAATAAATAATACCTGTAAGTGCTAAGTGGTCTACAGCAATTACCTACATAAAATGGTC
>AP_TS1_S1_30
CCTGTTTTTATTTTCATGACCTTTAAACAACCCGAGGGTTAGACAAACTAAAAAAAAAAGTAAAACGGAATAAGCTATTTAAAC
>AP_TS1_S1_48
CGCATCATTGTGTGGAGTTCTTGTTCTTCCGCTCTGTGCCCGGTCGCCGCCTCCTTCGCCTCCGCATCCGCCGTCTTGTCA
>AP_TS1_S1_142
CCTCTGTGGACCTTACGACCCTCAGTTCTGTGTCTTTCCTGAATGACATGTGTCGTGACAAGGCTGCTGACCCAACATACGA

[2024-10-05 17:58:18,960] INFO database_accessor.py extract_consensus_fasta :
[cmd] zcat /home/data/acropora_db/ustacks/AM_A-1_S33.tags.tsv.gz | awk '{if($3=="consensus") {printf ">AM_A-1_S33_%d\n%s\n", NR, $4}}' > /home/data/acropora_db/consensus_fasta/AM_A-1_S33.fa
[2024-10-05 17:58:18,960] INFO database_accessor.py execute_cmd :
[cmd] zcat /home/data/acropora_db/ustacks/AM_A-1_S33.tags.tsv.gz | awk '{if($3=="consensus") {printf ">AM_A-1_S33_%d\n%s\n", NR, $4}}' > /home/data/acropora_db/consensus_fasta/AM_A-1_S33.fa
[2024-10-05 17:58:18,985] INFO database_accessor.py extract_consensus_fasta :
成功生成共识序列文件: /home/data/acropora_db/consensus_fasta/AM_A-1_S33.fa
[2024-10-05 17:58:18,985] INFO database_accessor.py extract_consensus_fasta :
检查生成的 FASTA 文件: /home/data/acropora_db/consensus_fasta/AM_A-1_S33.fa
[2024-10-05 17:58:18,985] INFO database_accessor.py execute_cmd :
[cmd] head -n 10 /home/data/acropora_db/consensus_fasta/AM_A-1_S33.fa
[2024-10-05 17:58:18,986] INFO database_accessor.py execute_cmd :
>AM_A-1_S33_2
TCCCAAATAATGTCACCGTAGTCAAAAAGAGGAAGTATTACAGAATGATAAAGTGTCAACCGAGCGTCTAGTGGTAGAAGGT
>AM_A-1_S33_36
CAGTTCAGATGAGAAAGAATGGTTGTTGTATGATGCTGGACCTCGTAGTGTGCGATGTCCCTTAATTTGCTTACCACCAGCCAGTG
>AM_A-1_S33_149
CCCTGATTCCCCTATTAACTCTACAAAATTTGCTGGAAAAATGCCATAGTTGCCATCAGGACCACGTCACCACCACCACGT
>AM_A-1_S33_171
AGTGTTACCATAATAGTTTTTTTTTTTTAATCTTGTGAGAGCGATGTTTCTAAAGCCTTTATGCAGAAATGATTTACTTAAA
>AM_A-1_S33_200
CCGTTGTGGTTGCTTGAGCTCCCTATTTCCTAAATTGTCCAGAGATGCACTAAATTTGAATTTACTAATGACGTCACACACCA

[2024-10-05 17:58:18,986] INFO database_accessor.py logging_title :

######################
#### make blastdb ####
######################
[2024-10-05 17:58:18,986] INFO database_accessor.py make_blastdb :
合并 FASTA 文件到: /home/data/acropora_db/blastdb/merged_consensus.fasta
[2024-10-05 17:58:18,986] INFO database_accessor.py execute_cmd :
[cmd] cat /home/data/acropora_db/consensus_fasta/AG_GAs11-67_S67.fa /home/data/acropora_db/consensus_fasta/AS_ASTUS31_S161.fa /home/data/acropora_db/consensus_fasta/AP_TS1_S1.fa /home/data/acropora_db/consensus_fasta/AM_A-1_S33.fa > /home/data/acropora_db/blastdb/merged_consensus.fasta
[2024-10-05 17:58:18,988] INFO database_accessor.py make_blastdb :
检查合并后的 FASTA 文件格式
[2024-10-05 17:58:18,988] INFO database_accessor.py execute_cmd :
[cmd] head -n 10 /home/data/acropora_db/blastdb/merged_consensus.fasta
[2024-10-05 17:58:18,989] INFO database_accessor.py execute_cmd :
>AG_GAs11-67_S67_2
TTCTGGTCCTCCTCCTTCTCCTTCTCGTTCTTGTTCTTGTTCGTGTTGTCGTTGCCGTTGTCGTTGTCCTTGTTGTCGTCATTGTCGTCATT
>AG_GAs11-67_S67_28
GACAATGATCAGTTTTTTTTTTTCACTGCAAAGAAAGTAAAAATGTAAATAATGACCTAGTTATGAGAAGCAAAGAAATGCAAAA
>AG_GAs11-67_S67_51
ATGTCATGTGCTCATAACTTCTCAGGGAAATGCCTCATGGTTTTAATCCTAACCAAGAAACTACAAATTCAACTCTAATAT
>AG_GAs11-67_S67_186
CCTCTTCGTCCTTTTCTTCCTTGTCTTCTTCGTCATCTCCTTCTTCCTCATCCTCTTCGTCCTTCTAGGGAAATCATGGCGA
>AG_GAs11-67_S67_310
GGGTGTCATATGACTCAAAGGGTAAGCTTTTTATCAATAACATTTCCGCACAAAATTTACTGTCAAACAAGTGAGGATATTT

[2024-10-05 17:58:18,989] INFO database_accessor.py make_blastdb :
创建 BLAST 数据库: /home/data/acropora_db/blastdb/acropora_db
[2024-10-05 17:58:18,989] INFO database_accessor.py execute_cmd :
[cmd] makeblastdb -in /home/data/acropora_db/blastdb/merged_consensus.fasta -out /home/data/acropora_db/blastdb/acropora_db -dbtype nucl -parse_seqids
[2024-10-05 17:58:19,048] INFO database_accessor.py execute_cmd :


Building a new DB, current time: 10/05/2024 17:58:18
New DB name:   /home/data/acropora_db/blastdb/acropora_db
New DB title:  /home/data/acropora_db/blastdb/merged_consensus.fasta
Sequence type: Nucleotide
Keep MBits: T
Maximum file size: 1000000000B
Adding sequences from FASTA; added 6684 sequences in 0.037987 seconds.



[2024-10-05 17:58:19,048] INFO database_accessor.py make_blastdb :
BLAST 数据库创建成功: /home/data/acropora_db/blastdb/acropora_db
[2024-10-05 17:58:19,048] INFO database_accessor.py run :
处理完成
[2024-10-05 17:58:19,049] INFO ACF.py execute_cmd :
[cmd] cd /home/data/acropora_db/ && tree . > tree.txt
[2024-10-05 17:58:19,053] INFO ACF.py write_analysis_complete_flag :
ANCAT_ANALYSIS_COMPLETED
[2024-10-05 17:59:48,019] INFO database_accessor.py execute_cmd :
[cmd] cp mkdb_acropora.conf /home/data/acropora_db/
[2024-10-05 17:59:48,021] INFO database_accessor.py logging_title :

########################
#### load fastq dir ####
########################
[2024-10-05 17:59:48,022] INFO database_accessor.py logging_title :

#################################
#### quality control : fastq ####
#################################
[2024-10-05 17:59:48,022] INFO database_accessor.py quality_control :
Processing sample: AS_ASTUS31_S161
[2024-10-05 17:59:48,022] INFO database_accessor.py execute_cmd :
[cmd] fastp -i /home/data/acropora/AS_ASTUS31_S161_L001_R1_001.fastq.gz -I /home/data/acropora/AS_ASTUS31_S161_L001_R2_001.fastq.gz -o /home/data/acropora_db/quality_control/AS_ASTUS31_S161_qc_R1.fastq.gz -O /home/data/acropora_db/quality_control/AS_ASTUS31_S161_qc_R2.fastq.gz -q 30 -f 0 -F 15 --cut_right --thread 8 --json /home/data/acropora_db/quality_control/AS_ASTUS31_S161_fastp.json --html /home/data/acropora_db/quality_control/AS_ASTUS31_S161_fastp.html
[2024-10-05 17:59:48,602] INFO database_accessor.py execute_cmd :
Read1 before filtering:
total reads: 162226
total bases: 12978080
Q20 bases: 12762049(98.3354%)
Q30 bases: 12317675(94.9114%)

Read2 before filtering:
total reads: 162226
total bases: 15249244
Q20 bases: 14935119(97.9401%)
Q30 bases: 14342176(94.0517%)

Read1 after filtering:
total reads: 158521
total bases: 12084495
Q20 bases: 11964325(99.0056%)
Q30 bases: 11633921(96.2715%)

Read2 after filtering:
total reads: 158521
total bases: 11411898
Q20 bases: 11287906(98.9135%)
Q30 bases: 10913654(95.634%)

Filtering result:
reads passed filter: 317042
reads failed due to low quality: 2624
reads failed due to too many N: 0
reads failed due to too short: 4786
reads with adapter trimmed: 58926
bases trimmed due to adapters: 1142077

Duplication rate: 56.3621%

Insert size peak (evaluated by paired-end reads): 95

JSON report: /home/data/acropora_db/quality_control/AS_ASTUS31_S161_fastp.json
HTML report: /home/data/acropora_db/quality_control/AS_ASTUS31_S161_fastp.html

fastp -i /home/data/acropora/AS_ASTUS31_S161_L001_R1_001.fastq.gz -I /home/data/acropora/AS_ASTUS31_S161_L001_R2_001.fastq.gz -o /home/data/acropora_db/quality_control/AS_ASTUS31_S161_qc_R1.fastq.gz -O /home/data/acropora_db/quality_control/AS_ASTUS31_S161_qc_R2.fastq.gz -q 30 -f 0 -F 15 --cut_right --thread 8 --json /home/data/acropora_db/quality_control/AS_ASTUS31_S161_fastp.json --html /home/data/acropora_db/quality_control/AS_ASTUS31_S161_fastp.html 
fastp v0.23.4, time used: 0 seconds

[2024-10-05 17:59:48,602] WARNING database_accessor.py quality_control :
fastp for AS_ASTUS31_S161 produced warnings: Read1 before filtering:
total reads: 162226
total bases: 12978080
Q20 bases: 12762049(98.3354%)
Q30 bases: 12317675(94.9114%)

Read2 before filtering:
total reads: 162226
total bases: 15249244
Q20 bases: 14935119(97.9401%)
Q30 bases: 14342176(94.0517%)

Read1 after filtering:
total reads: 158521
total bases: 12084495
Q20 bases: 11964325(99.0056%)
Q30 bases: 11633921(96.2715%)

Read2 after filtering:
total reads: 158521
total bases: 11411898
Q20 bases: 11287906(98.9135%)
Q30 bases: 10913654(95.634%)

Filtering result:
reads passed filter: 317042
reads failed due to low quality: 2624
reads failed due to too many N: 0
reads failed due to too short: 4786
reads with adapter trimmed: 58926
bases trimmed due to adapters: 1142077

Duplication rate: 56.3621%

Insert size peak (evaluated by paired-end reads): 95

JSON report: /home/data/acropora_db/quality_control/AS_ASTUS31_S161_fastp.json
HTML report: /home/data/acropora_db/quality_control/AS_ASTUS31_S161_fastp.html

fastp -i /home/data/acropora/AS_ASTUS31_S161_L001_R1_001.fastq.gz -I /home/data/acropora/AS_ASTUS31_S161_L001_R2_001.fastq.gz -o /home/data/acropora_db/quality_control/AS_ASTUS31_S161_qc_R1.fastq.gz -O /home/data/acropora_db/quality_control/AS_ASTUS31_S161_qc_R2.fastq.gz -q 30 -f 0 -F 15 --cut_right --thread 8 --json /home/data/acropora_db/quality_control/AS_ASTUS31_S161_fastp.json --html /home/data/acropora_db/quality_control/AS_ASTUS31_S161_fastp.html 
fastp v0.23.4, time used: 0 seconds

[2024-10-05 17:59:48,602] INFO database_accessor.py quality_control :
Finished processing sample: AS_ASTUS31_S161
[2024-10-05 17:59:48,602] INFO database_accessor.py quality_control :
Processing sample: AP_TS1_S1
[2024-10-05 17:59:48,602] INFO database_accessor.py execute_cmd :
[cmd] fastp -i /home/data/acropora/AP_TS1_S1_L001_R1_001.fastq.gz -I /home/data/acropora/AP_TS1_S1_L001_R2_001.fastq.gz -o /home/data/acropora_db/quality_control/AP_TS1_S1_qc_R1.fastq.gz -O /home/data/acropora_db/quality_control/AP_TS1_S1_qc_R2.fastq.gz -q 30 -f 0 -F 15 --cut_right --thread 8 --json /home/data/acropora_db/quality_control/AP_TS1_S1_fastp.json --html /home/data/acropora_db/quality_control/AP_TS1_S1_fastp.html
[2024-10-05 17:59:49,363] INFO database_accessor.py execute_cmd :
Read1 before filtering:
total reads: 248601
total bases: 19888080
Q20 bases: 19480257(97.9494%)
Q30 bases: 18588142(93.4637%)

Read2 before filtering:
total reads: 248601
total bases: 23617095
Q20 bases: 22812090(96.5914%)
Q30 bases: 21475937(90.9339%)

Read1 after filtering:
total reads: 231712
total bases: 17580299
Q20 bases: 17414800(99.0586%)
Q30 bases: 16830589(95.7355%)

Read2 after filtering:
total reads: 231712
total bases: 16739640
Q20 bases: 16514648(98.6559%)
Q30 bases: 15824490(94.533%)

Filtering result:
reads passed filter: 463424
reads failed due to low quality: 12162
reads failed due to too many N: 0
reads failed due to too short: 21616
reads with adapter trimmed: 99544
bases trimmed due to adapters: 1530502

Duplication rate: 64.4881%

Insert size peak (evaluated by paired-end reads): 71

JSON report: /home/data/acropora_db/quality_control/AP_TS1_S1_fastp.json
HTML report: /home/data/acropora_db/quality_control/AP_TS1_S1_fastp.html

fastp -i /home/data/acropora/AP_TS1_S1_L001_R1_001.fastq.gz -I /home/data/acropora/AP_TS1_S1_L001_R2_001.fastq.gz -o /home/data/acropora_db/quality_control/AP_TS1_S1_qc_R1.fastq.gz -O /home/data/acropora_db/quality_control/AP_TS1_S1_qc_R2.fastq.gz -q 30 -f 0 -F 15 --cut_right --thread 8 --json /home/data/acropora_db/quality_control/AP_TS1_S1_fastp.json --html /home/data/acropora_db/quality_control/AP_TS1_S1_fastp.html 
fastp v0.23.4, time used: 1 seconds

[2024-10-05 17:59:49,363] WARNING database_accessor.py quality_control :
fastp for AP_TS1_S1 produced warnings: Read1 before filtering:
total reads: 248601
total bases: 19888080
Q20 bases: 19480257(97.9494%)
Q30 bases: 18588142(93.4637%)

Read2 before filtering:
total reads: 248601
total bases: 23617095
Q20 bases: 22812090(96.5914%)
Q30 bases: 21475937(90.9339%)

Read1 after filtering:
total reads: 231712
total bases: 17580299
Q20 bases: 17414800(99.0586%)
Q30 bases: 16830589(95.7355%)

Read2 after filtering:
total reads: 231712
total bases: 16739640
Q20 bases: 16514648(98.6559%)
Q30 bases: 15824490(94.533%)

Filtering result:
reads passed filter: 463424
reads failed due to low quality: 12162
reads failed due to too many N: 0
reads failed due to too short: 21616
reads with adapter trimmed: 99544
bases trimmed due to adapters: 1530502

Duplication rate: 64.4881%

Insert size peak (evaluated by paired-end reads): 71

JSON report: /home/data/acropora_db/quality_control/AP_TS1_S1_fastp.json
HTML report: /home/data/acropora_db/quality_control/AP_TS1_S1_fastp.html

fastp -i /home/data/acropora/AP_TS1_S1_L001_R1_001.fastq.gz -I /home/data/acropora/AP_TS1_S1_L001_R2_001.fastq.gz -o /home/data/acropora_db/quality_control/AP_TS1_S1_qc_R1.fastq.gz -O /home/data/acropora_db/quality_control/AP_TS1_S1_qc_R2.fastq.gz -q 30 -f 0 -F 15 --cut_right --thread 8 --json /home/data/acropora_db/quality_control/AP_TS1_S1_fastp.json --html /home/data/acropora_db/quality_control/AP_TS1_S1_fastp.html 
fastp v0.23.4, time used: 1 seconds

[2024-10-05 17:59:49,363] INFO database_accessor.py quality_control :
Finished processing sample: AP_TS1_S1
[2024-10-05 17:59:49,363] INFO database_accessor.py quality_control :
Processing sample: AM_A-1_S33
[2024-10-05 17:59:49,363] INFO database_accessor.py execute_cmd :
[cmd] fastp -i /home/data/acropora/AM_A-1_S33_L001_R1_001.fastq.gz -I /home/data/acropora/AM_A-1_S33_L001_R2_001.fastq.gz -o /home/data/acropora_db/quality_control/AM_A-1_S33_qc_R1.fastq.gz -O /home/data/acropora_db/quality_control/AM_A-1_S33_qc_R2.fastq.gz -q 30 -f 0 -F 15 --cut_right --thread 8 --json /home/data/acropora_db/quality_control/AM_A-1_S33_fastp.json --html /home/data/acropora_db/quality_control/AM_A-1_S33_fastp.html
[2024-10-05 17:59:49,804] INFO database_accessor.py execute_cmd :
Read1 before filtering:
total reads: 97107
total bases: 7768560
Q20 bases: 7647822(98.4458%)
Q30 bases: 7362598(94.7743%)

Read2 before filtering:
total reads: 97107
total bases: 9128058
Q20 bases: 8907264(97.5812%)
Q30 bases: 8496983(93.0864%)

Read1 after filtering:
total reads: 93866
total bases: 7066298
Q20 bases: 7008421(99.1809%)
Q30 bases: 6804930(96.3012%)

Read2 after filtering:
total reads: 93866
total bases: 6587867
Q20 bases: 6517391(98.9302%)
Q30 bases: 6285324(95.4076%)

Filtering result:
reads passed filter: 187732
reads failed due to low quality: 2370
reads failed due to too many N: 0
reads failed due to too short: 4112
reads with adapter trimmed: 50244
bases trimmed due to adapters: 883198

Duplication rate: 53.0343%

Insert size peak (evaluated by paired-end reads): 57

JSON report: /home/data/acropora_db/quality_control/AM_A-1_S33_fastp.json
HTML report: /home/data/acropora_db/quality_control/AM_A-1_S33_fastp.html

fastp -i /home/data/acropora/AM_A-1_S33_L001_R1_001.fastq.gz -I /home/data/acropora/AM_A-1_S33_L001_R2_001.fastq.gz -o /home/data/acropora_db/quality_control/AM_A-1_S33_qc_R1.fastq.gz -O /home/data/acropora_db/quality_control/AM_A-1_S33_qc_R2.fastq.gz -q 30 -f 0 -F 15 --cut_right --thread 8 --json /home/data/acropora_db/quality_control/AM_A-1_S33_fastp.json --html /home/data/acropora_db/quality_control/AM_A-1_S33_fastp.html 
fastp v0.23.4, time used: 0 seconds

[2024-10-05 17:59:49,804] WARNING database_accessor.py quality_control :
fastp for AM_A-1_S33 produced warnings: Read1 before filtering:
total reads: 97107
total bases: 7768560
Q20 bases: 7647822(98.4458%)
Q30 bases: 7362598(94.7743%)

Read2 before filtering:
total reads: 97107
total bases: 9128058
Q20 bases: 8907264(97.5812%)
Q30 bases: 8496983(93.0864%)

Read1 after filtering:
total reads: 93866
total bases: 7066298
Q20 bases: 7008421(99.1809%)
Q30 bases: 6804930(96.3012%)

Read2 after filtering:
total reads: 93866
total bases: 6587867
Q20 bases: 6517391(98.9302%)
Q30 bases: 6285324(95.4076%)

Filtering result:
reads passed filter: 187732
reads failed due to low quality: 2370
reads failed due to too many N: 0
reads failed due to too short: 4112
reads with adapter trimmed: 50244
bases trimmed due to adapters: 883198

Duplication rate: 53.0343%

Insert size peak (evaluated by paired-end reads): 57

JSON report: /home/data/acropora_db/quality_control/AM_A-1_S33_fastp.json
HTML report: /home/data/acropora_db/quality_control/AM_A-1_S33_fastp.html

fastp -i /home/data/acropora/AM_A-1_S33_L001_R1_001.fastq.gz -I /home/data/acropora/AM_A-1_S33_L001_R2_001.fastq.gz -o /home/data/acropora_db/quality_control/AM_A-1_S33_qc_R1.fastq.gz -O /home/data/acropora_db/quality_control/AM_A-1_S33_qc_R2.fastq.gz -q 30 -f 0 -F 15 --cut_right --thread 8 --json /home/data/acropora_db/quality_control/AM_A-1_S33_fastp.json --html /home/data/acropora_db/quality_control/AM_A-1_S33_fastp.html 
fastp v0.23.4, time used: 0 seconds

[2024-10-05 17:59:49,804] INFO database_accessor.py quality_control :
Finished processing sample: AM_A-1_S33
[2024-10-05 17:59:49,805] INFO database_accessor.py quality_control :
Processing sample: AG_GAs11-67_S67
[2024-10-05 17:59:49,805] INFO database_accessor.py execute_cmd :
[cmd] fastp -i /home/data/acropora/AG_GAs11-67_S67_L001_R1_001.fastq.gz -I /home/data/acropora/AG_GAs11-67_S67_L001_R2_001.fastq.gz -o /home/data/acropora_db/quality_control/AG_GAs11-67_S67_qc_R1.fastq.gz -O /home/data/acropora_db/quality_control/AG_GAs11-67_S67_qc_R2.fastq.gz -q 30 -f 0 -F 15 --cut_right --thread 8 --json /home/data/acropora_db/quality_control/AG_GAs11-67_S67_fastp.json --html /home/data/acropora_db/quality_control/AG_GAs11-67_S67_fastp.html
[2024-10-05 17:59:50,331] INFO database_accessor.py execute_cmd :
Read1 before filtering:
total reads: 82521
total bases: 6601680
Q20 bases: 6416163(97.1899%)
Q30 bases: 6082997(92.1432%)

Read2 before filtering:
total reads: 82521
total bases: 7756974
Q20 bases: 7322026(94.3928%)
Q30 bases: 6779442(87.398%)

Read1 after filtering:
total reads: 79298
total bases: 5996604
Q20 bases: 5914403(98.6292%)
Q30 bases: 5679288(94.7084%)

Read2 after filtering:
total reads: 79298
total bases: 5490991
Q20 bases: 5383923(98.0501%)
Q30 bases: 5084929(92.6049%)

Filtering result:
reads passed filter: 158596
reads failed due to low quality: 2226
reads failed due to too many N: 0
reads failed due to too short: 4220
reads with adapter trimmed: 15980
bases trimmed due to adapters: 278157

Duplication rate: 41.8899%

Insert size peak (evaluated by paired-end reads): 64

JSON report: /home/data/acropora_db/quality_control/AG_GAs11-67_S67_fastp.json
HTML report: /home/data/acropora_db/quality_control/AG_GAs11-67_S67_fastp.html

fastp -i /home/data/acropora/AG_GAs11-67_S67_L001_R1_001.fastq.gz -I /home/data/acropora/AG_GAs11-67_S67_L001_R2_001.fastq.gz -o /home/data/acropora_db/quality_control/AG_GAs11-67_S67_qc_R1.fastq.gz -O /home/data/acropora_db/quality_control/AG_GAs11-67_S67_qc_R2.fastq.gz -q 30 -f 0 -F 15 --cut_right --thread 8 --json /home/data/acropora_db/quality_control/AG_GAs11-67_S67_fastp.json --html /home/data/acropora_db/quality_control/AG_GAs11-67_S67_fastp.html 
fastp v0.23.4, time used: 1 seconds

[2024-10-05 17:59:50,331] WARNING database_accessor.py quality_control :
fastp for AG_GAs11-67_S67 produced warnings: Read1 before filtering:
total reads: 82521
total bases: 6601680
Q20 bases: 6416163(97.1899%)
Q30 bases: 6082997(92.1432%)

Read2 before filtering:
total reads: 82521
total bases: 7756974
Q20 bases: 7322026(94.3928%)
Q30 bases: 6779442(87.398%)

Read1 after filtering:
total reads: 79298
total bases: 5996604
Q20 bases: 5914403(98.6292%)
Q30 bases: 5679288(94.7084%)

Read2 after filtering:
total reads: 79298
total bases: 5490991
Q20 bases: 5383923(98.0501%)
Q30 bases: 5084929(92.6049%)

Filtering result:
reads passed filter: 158596
reads failed due to low quality: 2226
reads failed due to too many N: 0
reads failed due to too short: 4220
reads with adapter trimmed: 15980
bases trimmed due to adapters: 278157

Duplication rate: 41.8899%

Insert size peak (evaluated by paired-end reads): 64

JSON report: /home/data/acropora_db/quality_control/AG_GAs11-67_S67_fastp.json
HTML report: /home/data/acropora_db/quality_control/AG_GAs11-67_S67_fastp.html

fastp -i /home/data/acropora/AG_GAs11-67_S67_L001_R1_001.fastq.gz -I /home/data/acropora/AG_GAs11-67_S67_L001_R2_001.fastq.gz -o /home/data/acropora_db/quality_control/AG_GAs11-67_S67_qc_R1.fastq.gz -O /home/data/acropora_db/quality_control/AG_GAs11-67_S67_qc_R2.fastq.gz -q 30 -f 0 -F 15 --cut_right --thread 8 --json /home/data/acropora_db/quality_control/AG_GAs11-67_S67_fastp.json --html /home/data/acropora_db/quality_control/AG_GAs11-67_S67_fastp.html 
fastp v0.23.4, time used: 1 seconds

[2024-10-05 17:59:50,331] INFO database_accessor.py quality_control :
Finished processing sample: AG_GAs11-67_S67
[2024-10-05 17:59:50,331] INFO database_accessor.py quality_control :
Quality control completed for all samples
[2024-10-05 17:59:50,331] INFO database_accessor.py logging_title :

####################
#### 接头修剪：fastq ####
####################
[2024-10-05 17:59:50,332] INFO database_accessor.py execute_cmd :
[cmd] fastp -i /home/data/acropora_db/quality_control/AS_ASTUS31_S161_qc_R1.fastq.gz -I /home/data/acropora_db/quality_control/AS_ASTUS31_S161_qc_R2.fastq.gz -o /home/data/acropora_db/adapter_trim/AS_ASTUS31_S161_at_R1.fastq.gz -O /home/data/acropora_db/adapter_trim/AS_ASTUS31_S161_at_R2.fastq.gz --adapter_sequence GTCAGATCGGAAGAGCACACGTCTGAACTCCAGTCAC --adapter_sequence_r2 CAGAGATCGGAAGAGCGTCGTGTAGGGAAAGAC --cut_right --cut_window_size 4 --cut_mean_quality 20 --length_required 36 --length_limit 150 --average_qual 19 --thread 8 --json /home/data/acropora_db/adapter_trim/AS_ASTUS31_S161_fastp.json --html /home/data/acropora_db/adapter_trim/AS_ASTUS31_S161_fastp.html
[2024-10-05 17:59:50,820] INFO database_accessor.py execute_cmd :
Read1 before filtering:
total reads: 158521
total bases: 12084495
Q20 bases: 11964325(99.0056%)
Q30 bases: 11633921(96.2715%)

Read2 before filtering:
total reads: 158521
total bases: 11411898
Q20 bases: 11287906(98.9135%)
Q30 bases: 10913654(95.634%)

Read1 after filtering:
total reads: 79051
total bases: 5841951
Q20 bases: 5798389(99.2543%)
Q30 bases: 5670180(97.0597%)

Read2 after filtering:
total reads: 79051
total bases: 5438862
Q20 bases: 5399343(99.2734%)
Q30 bases: 5262418(96.7559%)

Filtering result:
reads passed filter: 158102
reads failed due to low quality: 0
reads failed due to too many N: 0
reads failed due to too short: 158940
reads failed due to too long: 0
reads with adapter trimmed: 154518
bases trimmed due to adapters: 8207681

Duplication rate: 58.0768%

Insert size peak (evaluated by paired-end reads): 80

JSON report: /home/data/acropora_db/adapter_trim/AS_ASTUS31_S161_fastp.json
HTML report: /home/data/acropora_db/adapter_trim/AS_ASTUS31_S161_fastp.html

fastp -i /home/data/acropora_db/quality_control/AS_ASTUS31_S161_qc_R1.fastq.gz -I /home/data/acropora_db/quality_control/AS_ASTUS31_S161_qc_R2.fastq.gz -o /home/data/acropora_db/adapter_trim/AS_ASTUS31_S161_at_R1.fastq.gz -O /home/data/acropora_db/adapter_trim/AS_ASTUS31_S161_at_R2.fastq.gz --adapter_sequence GTCAGATCGGAAGAGCACACGTCTGAACTCCAGTCAC --adapter_sequence_r2 CAGAGATCGGAAGAGCGTCGTGTAGGGAAAGAC --cut_right --cut_window_size 4 --cut_mean_quality 20 --length_required 36 --length_limit 150 --average_qual 19 --thread 8 --json /home/data/acropora_db/adapter_trim/AS_ASTUS31_S161_fastp.json --html /home/data/acropora_db/adapter_trim/AS_ASTUS31_S161_fastp.html 
fastp v0.23.4, time used: 0 seconds

[2024-10-05 17:59:50,820] INFO database_accessor.py execute_cmd :
[cmd] fastp -i /home/data/acropora_db/quality_control/AP_TS1_S1_qc_R1.fastq.gz -I /home/data/acropora_db/quality_control/AP_TS1_S1_qc_R2.fastq.gz -o /home/data/acropora_db/adapter_trim/AP_TS1_S1_at_R1.fastq.gz -O /home/data/acropora_db/adapter_trim/AP_TS1_S1_at_R2.fastq.gz --adapter_sequence GTCAGATCGGAAGAGCACACGTCTGAACTCCAGTCAC --adapter_sequence_r2 CAGAGATCGGAAGAGCGTCGTGTAGGGAAAGAC --cut_right --cut_window_size 4 --cut_mean_quality 20 --length_required 36 --length_limit 150 --average_qual 19 --thread 8 --json /home/data/acropora_db/adapter_trim/AP_TS1_S1_fastp.json --html /home/data/acropora_db/adapter_trim/AP_TS1_S1_fastp.html
[2024-10-05 17:59:51,516] INFO database_accessor.py execute_cmd :
Read1 before filtering:
total reads: 231712
total bases: 17580299
Q20 bases: 17414800(99.0586%)
Q30 bases: 16830589(95.7355%)

Read2 before filtering:
total reads: 231712
total bases: 16739640
Q20 bases: 16514648(98.6559%)
Q30 bases: 15824490(94.533%)

Read1 after filtering:
total reads: 119529
total bases: 8749001
Q20 bases: 8688635(99.31%)
Q30 bases: 8447878(96.5582%)

Read2 after filtering:
total reads: 119529
total bases: 8129678
Q20 bases: 8057783(99.1156%)
Q30 bases: 7796800(95.9054%)

Filtering result:
reads passed filter: 239058
reads failed due to low quality: 20
reads failed due to too many N: 0
reads failed due to too short: 224346
reads failed due to too long: 0
reads with adapter trimmed: 223016
bases trimmed due to adapters: 11817632

Duplication rate: 68.6382%

Insert size peak (evaluated by paired-end reads): 56

JSON report: /home/data/acropora_db/adapter_trim/AP_TS1_S1_fastp.json
HTML report: /home/data/acropora_db/adapter_trim/AP_TS1_S1_fastp.html

fastp -i /home/data/acropora_db/quality_control/AP_TS1_S1_qc_R1.fastq.gz -I /home/data/acropora_db/quality_control/AP_TS1_S1_qc_R2.fastq.gz -o /home/data/acropora_db/adapter_trim/AP_TS1_S1_at_R1.fastq.gz -O /home/data/acropora_db/adapter_trim/AP_TS1_S1_at_R2.fastq.gz --adapter_sequence GTCAGATCGGAAGAGCACACGTCTGAACTCCAGTCAC --adapter_sequence_r2 CAGAGATCGGAAGAGCGTCGTGTAGGGAAAGAC --cut_right --cut_window_size 4 --cut_mean_quality 20 --length_required 36 --length_limit 150 --average_qual 19 --thread 8 --json /home/data/acropora_db/adapter_trim/AP_TS1_S1_fastp.json --html /home/data/acropora_db/adapter_trim/AP_TS1_S1_fastp.html 
fastp v0.23.4, time used: 1 seconds

[2024-10-05 17:59:51,516] INFO database_accessor.py execute_cmd :
[cmd] fastp -i /home/data/acropora_db/quality_control/AM_A-1_S33_qc_R1.fastq.gz -I /home/data/acropora_db/quality_control/AM_A-1_S33_qc_R2.fastq.gz -o /home/data/acropora_db/adapter_trim/AM_A-1_S33_at_R1.fastq.gz -O /home/data/acropora_db/adapter_trim/AM_A-1_S33_at_R2.fastq.gz --adapter_sequence GTCAGATCGGAAGAGCACACGTCTGAACTCCAGTCAC --adapter_sequence_r2 CAGAGATCGGAAGAGCGTCGTGTAGGGAAAGAC --cut_right --cut_window_size 4 --cut_mean_quality 20 --length_required 36 --length_limit 150 --average_qual 19 --thread 8 --json /home/data/acropora_db/adapter_trim/AM_A-1_S33_fastp.json --html /home/data/acropora_db/adapter_trim/AM_A-1_S33_fastp.html
[2024-10-05 17:59:52,042] INFO database_accessor.py execute_cmd :
Read1 before filtering:
total reads: 93866
total bases: 7066298
Q20 bases: 7008421(99.1809%)
Q30 bases: 6804930(96.3012%)

Read2 before filtering:
total reads: 93866
total bases: 6587867
Q20 bases: 6517391(98.9302%)
Q30 bases: 6285324(95.4076%)

Read1 after filtering:
total reads: 70057
total bases: 5238507
Q20 bases: 5207195(99.4023%)
Q30 bases: 5082504(97.022%)

Read2 after filtering:
total reads: 70057
total bases: 4876236
Q20 bases: 4840109(99.2591%)
Q30 bases: 4707250(96.5345%)

Filtering result:
reads passed filter: 140114
reads failed due to low quality: 2
reads failed due to too many N: 0
reads failed due to too short: 47616
reads failed due to too long: 0
reads with adapter trimmed: 44894
bases trimmed due to adapters: 2404472

Duplication rate: 56.4027%

Insert size peak (evaluated by paired-end reads): 42

JSON report: /home/data/acropora_db/adapter_trim/AM_A-1_S33_fastp.json
HTML report: /home/data/acropora_db/adapter_trim/AM_A-1_S33_fastp.html

fastp -i /home/data/acropora_db/quality_control/AM_A-1_S33_qc_R1.fastq.gz -I /home/data/acropora_db/quality_control/AM_A-1_S33_qc_R2.fastq.gz -o /home/data/acropora_db/adapter_trim/AM_A-1_S33_at_R1.fastq.gz -O /home/data/acropora_db/adapter_trim/AM_A-1_S33_at_R2.fastq.gz --adapter_sequence GTCAGATCGGAAGAGCACACGTCTGAACTCCAGTCAC --adapter_sequence_r2 CAGAGATCGGAAGAGCGTCGTGTAGGGAAAGAC --cut_right --cut_window_size 4 --cut_mean_quality 20 --length_required 36 --length_limit 150 --average_qual 19 --thread 8 --json /home/data/acropora_db/adapter_trim/AM_A-1_S33_fastp.json --html /home/data/acropora_db/adapter_trim/AM_A-1_S33_fastp.html 
fastp v0.23.4, time used: 1 seconds

[2024-10-05 17:59:52,042] INFO database_accessor.py execute_cmd :
[cmd] fastp -i /home/data/acropora_db/quality_control/AG_GAs11-67_S67_qc_R1.fastq.gz -I /home/data/acropora_db/quality_control/AG_GAs11-67_S67_qc_R2.fastq.gz -o /home/data/acropora_db/adapter_trim/AG_GAs11-67_S67_at_R1.fastq.gz -O /home/data/acropora_db/adapter_trim/AG_GAs11-67_S67_at_R2.fastq.gz --adapter_sequence GTCAGATCGGAAGAGCACACGTCTGAACTCCAGTCAC --adapter_sequence_r2 CAGAGATCGGAAGAGCGTCGTGTAGGGAAAGAC --cut_right --cut_window_size 4 --cut_mean_quality 20 --length_required 36 --length_limit 150 --average_qual 19 --thread 8 --json /home/data/acropora_db/adapter_trim/AG_GAs11-67_S67_fastp.json --html /home/data/acropora_db/adapter_trim/AG_GAs11-67_S67_fastp.html
[2024-10-05 17:59:52,425] INFO database_accessor.py execute_cmd :
Read1 before filtering:
total reads: 79298
total bases: 5996604
Q20 bases: 5914403(98.6292%)
Q30 bases: 5679288(94.7084%)

Read2 before filtering:
total reads: 79298
total bases: 5490991
Q20 bases: 5383923(98.0501%)
Q30 bases: 5084929(92.6049%)

Read1 after filtering:
total reads: 51622
total bases: 3958367
Q20 bases: 3921935(99.0796%)
Q30 bases: 3800062(96.0007%)

Read2 after filtering:
total reads: 51622
total bases: 3772927
Q20 bases: 3718987(98.5703%)
Q30 bases: 3556932(94.2751%)

Filtering result:
reads passed filter: 103244
reads failed due to low quality: 0
reads failed due to too many N: 0
reads failed due to too short: 55352
reads failed due to too long: 0
reads with adapter trimmed: 51133
bases trimmed due to adapters: 2655651

Duplication rate: 46.0642%

Insert size peak (evaluated by paired-end reads): 49

JSON report: /home/data/acropora_db/adapter_trim/AG_GAs11-67_S67_fastp.json
HTML report: /home/data/acropora_db/adapter_trim/AG_GAs11-67_S67_fastp.html

fastp -i /home/data/acropora_db/quality_control/AG_GAs11-67_S67_qc_R1.fastq.gz -I /home/data/acropora_db/quality_control/AG_GAs11-67_S67_qc_R2.fastq.gz -o /home/data/acropora_db/adapter_trim/AG_GAs11-67_S67_at_R1.fastq.gz -O /home/data/acropora_db/adapter_trim/AG_GAs11-67_S67_at_R2.fastq.gz --adapter_sequence GTCAGATCGGAAGAGCACACGTCTGAACTCCAGTCAC --adapter_sequence_r2 CAGAGATCGGAAGAGCGTCGTGTAGGGAAAGAC --cut_right --cut_window_size 4 --cut_mean_quality 20 --length_required 36 --length_limit 150 --average_qual 19 --thread 8 --json /home/data/acropora_db/adapter_trim/AG_GAs11-67_S67_fastp.json --html /home/data/acropora_db/adapter_trim/AG_GAs11-67_S67_fastp.html 
fastp v0.23.4, time used: 0 seconds

[2024-10-05 17:59:52,425] INFO database_accessor.py adapter_trim :
所有样本的接头修剪已完成
[2024-10-05 17:59:52,425] INFO database_accessor.py logging_title :

#########################
#### fastq 转换为 fasta ####
#########################
[2024-10-05 17:59:52,425] INFO database_accessor.py execute_cmd :
[cmd] seqkit fq2fa -o /home/data/acropora_db/fasta/AS_ASTUS31_S161.fasta.gz /home/data/acropora_db/adapter_trim/AS_ASTUS31_S161_at_R1.fastq.gz /home/data/acropora_db/adapter_trim/AS_ASTUS31_S161_at_R2.fastq.gz
[2024-10-05 17:59:52,676] INFO database_accessor.py execute_cmd :
[cmd] seqkit fq2fa -o /home/data/acropora_db/fasta/AP_TS1_S1.fasta.gz /home/data/acropora_db/adapter_trim/AP_TS1_S1_at_R1.fastq.gz /home/data/acropora_db/adapter_trim/AP_TS1_S1_at_R2.fastq.gz
[2024-10-05 17:59:53,058] INFO database_accessor.py execute_cmd :
[cmd] seqkit fq2fa -o /home/data/acropora_db/fasta/AM_A-1_S33.fasta.gz /home/data/acropora_db/adapter_trim/AM_A-1_S33_at_R1.fastq.gz /home/data/acropora_db/adapter_trim/AM_A-1_S33_at_R2.fastq.gz
[2024-10-05 17:59:53,199] INFO database_accessor.py execute_cmd :
[cmd] seqkit fq2fa -o /home/data/acropora_db/fasta/AG_GAs11-67_S67.fasta.gz /home/data/acropora_db/adapter_trim/AG_GAs11-67_S67_at_R1.fastq.gz /home/data/acropora_db/adapter_trim/AG_GAs11-67_S67_at_R2.fastq.gz
[2024-10-05 17:59:53,311] INFO database_accessor.py fastq_to_fasta :
所有样本的 FASTQ 到 FASTA 转换已完成
[2024-10-05 17:59:53,311] INFO database_accessor.py execute_cmd :
[cmd] seqkit seq -m 80 -M 80 /home/data/acropora_db/fasta/AS_ASTUS31_S161.fasta.gz | gzip > /home/data/acropora_db/fasta/AS_ASTUS31_S161_uniform.fasta.gz
[2024-10-05 17:59:53,819] INFO database_accessor.py execute_cmd :
[33m[WARN][0m you may switch on flag -g/--remove-gaps to remove spaces

[2024-10-05 17:59:53,820] INFO database_accessor.py execute_cmd :
[cmd] seqkit seq -m 80 -M 80 /home/data/acropora_db/fasta/AP_TS1_S1.fasta.gz | gzip > /home/data/acropora_db/fasta/AP_TS1_S1_uniform.fasta.gz
[2024-10-05 17:59:54,727] INFO database_accessor.py execute_cmd :
[33m[WARN][0m you may switch on flag -g/--remove-gaps to remove spaces

[2024-10-05 17:59:54,727] INFO database_accessor.py execute_cmd :
[cmd] seqkit seq -m 80 -M 80 /home/data/acropora_db/fasta/AM_A-1_S33.fasta.gz | gzip > /home/data/acropora_db/fasta/AM_A-1_S33_uniform.fasta.gz
[2024-10-05 17:59:55,199] INFO database_accessor.py execute_cmd :
[33m[WARN][0m you may switch on flag -g/--remove-gaps to remove spaces

[2024-10-05 17:59:55,199] INFO database_accessor.py execute_cmd :
[cmd] seqkit seq -m 80 -M 80 /home/data/acropora_db/fasta/AG_GAs11-67_S67.fasta.gz | gzip > /home/data/acropora_db/fasta/AG_GAs11-67_S67_uniform.fasta.gz
[2024-10-05 17:59:55,587] INFO database_accessor.py execute_cmd :
[33m[WARN][0m you may switch on flag -g/--remove-gaps to remove spaces

[2024-10-05 17:59:55,588] INFO database_accessor.py logging_title :

#################
#### ustacks ####
#################
[2024-10-05 17:59:55,588] INFO database_accessor.py stacks :
Running ustacks for sample: AS_ASTUS31_S161
[2024-10-05 17:59:55,588] INFO database_accessor.py stacks :
Command: ustacks -f /home/data/acropora_db/fasta/AS_ASTUS31_S161_uniform.fasta.gz -o /home/data/acropora_db/ustacks --name AS_ASTUS31_S161 -i 1 -m 3 -M 2 -p 8
[2024-10-05 17:59:55,588] INFO database_accessor.py execute_cmd :
[cmd] ustacks -f /home/data/acropora_db/fasta/AS_ASTUS31_S161_uniform.fasta.gz -o /home/data/acropora_db/ustacks --name AS_ASTUS31_S161 -i 1 -m 3 -M 2 -p 8
[2024-10-05 17:59:56,211] INFO database_accessor.py execute_cmd :
ustacks parameters selected:
  Input file: '/home/data/acropora_db/fasta/AS_ASTUS31_S161_uniform.fasta.gz'
  Sample ID: 1
  Min depth of coverage to create a stack (m): 3
  Repeat removal algorithm: enabled
  Max distance allowed between stacks (M): 2
  Max distance allowed to align secondary reads: 4
  Max number of stacks allowed per de novo locus: 3
  Deleveraging algorithm: disabled
  Gapped assembly: enabled
  Minimum alignment length: 0.8
  Model type: SNP
  Alpha significance level for model: 0.05

Loading RAD-Tags...
Warning: Input reads contained 28 uncalled nucleotides.

Loaded 53942 reads; formed:
  2358 stacks representing 34094 primary reads (63.2%)
  18039 secondary stacks representing 19848 secondary reads (36.8%)

Stack coverage: mean=14.46; stdev=53.71; max=1311; n_reads=34094(63.2%)
Removing repetitive stacks: cov > 176 (mean+3*stdev)...
  Blacklisted 206 stacks.
Coverage after repeat removal: mean=10.86; stdev=17.90; max=174; n_reads=23378(43.3%)

Assembling stacks (max. dist. M=2)...
  Assembled 2152 stacks into 1737; blacklisted 36 stacks.
Coverage after assembling stacks: mean=11.62; stdev=17.83; max=181; n_reads=19559(36.3%)

Merging secondary stacks (max. dist. N=4 from consensus)...
  Merged 7119 out of 19848 secondary reads (35.9%), 1155 merged with gapped alignments.
Coverage after merging secondary stacks: mean=15.85; stdev=23.02; max=217; n_reads=26678(49.5%)

Assembling stacks, allowing for gaps (min. match length 80.0%)...
  Assembled 1737 stacks into 1624 stacks.
Coverage after gapped assembly: mean=16.99; stdev=24.38; max=225; n_reads=26678(49.5%)

Merging secondary stacks, allowing for gaps (min. match length 80.0%)...
  Merged 2860 out of 12729 secondary reads (22.5%).
Coverage after merging gapped secondary stacks: mean=18.81; stdev=26.88; max=228; n_reads=29538(54.8%)

Final number of stacks built: 1624
Final coverage: mean=18.81; stdev=26.88; max=228; n_reads=29538(54.8%)
Calling consensus sequences and haplotypes for catalog assembly...
Writing tags, SNPs, and alleles files to '/home/data/acropora_db/ustacks/AS_ASTUS31_S161'...done.
ustacks is done.

[2024-10-05 17:59:56,212] INFO database_accessor.py stacks :
ustacks successfully processed sample: AS_ASTUS31_S161
[2024-10-05 17:59:56,212] INFO database_accessor.py stacks :
Running ustacks for sample: AP_TS1_S1
[2024-10-05 17:59:56,212] INFO database_accessor.py stacks :
Command: ustacks -f /home/data/acropora_db/fasta/AP_TS1_S1_uniform.fasta.gz -o /home/data/acropora_db/ustacks --name AP_TS1_S1 -i 2 -m 3 -M 2 -p 8
[2024-10-05 17:59:56,212] INFO database_accessor.py execute_cmd :
[cmd] ustacks -f /home/data/acropora_db/fasta/AP_TS1_S1_uniform.fasta.gz -o /home/data/acropora_db/ustacks --name AP_TS1_S1 -i 2 -m 3 -M 2 -p 8
[2024-10-05 17:59:57,369] INFO database_accessor.py execute_cmd :
ustacks parameters selected:
  Input file: '/home/data/acropora_db/fasta/AP_TS1_S1_uniform.fasta.gz'
  Sample ID: 2
  Min depth of coverage to create a stack (m): 3
  Repeat removal algorithm: enabled
  Max distance allowed between stacks (M): 2
  Max distance allowed to align secondary reads: 4
  Max number of stacks allowed per de novo locus: 3
  Deleveraging algorithm: disabled
  Gapped assembly: enabled
  Minimum alignment length: 0.8
  Model type: SNP
  Alpha significance level for model: 0.05

Loading RAD-Tags...

Loaded 132844 reads; formed:
  4103 stacks representing 106978 primary reads (80.5%)
  23273 secondary stacks representing 25866 secondary reads (19.5%)

Stack coverage: mean=26.07; stdev=162.96; max=3789; n_reads=106978(80.5%)
Removing repetitive stacks: cov > 515 (mean+3*stdev)...
  Blacklisted 810 stacks.
Coverage after repeat removal: mean=18.76; stdev=45.94; max=503; n_reads=61763(46.5%)

Assembling stacks (max. dist. M=2)...
  Assembled 3293 stacks into 2828; blacklisted 37 stacks.
Coverage after assembling stacks: mean=18.73; stdev=41.41; max=505; n_reads=51877(39.1%)

Merging secondary stacks (max. dist. N=4 from consensus)...
  Merged 10842 out of 25866 secondary reads (41.9%), 1929 merged with gapped alignments.
Coverage after merging secondary stacks: mean=22.64; stdev=48.36; max=558; n_reads=62719(47.2%)

Assembling stacks, allowing for gaps (min. match length 80.0%)...
  Assembled 2828 stacks into 2191 stacks.
Coverage after gapped assembly: mean=29.40; stdev=58.41; max=652; n_reads=62719(47.2%)

Merging secondary stacks, allowing for gaps (min. match length 80.0%)...
  Merged 5525 out of 15024 secondary reads (36.8%).
Coverage after merging gapped secondary stacks: mean=31.99; stdev=60.52; max=659; n_reads=68244(51.4%)

Final number of stacks built: 2191
Final coverage: mean=31.99; stdev=60.52; max=659; n_reads=68244(51.4%)
Calling consensus sequences and haplotypes for catalog assembly...
Writing tags, SNPs, and alleles files to '/home/data/acropora_db/ustacks/AP_TS1_S1'...done.
ustacks is done.

[2024-10-05 17:59:57,369] INFO database_accessor.py stacks :
ustacks successfully processed sample: AP_TS1_S1
[2024-10-05 17:59:57,369] INFO database_accessor.py stacks :
Running ustacks for sample: AM_A-1_S33
[2024-10-05 17:59:57,369] INFO database_accessor.py stacks :
Command: ustacks -f /home/data/acropora_db/fasta/AM_A-1_S33_uniform.fasta.gz -o /home/data/acropora_db/ustacks --name AM_A-1_S33 -i 3 -m 3 -M 2 -p 8
[2024-10-05 17:59:57,369] INFO database_accessor.py execute_cmd :
[cmd] ustacks -f /home/data/acropora_db/fasta/AM_A-1_S33_uniform.fasta.gz -o /home/data/acropora_db/ustacks --name AM_A-1_S33 -i 3 -m 3 -M 2 -p 8
[2024-10-05 17:59:57,924] INFO database_accessor.py execute_cmd :
ustacks parameters selected:
  Input file: '/home/data/acropora_db/fasta/AM_A-1_S33_uniform.fasta.gz'
  Sample ID: 3
  Min depth of coverage to create a stack (m): 3
  Repeat removal algorithm: enabled
  Max distance allowed between stacks (M): 2
  Max distance allowed to align secondary reads: 4
  Max number of stacks allowed per de novo locus: 3
  Deleveraging algorithm: disabled
  Gapped assembly: enabled
  Minimum alignment length: 0.8
  Model type: SNP
  Alpha significance level for model: 0.05

Loading RAD-Tags...

Loaded 50057 reads; formed:
  2023 stacks representing 35081 primary reads (70.1%)
  13554 secondary stacks representing 14976 secondary reads (29.9%)

Stack coverage: mean=17.34; stdev=44.82; max=818; n_reads=35081(70.1%)
Removing repetitive stacks: cov > 152 (mean+3*stdev)...
  Blacklisted 98 stacks.
Coverage after repeat removal: mean=13.00; stdev=19.48; max=149; n_reads=25028(50.0%)

Assembling stacks (max. dist. M=2)...
  Assembled 1925 stacks into 1721; blacklisted 16 stacks.
Coverage after assembling stacks: mean=13.89; stdev=22.36; max=262; n_reads=23288(46.5%)

Merging secondary stacks (max. dist. N=4 from consensus)...
  Merged 5032 out of 14976 secondary reads (33.6%), 440 merged with gapped alignments.
Coverage after merging secondary stacks: mean=16.89; stdev=26.65; max=305; n_reads=28320(56.6%)

Assembling stacks, allowing for gaps (min. match length 80.0%)...
  Assembled 1721 stacks into 1565 stacks.
Coverage after gapped assembly: mean=18.62; stdev=28.94; max=305; n_reads=28320(56.6%)

Merging secondary stacks, allowing for gaps (min. match length 80.0%)...
  Merged 2580 out of 9944 secondary reads (25.9%).
Coverage after merging gapped secondary stacks: mean=20.32; stdev=30.62; max=306; n_reads=30900(61.7%)

Final number of stacks built: 1565
Final coverage: mean=20.32; stdev=30.62; max=306; n_reads=30900(61.7%)
Calling consensus sequences and haplotypes for catalog assembly...
Writing tags, SNPs, and alleles files to '/home/data/acropora_db/ustacks/AM_A-1_S33'...done.
ustacks is done.

[2024-10-05 17:59:57,924] INFO database_accessor.py stacks :
ustacks successfully processed sample: AM_A-1_S33
[2024-10-05 17:59:57,924] INFO database_accessor.py stacks :
Running ustacks for sample: AG_GAs11-67_S67
[2024-10-05 17:59:57,924] INFO database_accessor.py stacks :
Command: ustacks -f /home/data/acropora_db/fasta/AG_GAs11-67_S67_uniform.fasta.gz -o /home/data/acropora_db/ustacks --name AG_GAs11-67_S67 -i 4 -m 3 -M 2 -p 8
[2024-10-05 17:59:57,924] INFO database_accessor.py execute_cmd :
[cmd] ustacks -f /home/data/acropora_db/fasta/AG_GAs11-67_S67_uniform.fasta.gz -o /home/data/acropora_db/ustacks --name AG_GAs11-67_S67 -i 4 -m 3 -M 2 -p 8
[2024-10-05 17:59:58,390] INFO database_accessor.py execute_cmd :
ustacks parameters selected:
  Input file: '/home/data/acropora_db/fasta/AG_GAs11-67_S67_uniform.fasta.gz'
  Sample ID: 4
  Min depth of coverage to create a stack (m): 3
  Repeat removal algorithm: enabled
  Max distance allowed between stacks (M): 2
  Max distance allowed to align secondary reads: 4
  Max number of stacks allowed per de novo locus: 3
  Deleveraging algorithm: disabled
  Gapped assembly: enabled
  Minimum alignment length: 0.8
  Model type: SNP
  Alpha significance level for model: 0.05

Loading RAD-Tags...
Warning: Input reads contained 1 uncalled nucleotides.

Loaded 42595 reads; formed:
  1734 stacks representing 29473 primary reads (69.2%)
  11868 secondary stacks representing 13122 secondary reads (30.8%)

Stack coverage: mean=17.00; stdev=60.60; max=1955; n_reads=29473(69.2%)
Removing repetitive stacks: cov > 199 (mean+3*stdev)...
  Blacklisted 121 stacks.
Coverage after repeat removal: mean=13.16; stdev=21.91; max=190; n_reads=21222(49.8%)

Assembling stacks (max. dist. M=2)...
  Assembled 1613 stacks into 1408; blacklisted 17 stacks.
Coverage after assembling stacks: mean=13.95; stdev=22.82; max=194; n_reads=19161(45.0%)

Merging secondary stacks (max. dist. N=4 from consensus)...
  Merged 4822 out of 13122 secondary reads (36.7%), 638 merged with gapped alignments.
Coverage after merging secondary stacks: mean=17.45; stdev=27.76; max=227; n_reads=23983(56.3%)

Assembling stacks, allowing for gaps (min. match length 80.0%)...
  Assembled 1408 stacks into 1304 stacks.
Coverage after gapped assembly: mean=18.88; stdev=29.88; max=227; n_reads=23983(56.3%)

Merging secondary stacks, allowing for gaps (min. match length 80.0%)...
  Merged 1512 out of 8300 secondary reads (18.2%).
Coverage after merging gapped secondary stacks: mean=20.07; stdev=30.84; max=228; n_reads=25495(59.9%)

Final number of stacks built: 1304
Final coverage: mean=20.07; stdev=30.84; max=228; n_reads=25495(59.9%)
Calling consensus sequences and haplotypes for catalog assembly...
Writing tags, SNPs, and alleles files to '/home/data/acropora_db/ustacks/AG_GAs11-67_S67'...done.
ustacks is done.

[2024-10-05 17:59:58,390] INFO database_accessor.py stacks :
ustacks successfully processed sample: AG_GAs11-67_S67
[2024-10-05 17:59:58,391] INFO database_accessor.py run :
stacks 处理完成
[2024-10-05 17:59:58,391] INFO database_accessor.py run :
当前 files_to_process: {'AS_ASTUS31_S161': '/home/data/acropora_db/ustacks/AS_ASTUS31_S161.tags.tsv.gz', 'AP_TS1_S1': '/home/data/acropora_db/ustacks/AP_TS1_S1.tags.tsv.gz', 'AM_A-1_S33': '/home/data/acropora_db/ustacks/AM_A-1_S33.tags.tsv.gz', 'AG_GAs11-67_S67': '/home/data/acropora_db/ustacks/AG_GAs11-67_S67.tags.tsv.gz'}
[2024-10-05 17:59:58,391] INFO database_accessor.py logging_title :

#################################
#### extract consensus fasta ####
#################################
[2024-10-05 17:59:58,391] INFO database_accessor.py extract_consensus_fasta :
[cmd] zcat /home/data/acropora_db/ustacks/AS_ASTUS31_S161.tags.tsv.gz | awk '{if($3=="consensus") {printf ">AS_ASTUS31_S161_%d\n%s\n", NR, $4}}' > /home/data/acropora_db/consensus_fasta/AS_ASTUS31_S161.fa
[2024-10-05 17:59:58,391] INFO database_accessor.py execute_cmd :
[cmd] zcat /home/data/acropora_db/ustacks/AS_ASTUS31_S161.tags.tsv.gz | awk '{if($3=="consensus") {printf ">AS_ASTUS31_S161_%d\n%s\n", NR, $4}}' > /home/data/acropora_db/consensus_fasta/AS_ASTUS31_S161.fa
[2024-10-05 17:59:58,417] INFO database_accessor.py extract_consensus_fasta :
成功生成共识序列文件: /home/data/acropora_db/consensus_fasta/AS_ASTUS31_S161.fa
[2024-10-05 17:59:58,417] INFO database_accessor.py extract_consensus_fasta :
检查生成的 FASTA 文件: /home/data/acropora_db/consensus_fasta/AS_ASTUS31_S161.fa
[2024-10-05 17:59:58,417] INFO database_accessor.py execute_cmd :
[cmd] head -n 10 /home/data/acropora_db/consensus_fasta/AS_ASTUS31_S161.fa
[2024-10-05 17:59:58,418] INFO database_accessor.py execute_cmd :
>AS_ASTUS31_S161_2
ACTACAGCCTTATAACTTTGTGGCATGAAGGAACTTAAGCAAAGATGACACCAGAAAACAATGATCTGATTGTTTGATTGAGGAAAAAT
>AS_ASTUS31_S161_30
ATTGAGAGCTATGGATATGAAATTTTTGACATGCGATAACGTTTAGATCAGGGCAGCTGGGCAATGCTCACGCTCATCCGTA
>AS_ASTUS31_S161_49
CGTCTTTTCTTTACTATTGCTGGCAAGATCGCTGTTCACCGTCCTCTTTATTGTGCCGGCATTTTTTTGCCTTACAAACGA
>AS_ASTUS31_S161_73
CCCAAGGATGGACAAGAAATGAAAGGTACTCGGGCATCGGATGGTGAGATACCCGATTGCAAAGCTGCTGGGGTGAACAGGGA
>AS_ASTUS31_S161_196
CCATCGTTTTCGTTTTCGAGCCTGATCGGCCCTTGGTCAGAGCGAAAGATAAAGACCTTACGCCCTAAAAGTCAGCTTTTTT

[2024-10-05 17:59:58,418] INFO database_accessor.py extract_consensus_fasta :
[cmd] zcat /home/data/acropora_db/ustacks/AP_TS1_S1.tags.tsv.gz | awk '{if($3=="consensus") {printf ">AP_TS1_S1_%d\n%s\n", NR, $4}}' > /home/data/acropora_db/consensus_fasta/AP_TS1_S1.fa
[2024-10-05 17:59:58,418] INFO database_accessor.py execute_cmd :
[cmd] zcat /home/data/acropora_db/ustacks/AP_TS1_S1.tags.tsv.gz | awk '{if($3=="consensus") {printf ">AP_TS1_S1_%d\n%s\n", NR, $4}}' > /home/data/acropora_db/consensus_fasta/AP_TS1_S1.fa
[2024-10-05 17:59:58,485] INFO database_accessor.py extract_consensus_fasta :
成功生成共识序列文件: /home/data/acropora_db/consensus_fasta/AP_TS1_S1.fa
[2024-10-05 17:59:58,485] INFO database_accessor.py extract_consensus_fasta :
检查生成的 FASTA 文件: /home/data/acropora_db/consensus_fasta/AP_TS1_S1.fa
[2024-10-05 17:59:58,485] INFO database_accessor.py execute_cmd :
[cmd] head -n 10 /home/data/acropora_db/consensus_fasta/AP_TS1_S1.fa
[2024-10-05 17:59:58,486] INFO database_accessor.py execute_cmd :
>AP_TS1_S1_2
TTGTAACCTGAAACCCATGGAGTTTTCCCCAATTCCAACCCATCGACCATGGCTAGTTCTGGTTCTTTGGGCTTCCAGAAA
>AP_TS1_S1_32
TGGGATTCCTTCAATGCGTTAGCTCGCAGGAGTTCCAGCTCTCGTTCTTTTTGAGCGACTATTTTTTCGTTTTCCAGCTTTCA
>AP_TS1_S1_99
AGTGTTACCATAATAGTTTTTTTTTTAAATCTTGTGAGAGCGATGTTTCTAAAGCCTTTATGCAGAAATGATTTACTTAAAAG
>AP_TS1_S1_273
TTCTGCCACTGTTCCACTAGGGCGAGGCCGGCTCAAATTGGCTTGAAGACTATATACTTGTCTTGTCTCTTCATTTTGTGG
>AP_TS1_S1_314
CTGACTTGGCAGTGTAGCACTCGGAGCTGAACTTATTGAGCCAAACTTACTATAAACTGAGCCATAACCTGATGAATCCAA

[2024-10-05 17:59:58,486] INFO database_accessor.py extract_consensus_fasta :
[cmd] zcat /home/data/acropora_db/ustacks/AM_A-1_S33.tags.tsv.gz | awk '{if($3=="consensus") {printf ">AM_A-1_S33_%d\n%s\n", NR, $4}}' > /home/data/acropora_db/consensus_fasta/AM_A-1_S33.fa
[2024-10-05 17:59:58,486] INFO database_accessor.py execute_cmd :
[cmd] zcat /home/data/acropora_db/ustacks/AM_A-1_S33.tags.tsv.gz | awk '{if($3=="consensus") {printf ">AM_A-1_S33_%d\n%s\n", NR, $4}}' > /home/data/acropora_db/consensus_fasta/AM_A-1_S33.fa
[2024-10-05 17:59:58,512] INFO database_accessor.py extract_consensus_fasta :
成功生成共识序列文件: /home/data/acropora_db/consensus_fasta/AM_A-1_S33.fa
[2024-10-05 17:59:58,512] INFO database_accessor.py extract_consensus_fasta :
检查生成的 FASTA 文件: /home/data/acropora_db/consensus_fasta/AM_A-1_S33.fa
[2024-10-05 17:59:58,512] INFO database_accessor.py execute_cmd :
[cmd] head -n 10 /home/data/acropora_db/consensus_fasta/AM_A-1_S33.fa
[2024-10-05 17:59:58,513] INFO database_accessor.py execute_cmd :
>AM_A-1_S33_2
TCCCAAATAATGTCACCGTAGTCAAAAAGAGGAAGTATTACAGAATGATAAAGTGTCAACCGAGCGTCTAGTGGTAGAAGGT
>AM_A-1_S33_36
CAGTTCAGATGAGAAAGAATGGTTGTTGTATGATGCTGGACCTCGTAGTGTGCGATGTCCCTTAATTTGCTTACCACCAGCCAGTG
>AM_A-1_S33_149
CCCTGATTCCCCTATTAACTCTACAAAATTTGCTGGAAAAATGCCATAGTTGCCATCAGGACCACGTCACCACCACCACGT
>AM_A-1_S33_171
AGTGTTACCATAATAGTTTTTTTTTTTTAATCTTGTGAGAGCGATGTTTCTAAAGCCTTTATGCAGAAATGATTTACTTAAA
>AM_A-1_S33_200
CCGTTGTGGTTGCTTGAGCTCCCTATTTCCTAAATTGTCCAGAGATGCACTAAATTTGAATTTACTAATGACGTCACACACCA

[2024-10-05 17:59:58,513] INFO database_accessor.py extract_consensus_fasta :
[cmd] zcat /home/data/acropora_db/ustacks/AG_GAs11-67_S67.tags.tsv.gz | awk '{if($3=="consensus") {printf ">AG_GAs11-67_S67_%d\n%s\n", NR, $4}}' > /home/data/acropora_db/consensus_fasta/AG_GAs11-67_S67.fa
[2024-10-05 17:59:58,513] INFO database_accessor.py execute_cmd :
[cmd] zcat /home/data/acropora_db/ustacks/AG_GAs11-67_S67.tags.tsv.gz | awk '{if($3=="consensus") {printf ">AG_GAs11-67_S67_%d\n%s\n", NR, $4}}' > /home/data/acropora_db/consensus_fasta/AG_GAs11-67_S67.fa
[2024-10-05 17:59:58,534] INFO database_accessor.py extract_consensus_fasta :
成功生成共识序列文件: /home/data/acropora_db/consensus_fasta/AG_GAs11-67_S67.fa
[2024-10-05 17:59:58,534] INFO database_accessor.py extract_consensus_fasta :
检查生成的 FASTA 文件: /home/data/acropora_db/consensus_fasta/AG_GAs11-67_S67.fa
[2024-10-05 17:59:58,534] INFO database_accessor.py execute_cmd :
[cmd] head -n 10 /home/data/acropora_db/consensus_fasta/AG_GAs11-67_S67.fa
[2024-10-05 17:59:58,535] INFO database_accessor.py execute_cmd :
>AG_GAs11-67_S67_2
ACGAAGTACACGAGCGACACATTCACGGAGATTTTCTTTTGGGCGTGTTACGTGGTTTGTTGCAAGCGCGCGCAGATCTCAAG
>AG_GAs11-67_S67_199
GTCCACTTCGTCAAAATCGTCCAATTCTAGAGCTACACTCGCGGTTTATAATCCCTCTGAATGCTGTTCGACTTCAGAAGCTGA
>AG_GAs11-67_S67_213
TCATGCCTTTTTTGGGAGATGAGAGTCAAAGGACACTCTGTAATAAAAATTATGCACTGGAATGCATATCAGCATTGCCCTACT
>AG_GAs11-67_S67_342
TGCCGTTTTGTGTTTTTTTTTTTATTTTGCCTTAATGCATTGTGTGTAATCACTTGATCAAAGTGATGTATTTAATGATTCT
>AG_GAs11-67_S67_371
CGCTGAAGTTAAACTTTCTTTTCAGGAGTCGTTCAAAATCGCGTTCCAGATCTCGTTCTGGCTCCAAGTCTCGCTCAAGAA

[2024-10-05 17:59:58,535] INFO database_accessor.py logging_title :

######################
#### make blastdb ####
######################
[2024-10-05 17:59:58,535] INFO database_accessor.py make_blastdb :
合并 FASTA 文件到: /home/data/acropora_db/blastdb/merged_consensus.fasta
[2024-10-05 17:59:58,535] INFO database_accessor.py execute_cmd :
[cmd] cat /home/data/acropora_db/consensus_fasta/AS_ASTUS31_S161.fa /home/data/acropora_db/consensus_fasta/AP_TS1_S1.fa /home/data/acropora_db/consensus_fasta/AM_A-1_S33.fa /home/data/acropora_db/consensus_fasta/AG_GAs11-67_S67.fa > /home/data/acropora_db/blastdb/merged_consensus.fasta
[2024-10-05 17:59:58,537] INFO database_accessor.py make_blastdb :
检查合并后的 FASTA 文件格式
[2024-10-05 17:59:58,537] INFO database_accessor.py execute_cmd :
[cmd] head -n 10 /home/data/acropora_db/blastdb/merged_consensus.fasta
[2024-10-05 17:59:58,538] INFO database_accessor.py execute_cmd :
>AS_ASTUS31_S161_2
ACTACAGCCTTATAACTTTGTGGCATGAAGGAACTTAAGCAAAGATGACACCAGAAAACAATGATCTGATTGTTTGATTGAGGAAAAAT
>AS_ASTUS31_S161_30
ATTGAGAGCTATGGATATGAAATTTTTGACATGCGATAACGTTTAGATCAGGGCAGCTGGGCAATGCTCACGCTCATCCGTA
>AS_ASTUS31_S161_49
CGTCTTTTCTTTACTATTGCTGGCAAGATCGCTGTTCACCGTCCTCTTTATTGTGCCGGCATTTTTTTGCCTTACAAACGA
>AS_ASTUS31_S161_73
CCCAAGGATGGACAAGAAATGAAAGGTACTCGGGCATCGGATGGTGAGATACCCGATTGCAAAGCTGCTGGGGTGAACAGGGA
>AS_ASTUS31_S161_196
CCATCGTTTTCGTTTTCGAGCCTGATCGGCCCTTGGTCAGAGCGAAAGATAAAGACCTTACGCCCTAAAAGTCAGCTTTTTT

[2024-10-05 17:59:58,538] INFO database_accessor.py make_blastdb :
创建 BLAST 数据库: /home/data/acropora_db/blastdb/
[2024-10-05 17:59:58,538] INFO database_accessor.py execute_cmd :
[cmd] makeblastdb -in /home/data/acropora_db/blastdb/merged_consensus.fasta -out /home/data/acropora_db/blastdb/ -dbtype nucl -parse_seqids
[2024-10-05 17:59:58,598] INFO database_accessor.py execute_cmd :


Building a new DB, current time: 10/05/2024 17:59:58
New DB name:   /home/data/acropora_db/blastdb
New DB title:  /home/data/acropora_db/blastdb/merged_consensus.fasta
Sequence type: Nucleotide
Deleted existing Nucleotide BLAST database named /home/data/acropora_db/blastdb
Keep MBits: T
Maximum file size: 1000000000B
Adding sequences from FASTA; added 6684 sequences in 0.0385399 seconds.



[2024-10-05 17:59:58,598] ERROR database_accessor.py make_blastdb :
BLAST 数据库创建失败: /home/data/acropora_db/blastdb/
[2024-10-05 17:59:58,598] INFO database_accessor.py run :
处理完成
[2024-10-05 17:59:58,599] INFO ACF.py execute_cmd :
[cmd] cd /home/data/acropora_db/ && tree . > tree.txt
[2024-10-05 17:59:58,603] INFO ACF.py write_analysis_complete_flag :
ANCAT_ANALYSIS_COMPLETED
[2024-10-05 18:01:07,161] INFO database_accessor.py execute_cmd :
[cmd] cp mkdb_acropora.conf /home/data/acropora_db/
[2024-10-05 18:01:07,163] INFO database_accessor.py logging_title :

########################
#### load fastq dir ####
########################
[2024-10-05 18:01:07,164] INFO database_accessor.py logging_title :

#################################
#### quality control : fastq ####
#################################
[2024-10-05 18:01:07,165] INFO database_accessor.py quality_control :
Processing sample: AG_GAs11-67_S67
[2024-10-05 18:01:07,165] INFO database_accessor.py execute_cmd :
[cmd] fastp -i /home/data/acropora/AG_GAs11-67_S67_L001_R1_001.fastq.gz -I /home/data/acropora/AG_GAs11-67_S67_L001_R2_001.fastq.gz -o /home/data/acropora_db/quality_control/AG_GAs11-67_S67_qc_R1.fastq.gz -O /home/data/acropora_db/quality_control/AG_GAs11-67_S67_qc_R2.fastq.gz -q 30 -f 0 -F 15 --cut_right --thread 8 --json /home/data/acropora_db/quality_control/AG_GAs11-67_S67_fastp.json --html /home/data/acropora_db/quality_control/AG_GAs11-67_S67_fastp.html
[2024-10-05 18:01:07,613] INFO database_accessor.py execute_cmd :
Read1 before filtering:
total reads: 82521
total bases: 6601680
Q20 bases: 6416163(97.1899%)
Q30 bases: 6082997(92.1432%)

Read2 before filtering:
total reads: 82521
total bases: 7756974
Q20 bases: 7322026(94.3928%)
Q30 bases: 6779442(87.398%)

Read1 after filtering:
total reads: 79298
total bases: 5996604
Q20 bases: 5914403(98.6292%)
Q30 bases: 5679288(94.7084%)

Read2 after filtering:
total reads: 79298
total bases: 5490991
Q20 bases: 5383923(98.0501%)
Q30 bases: 5084929(92.6049%)

Filtering result:
reads passed filter: 158596
reads failed due to low quality: 2226
reads failed due to too many N: 0
reads failed due to too short: 4220
reads with adapter trimmed: 15980
bases trimmed due to adapters: 278157

Duplication rate: 41.8899%

Insert size peak (evaluated by paired-end reads): 64

JSON report: /home/data/acropora_db/quality_control/AG_GAs11-67_S67_fastp.json
HTML report: /home/data/acropora_db/quality_control/AG_GAs11-67_S67_fastp.html

fastp -i /home/data/acropora/AG_GAs11-67_S67_L001_R1_001.fastq.gz -I /home/data/acropora/AG_GAs11-67_S67_L001_R2_001.fastq.gz -o /home/data/acropora_db/quality_control/AG_GAs11-67_S67_qc_R1.fastq.gz -O /home/data/acropora_db/quality_control/AG_GAs11-67_S67_qc_R2.fastq.gz -q 30 -f 0 -F 15 --cut_right --thread 8 --json /home/data/acropora_db/quality_control/AG_GAs11-67_S67_fastp.json --html /home/data/acropora_db/quality_control/AG_GAs11-67_S67_fastp.html 
fastp v0.23.4, time used: 0 seconds

[2024-10-05 18:01:07,613] WARNING database_accessor.py quality_control :
fastp for AG_GAs11-67_S67 produced warnings: Read1 before filtering:
total reads: 82521
total bases: 6601680
Q20 bases: 6416163(97.1899%)
Q30 bases: 6082997(92.1432%)

Read2 before filtering:
total reads: 82521
total bases: 7756974
Q20 bases: 7322026(94.3928%)
Q30 bases: 6779442(87.398%)

Read1 after filtering:
total reads: 79298
total bases: 5996604
Q20 bases: 5914403(98.6292%)
Q30 bases: 5679288(94.7084%)

Read2 after filtering:
total reads: 79298
total bases: 5490991
Q20 bases: 5383923(98.0501%)
Q30 bases: 5084929(92.6049%)

Filtering result:
reads passed filter: 158596
reads failed due to low quality: 2226
reads failed due to too many N: 0
reads failed due to too short: 4220
reads with adapter trimmed: 15980
bases trimmed due to adapters: 278157

Duplication rate: 41.8899%

Insert size peak (evaluated by paired-end reads): 64

JSON report: /home/data/acropora_db/quality_control/AG_GAs11-67_S67_fastp.json
HTML report: /home/data/acropora_db/quality_control/AG_GAs11-67_S67_fastp.html

fastp -i /home/data/acropora/AG_GAs11-67_S67_L001_R1_001.fastq.gz -I /home/data/acropora/AG_GAs11-67_S67_L001_R2_001.fastq.gz -o /home/data/acropora_db/quality_control/AG_GAs11-67_S67_qc_R1.fastq.gz -O /home/data/acropora_db/quality_control/AG_GAs11-67_S67_qc_R2.fastq.gz -q 30 -f 0 -F 15 --cut_right --thread 8 --json /home/data/acropora_db/quality_control/AG_GAs11-67_S67_fastp.json --html /home/data/acropora_db/quality_control/AG_GAs11-67_S67_fastp.html 
fastp v0.23.4, time used: 0 seconds

[2024-10-05 18:01:07,613] INFO database_accessor.py quality_control :
Finished processing sample: AG_GAs11-67_S67
[2024-10-05 18:01:07,613] INFO database_accessor.py quality_control :
Processing sample: AP_TS1_S1
[2024-10-05 18:01:07,614] INFO database_accessor.py execute_cmd :
[cmd] fastp -i /home/data/acropora/AP_TS1_S1_L001_R1_001.fastq.gz -I /home/data/acropora/AP_TS1_S1_L001_R2_001.fastq.gz -o /home/data/acropora_db/quality_control/AP_TS1_S1_qc_R1.fastq.gz -O /home/data/acropora_db/quality_control/AP_TS1_S1_qc_R2.fastq.gz -q 30 -f 0 -F 15 --cut_right --thread 8 --json /home/data/acropora_db/quality_control/AP_TS1_S1_fastp.json --html /home/data/acropora_db/quality_control/AP_TS1_S1_fastp.html
[2024-10-05 18:01:08,362] INFO database_accessor.py execute_cmd :
Read1 before filtering:
total reads: 248601
total bases: 19888080
Q20 bases: 19480257(97.9494%)
Q30 bases: 18588142(93.4637%)

Read2 before filtering:
total reads: 248601
total bases: 23617095
Q20 bases: 22812090(96.5914%)
Q30 bases: 21475937(90.9339%)

Read1 after filtering:
total reads: 231712
total bases: 17580299
Q20 bases: 17414800(99.0586%)
Q30 bases: 16830589(95.7355%)

Read2 after filtering:
total reads: 231712
total bases: 16739640
Q20 bases: 16514648(98.6559%)
Q30 bases: 15824490(94.533%)

Filtering result:
reads passed filter: 463424
reads failed due to low quality: 12162
reads failed due to too many N: 0
reads failed due to too short: 21616
reads with adapter trimmed: 99544
bases trimmed due to adapters: 1530502

Duplication rate: 64.4881%

Insert size peak (evaluated by paired-end reads): 71

JSON report: /home/data/acropora_db/quality_control/AP_TS1_S1_fastp.json
HTML report: /home/data/acropora_db/quality_control/AP_TS1_S1_fastp.html

fastp -i /home/data/acropora/AP_TS1_S1_L001_R1_001.fastq.gz -I /home/data/acropora/AP_TS1_S1_L001_R2_001.fastq.gz -o /home/data/acropora_db/quality_control/AP_TS1_S1_qc_R1.fastq.gz -O /home/data/acropora_db/quality_control/AP_TS1_S1_qc_R2.fastq.gz -q 30 -f 0 -F 15 --cut_right --thread 8 --json /home/data/acropora_db/quality_control/AP_TS1_S1_fastp.json --html /home/data/acropora_db/quality_control/AP_TS1_S1_fastp.html 
fastp v0.23.4, time used: 1 seconds

[2024-10-05 18:01:08,362] WARNING database_accessor.py quality_control :
fastp for AP_TS1_S1 produced warnings: Read1 before filtering:
total reads: 248601
total bases: 19888080
Q20 bases: 19480257(97.9494%)
Q30 bases: 18588142(93.4637%)

Read2 before filtering:
total reads: 248601
total bases: 23617095
Q20 bases: 22812090(96.5914%)
Q30 bases: 21475937(90.9339%)

Read1 after filtering:
total reads: 231712
total bases: 17580299
Q20 bases: 17414800(99.0586%)
Q30 bases: 16830589(95.7355%)

Read2 after filtering:
total reads: 231712
total bases: 16739640
Q20 bases: 16514648(98.6559%)
Q30 bases: 15824490(94.533%)

Filtering result:
reads passed filter: 463424
reads failed due to low quality: 12162
reads failed due to too many N: 0
reads failed due to too short: 21616
reads with adapter trimmed: 99544
bases trimmed due to adapters: 1530502

Duplication rate: 64.4881%

Insert size peak (evaluated by paired-end reads): 71

JSON report: /home/data/acropora_db/quality_control/AP_TS1_S1_fastp.json
HTML report: /home/data/acropora_db/quality_control/AP_TS1_S1_fastp.html

fastp -i /home/data/acropora/AP_TS1_S1_L001_R1_001.fastq.gz -I /home/data/acropora/AP_TS1_S1_L001_R2_001.fastq.gz -o /home/data/acropora_db/quality_control/AP_TS1_S1_qc_R1.fastq.gz -O /home/data/acropora_db/quality_control/AP_TS1_S1_qc_R2.fastq.gz -q 30 -f 0 -F 15 --cut_right --thread 8 --json /home/data/acropora_db/quality_control/AP_TS1_S1_fastp.json --html /home/data/acropora_db/quality_control/AP_TS1_S1_fastp.html 
fastp v0.23.4, time used: 1 seconds

[2024-10-05 18:01:08,362] INFO database_accessor.py quality_control :
Finished processing sample: AP_TS1_S1
[2024-10-05 18:01:08,362] INFO database_accessor.py quality_control :
Processing sample: AS_ASTUS31_S161
[2024-10-05 18:01:08,363] INFO database_accessor.py execute_cmd :
[cmd] fastp -i /home/data/acropora/AS_ASTUS31_S161_L001_R1_001.fastq.gz -I /home/data/acropora/AS_ASTUS31_S161_L001_R2_001.fastq.gz -o /home/data/acropora_db/quality_control/AS_ASTUS31_S161_qc_R1.fastq.gz -O /home/data/acropora_db/quality_control/AS_ASTUS31_S161_qc_R2.fastq.gz -q 30 -f 0 -F 15 --cut_right --thread 8 --json /home/data/acropora_db/quality_control/AS_ASTUS31_S161_fastp.json --html /home/data/acropora_db/quality_control/AS_ASTUS31_S161_fastp.html
[2024-10-05 18:01:08,971] INFO database_accessor.py execute_cmd :
Read1 before filtering:
total reads: 162226
total bases: 12978080
Q20 bases: 12762049(98.3354%)
Q30 bases: 12317675(94.9114%)

Read2 before filtering:
total reads: 162226
total bases: 15249244
Q20 bases: 14935119(97.9401%)
Q30 bases: 14342176(94.0517%)

Read1 after filtering:
total reads: 158521
total bases: 12084495
Q20 bases: 11964325(99.0056%)
Q30 bases: 11633921(96.2715%)

Read2 after filtering:
total reads: 158521
total bases: 11411898
Q20 bases: 11287906(98.9135%)
Q30 bases: 10913654(95.634%)

Filtering result:
reads passed filter: 317042
reads failed due to low quality: 2624
reads failed due to too many N: 0
reads failed due to too short: 4786
reads with adapter trimmed: 58926
bases trimmed due to adapters: 1142077

Duplication rate: 56.3621%

Insert size peak (evaluated by paired-end reads): 95

JSON report: /home/data/acropora_db/quality_control/AS_ASTUS31_S161_fastp.json
HTML report: /home/data/acropora_db/quality_control/AS_ASTUS31_S161_fastp.html

fastp -i /home/data/acropora/AS_ASTUS31_S161_L001_R1_001.fastq.gz -I /home/data/acropora/AS_ASTUS31_S161_L001_R2_001.fastq.gz -o /home/data/acropora_db/quality_control/AS_ASTUS31_S161_qc_R1.fastq.gz -O /home/data/acropora_db/quality_control/AS_ASTUS31_S161_qc_R2.fastq.gz -q 30 -f 0 -F 15 --cut_right --thread 8 --json /home/data/acropora_db/quality_control/AS_ASTUS31_S161_fastp.json --html /home/data/acropora_db/quality_control/AS_ASTUS31_S161_fastp.html 
fastp v0.23.4, time used: 0 seconds

[2024-10-05 18:01:08,971] WARNING database_accessor.py quality_control :
fastp for AS_ASTUS31_S161 produced warnings: Read1 before filtering:
total reads: 162226
total bases: 12978080
Q20 bases: 12762049(98.3354%)
Q30 bases: 12317675(94.9114%)

Read2 before filtering:
total reads: 162226
total bases: 15249244
Q20 bases: 14935119(97.9401%)
Q30 bases: 14342176(94.0517%)

Read1 after filtering:
total reads: 158521
total bases: 12084495
Q20 bases: 11964325(99.0056%)
Q30 bases: 11633921(96.2715%)

Read2 after filtering:
total reads: 158521
total bases: 11411898
Q20 bases: 11287906(98.9135%)
Q30 bases: 10913654(95.634%)

Filtering result:
reads passed filter: 317042
reads failed due to low quality: 2624
reads failed due to too many N: 0
reads failed due to too short: 4786
reads with adapter trimmed: 58926
bases trimmed due to adapters: 1142077

Duplication rate: 56.3621%

Insert size peak (evaluated by paired-end reads): 95

JSON report: /home/data/acropora_db/quality_control/AS_ASTUS31_S161_fastp.json
HTML report: /home/data/acropora_db/quality_control/AS_ASTUS31_S161_fastp.html

fastp -i /home/data/acropora/AS_ASTUS31_S161_L001_R1_001.fastq.gz -I /home/data/acropora/AS_ASTUS31_S161_L001_R2_001.fastq.gz -o /home/data/acropora_db/quality_control/AS_ASTUS31_S161_qc_R1.fastq.gz -O /home/data/acropora_db/quality_control/AS_ASTUS31_S161_qc_R2.fastq.gz -q 30 -f 0 -F 15 --cut_right --thread 8 --json /home/data/acropora_db/quality_control/AS_ASTUS31_S161_fastp.json --html /home/data/acropora_db/quality_control/AS_ASTUS31_S161_fastp.html 
fastp v0.23.4, time used: 0 seconds

[2024-10-05 18:01:08,972] INFO database_accessor.py quality_control :
Finished processing sample: AS_ASTUS31_S161
[2024-10-05 18:01:08,972] INFO database_accessor.py quality_control :
Processing sample: AM_A-1_S33
[2024-10-05 18:01:08,972] INFO database_accessor.py execute_cmd :
[cmd] fastp -i /home/data/acropora/AM_A-1_S33_L001_R1_001.fastq.gz -I /home/data/acropora/AM_A-1_S33_L001_R2_001.fastq.gz -o /home/data/acropora_db/quality_control/AM_A-1_S33_qc_R1.fastq.gz -O /home/data/acropora_db/quality_control/AM_A-1_S33_qc_R2.fastq.gz -q 30 -f 0 -F 15 --cut_right --thread 8 --json /home/data/acropora_db/quality_control/AM_A-1_S33_fastp.json --html /home/data/acropora_db/quality_control/AM_A-1_S33_fastp.html
[2024-10-05 18:01:09,391] INFO database_accessor.py execute_cmd :
Read1 before filtering:
total reads: 97107
total bases: 7768560
Q20 bases: 7647822(98.4458%)
Q30 bases: 7362598(94.7743%)

Read2 before filtering:
total reads: 97107
total bases: 9128058
Q20 bases: 8907264(97.5812%)
Q30 bases: 8496983(93.0864%)

Read1 after filtering:
total reads: 93866
total bases: 7066298
Q20 bases: 7008421(99.1809%)
Q30 bases: 6804930(96.3012%)

Read2 after filtering:
total reads: 93866
total bases: 6587867
Q20 bases: 6517391(98.9302%)
Q30 bases: 6285324(95.4076%)

Filtering result:
reads passed filter: 187732
reads failed due to low quality: 2370
reads failed due to too many N: 0
reads failed due to too short: 4112
reads with adapter trimmed: 50244
bases trimmed due to adapters: 883198

Duplication rate: 53.0343%

Insert size peak (evaluated by paired-end reads): 57

JSON report: /home/data/acropora_db/quality_control/AM_A-1_S33_fastp.json
HTML report: /home/data/acropora_db/quality_control/AM_A-1_S33_fastp.html

fastp -i /home/data/acropora/AM_A-1_S33_L001_R1_001.fastq.gz -I /home/data/acropora/AM_A-1_S33_L001_R2_001.fastq.gz -o /home/data/acropora_db/quality_control/AM_A-1_S33_qc_R1.fastq.gz -O /home/data/acropora_db/quality_control/AM_A-1_S33_qc_R2.fastq.gz -q 30 -f 0 -F 15 --cut_right --thread 8 --json /home/data/acropora_db/quality_control/AM_A-1_S33_fastp.json --html /home/data/acropora_db/quality_control/AM_A-1_S33_fastp.html 
fastp v0.23.4, time used: 1 seconds

[2024-10-05 18:01:09,391] WARNING database_accessor.py quality_control :
fastp for AM_A-1_S33 produced warnings: Read1 before filtering:
total reads: 97107
total bases: 7768560
Q20 bases: 7647822(98.4458%)
Q30 bases: 7362598(94.7743%)

Read2 before filtering:
total reads: 97107
total bases: 9128058
Q20 bases: 8907264(97.5812%)
Q30 bases: 8496983(93.0864%)

Read1 after filtering:
total reads: 93866
total bases: 7066298
Q20 bases: 7008421(99.1809%)
Q30 bases: 6804930(96.3012%)

Read2 after filtering:
total reads: 93866
total bases: 6587867
Q20 bases: 6517391(98.9302%)
Q30 bases: 6285324(95.4076%)

Filtering result:
reads passed filter: 187732
reads failed due to low quality: 2370
reads failed due to too many N: 0
reads failed due to too short: 4112
reads with adapter trimmed: 50244
bases trimmed due to adapters: 883198

Duplication rate: 53.0343%

Insert size peak (evaluated by paired-end reads): 57

JSON report: /home/data/acropora_db/quality_control/AM_A-1_S33_fastp.json
HTML report: /home/data/acropora_db/quality_control/AM_A-1_S33_fastp.html

fastp -i /home/data/acropora/AM_A-1_S33_L001_R1_001.fastq.gz -I /home/data/acropora/AM_A-1_S33_L001_R2_001.fastq.gz -o /home/data/acropora_db/quality_control/AM_A-1_S33_qc_R1.fastq.gz -O /home/data/acropora_db/quality_control/AM_A-1_S33_qc_R2.fastq.gz -q 30 -f 0 -F 15 --cut_right --thread 8 --json /home/data/acropora_db/quality_control/AM_A-1_S33_fastp.json --html /home/data/acropora_db/quality_control/AM_A-1_S33_fastp.html 
fastp v0.23.4, time used: 1 seconds

[2024-10-05 18:01:09,391] INFO database_accessor.py quality_control :
Finished processing sample: AM_A-1_S33
[2024-10-05 18:01:09,391] INFO database_accessor.py quality_control :
Quality control completed for all samples
[2024-10-05 18:01:09,391] INFO database_accessor.py logging_title :

####################
#### 接头修剪：fastq ####
####################
[2024-10-05 18:01:09,391] INFO database_accessor.py execute_cmd :
[cmd] fastp -i /home/data/acropora_db/quality_control/AG_GAs11-67_S67_qc_R1.fastq.gz -I /home/data/acropora_db/quality_control/AG_GAs11-67_S67_qc_R2.fastq.gz -o /home/data/acropora_db/adapter_trim/AG_GAs11-67_S67_at_R1.fastq.gz -O /home/data/acropora_db/adapter_trim/AG_GAs11-67_S67_at_R2.fastq.gz --adapter_sequence GTCAGATCGGAAGAGCACACGTCTGAACTCCAGTCAC --adapter_sequence_r2 CAGAGATCGGAAGAGCGTCGTGTAGGGAAAGAC --cut_right --cut_window_size 4 --cut_mean_quality 20 --length_required 36 --length_limit 150 --average_qual 19 --thread 8 --json /home/data/acropora_db/adapter_trim/AG_GAs11-67_S67_fastp.json --html /home/data/acropora_db/adapter_trim/AG_GAs11-67_S67_fastp.html
[2024-10-05 18:01:09,779] INFO database_accessor.py execute_cmd :
Read1 before filtering:
total reads: 79298
total bases: 5996604
Q20 bases: 5914403(98.6292%)
Q30 bases: 5679288(94.7084%)

Read2 before filtering:
total reads: 79298
total bases: 5490991
Q20 bases: 5383923(98.0501%)
Q30 bases: 5084929(92.6049%)

Read1 after filtering:
total reads: 51622
total bases: 3958367
Q20 bases: 3921935(99.0796%)
Q30 bases: 3800062(96.0007%)

Read2 after filtering:
total reads: 51622
total bases: 3772927
Q20 bases: 3718987(98.5703%)
Q30 bases: 3556932(94.2751%)

Filtering result:
reads passed filter: 103244
reads failed due to low quality: 0
reads failed due to too many N: 0
reads failed due to too short: 55352
reads failed due to too long: 0
reads with adapter trimmed: 51133
bases trimmed due to adapters: 2655651

Duplication rate: 46.0642%

Insert size peak (evaluated by paired-end reads): 49

JSON report: /home/data/acropora_db/adapter_trim/AG_GAs11-67_S67_fastp.json
HTML report: /home/data/acropora_db/adapter_trim/AG_GAs11-67_S67_fastp.html

fastp -i /home/data/acropora_db/quality_control/AG_GAs11-67_S67_qc_R1.fastq.gz -I /home/data/acropora_db/quality_control/AG_GAs11-67_S67_qc_R2.fastq.gz -o /home/data/acropora_db/adapter_trim/AG_GAs11-67_S67_at_R1.fastq.gz -O /home/data/acropora_db/adapter_trim/AG_GAs11-67_S67_at_R2.fastq.gz --adapter_sequence GTCAGATCGGAAGAGCACACGTCTGAACTCCAGTCAC --adapter_sequence_r2 CAGAGATCGGAAGAGCGTCGTGTAGGGAAAGAC --cut_right --cut_window_size 4 --cut_mean_quality 20 --length_required 36 --length_limit 150 --average_qual 19 --thread 8 --json /home/data/acropora_db/adapter_trim/AG_GAs11-67_S67_fastp.json --html /home/data/acropora_db/adapter_trim/AG_GAs11-67_S67_fastp.html 
fastp v0.23.4, time used: 0 seconds

[2024-10-05 18:01:09,779] INFO database_accessor.py execute_cmd :
[cmd] fastp -i /home/data/acropora_db/quality_control/AP_TS1_S1_qc_R1.fastq.gz -I /home/data/acropora_db/quality_control/AP_TS1_S1_qc_R2.fastq.gz -o /home/data/acropora_db/adapter_trim/AP_TS1_S1_at_R1.fastq.gz -O /home/data/acropora_db/adapter_trim/AP_TS1_S1_at_R2.fastq.gz --adapter_sequence GTCAGATCGGAAGAGCACACGTCTGAACTCCAGTCAC --adapter_sequence_r2 CAGAGATCGGAAGAGCGTCGTGTAGGGAAAGAC --cut_right --cut_window_size 4 --cut_mean_quality 20 --length_required 36 --length_limit 150 --average_qual 19 --thread 8 --json /home/data/acropora_db/adapter_trim/AP_TS1_S1_fastp.json --html /home/data/acropora_db/adapter_trim/AP_TS1_S1_fastp.html
[2024-10-05 18:01:10,347] INFO database_accessor.py execute_cmd :
Read1 before filtering:
total reads: 231712
total bases: 17580299
Q20 bases: 17414800(99.0586%)
Q30 bases: 16830589(95.7355%)

Read2 before filtering:
total reads: 231712
total bases: 16739640
Q20 bases: 16514648(98.6559%)
Q30 bases: 15824490(94.533%)

Read1 after filtering:
total reads: 119529
total bases: 8749001
Q20 bases: 8688635(99.31%)
Q30 bases: 8447878(96.5582%)

Read2 after filtering:
total reads: 119529
total bases: 8129678
Q20 bases: 8057783(99.1156%)
Q30 bases: 7796800(95.9054%)

Filtering result:
reads passed filter: 239058
reads failed due to low quality: 20
reads failed due to too many N: 0
reads failed due to too short: 224346
reads failed due to too long: 0
reads with adapter trimmed: 223016
bases trimmed due to adapters: 11817632

Duplication rate: 68.6382%

Insert size peak (evaluated by paired-end reads): 56

JSON report: /home/data/acropora_db/adapter_trim/AP_TS1_S1_fastp.json
HTML report: /home/data/acropora_db/adapter_trim/AP_TS1_S1_fastp.html

fastp -i /home/data/acropora_db/quality_control/AP_TS1_S1_qc_R1.fastq.gz -I /home/data/acropora_db/quality_control/AP_TS1_S1_qc_R2.fastq.gz -o /home/data/acropora_db/adapter_trim/AP_TS1_S1_at_R1.fastq.gz -O /home/data/acropora_db/adapter_trim/AP_TS1_S1_at_R2.fastq.gz --adapter_sequence GTCAGATCGGAAGAGCACACGTCTGAACTCCAGTCAC --adapter_sequence_r2 CAGAGATCGGAAGAGCGTCGTGTAGGGAAAGAC --cut_right --cut_window_size 4 --cut_mean_quality 20 --length_required 36 --length_limit 150 --average_qual 19 --thread 8 --json /home/data/acropora_db/adapter_trim/AP_TS1_S1_fastp.json --html /home/data/acropora_db/adapter_trim/AP_TS1_S1_fastp.html 
fastp v0.23.4, time used: 1 seconds

[2024-10-05 18:01:10,347] INFO database_accessor.py execute_cmd :
[cmd] fastp -i /home/data/acropora_db/quality_control/AS_ASTUS31_S161_qc_R1.fastq.gz -I /home/data/acropora_db/quality_control/AS_ASTUS31_S161_qc_R2.fastq.gz -o /home/data/acropora_db/adapter_trim/AS_ASTUS31_S161_at_R1.fastq.gz -O /home/data/acropora_db/adapter_trim/AS_ASTUS31_S161_at_R2.fastq.gz --adapter_sequence GTCAGATCGGAAGAGCACACGTCTGAACTCCAGTCAC --adapter_sequence_r2 CAGAGATCGGAAGAGCGTCGTGTAGGGAAAGAC --cut_right --cut_window_size 4 --cut_mean_quality 20 --length_required 36 --length_limit 150 --average_qual 19 --thread 8 --json /home/data/acropora_db/adapter_trim/AS_ASTUS31_S161_fastp.json --html /home/data/acropora_db/adapter_trim/AS_ASTUS31_S161_fastp.html
[2024-10-05 18:01:10,846] INFO database_accessor.py execute_cmd :
Read1 before filtering:
total reads: 158521
total bases: 12084495
Q20 bases: 11964325(99.0056%)
Q30 bases: 11633921(96.2715%)

Read2 before filtering:
total reads: 158521
total bases: 11411898
Q20 bases: 11287906(98.9135%)
Q30 bases: 10913654(95.634%)

Read1 after filtering:
total reads: 79051
total bases: 5841951
Q20 bases: 5798389(99.2543%)
Q30 bases: 5670180(97.0597%)

Read2 after filtering:
total reads: 79051
total bases: 5438862
Q20 bases: 5399343(99.2734%)
Q30 bases: 5262418(96.7559%)

Filtering result:
reads passed filter: 158102
reads failed due to low quality: 0
reads failed due to too many N: 0
reads failed due to too short: 158940
reads failed due to too long: 0
reads with adapter trimmed: 154518
bases trimmed due to adapters: 8207681

Duplication rate: 58.0768%

Insert size peak (evaluated by paired-end reads): 80

JSON report: /home/data/acropora_db/adapter_trim/AS_ASTUS31_S161_fastp.json
HTML report: /home/data/acropora_db/adapter_trim/AS_ASTUS31_S161_fastp.html

fastp -i /home/data/acropora_db/quality_control/AS_ASTUS31_S161_qc_R1.fastq.gz -I /home/data/acropora_db/quality_control/AS_ASTUS31_S161_qc_R2.fastq.gz -o /home/data/acropora_db/adapter_trim/AS_ASTUS31_S161_at_R1.fastq.gz -O /home/data/acropora_db/adapter_trim/AS_ASTUS31_S161_at_R2.fastq.gz --adapter_sequence GTCAGATCGGAAGAGCACACGTCTGAACTCCAGTCAC --adapter_sequence_r2 CAGAGATCGGAAGAGCGTCGTGTAGGGAAAGAC --cut_right --cut_window_size 4 --cut_mean_quality 20 --length_required 36 --length_limit 150 --average_qual 19 --thread 8 --json /home/data/acropora_db/adapter_trim/AS_ASTUS31_S161_fastp.json --html /home/data/acropora_db/adapter_trim/AS_ASTUS31_S161_fastp.html 
fastp v0.23.4, time used: 0 seconds

[2024-10-05 18:01:10,846] INFO database_accessor.py execute_cmd :
[cmd] fastp -i /home/data/acropora_db/quality_control/AM_A-1_S33_qc_R1.fastq.gz -I /home/data/acropora_db/quality_control/AM_A-1_S33_qc_R2.fastq.gz -o /home/data/acropora_db/adapter_trim/AM_A-1_S33_at_R1.fastq.gz -O /home/data/acropora_db/adapter_trim/AM_A-1_S33_at_R2.fastq.gz --adapter_sequence GTCAGATCGGAAGAGCACACGTCTGAACTCCAGTCAC --adapter_sequence_r2 CAGAGATCGGAAGAGCGTCGTGTAGGGAAAGAC --cut_right --cut_window_size 4 --cut_mean_quality 20 --length_required 36 --length_limit 150 --average_qual 19 --thread 8 --json /home/data/acropora_db/adapter_trim/AM_A-1_S33_fastp.json --html /home/data/acropora_db/adapter_trim/AM_A-1_S33_fastp.html
[2024-10-05 18:01:11,257] INFO database_accessor.py execute_cmd :
Read1 before filtering:
total reads: 93866
total bases: 7066298
Q20 bases: 7008421(99.1809%)
Q30 bases: 6804930(96.3012%)

Read2 before filtering:
total reads: 93866
total bases: 6587867
Q20 bases: 6517391(98.9302%)
Q30 bases: 6285324(95.4076%)

Read1 after filtering:
total reads: 70057
total bases: 5238507
Q20 bases: 5207195(99.4023%)
Q30 bases: 5082504(97.022%)

Read2 after filtering:
total reads: 70057
total bases: 4876236
Q20 bases: 4840109(99.2591%)
Q30 bases: 4707250(96.5345%)

Filtering result:
reads passed filter: 140114
reads failed due to low quality: 2
reads failed due to too many N: 0
reads failed due to too short: 47616
reads failed due to too long: 0
reads with adapter trimmed: 44894
bases trimmed due to adapters: 2404472

Duplication rate: 56.4027%

Insert size peak (evaluated by paired-end reads): 42

JSON report: /home/data/acropora_db/adapter_trim/AM_A-1_S33_fastp.json
HTML report: /home/data/acropora_db/adapter_trim/AM_A-1_S33_fastp.html

fastp -i /home/data/acropora_db/quality_control/AM_A-1_S33_qc_R1.fastq.gz -I /home/data/acropora_db/quality_control/AM_A-1_S33_qc_R2.fastq.gz -o /home/data/acropora_db/adapter_trim/AM_A-1_S33_at_R1.fastq.gz -O /home/data/acropora_db/adapter_trim/AM_A-1_S33_at_R2.fastq.gz --adapter_sequence GTCAGATCGGAAGAGCACACGTCTGAACTCCAGTCAC --adapter_sequence_r2 CAGAGATCGGAAGAGCGTCGTGTAGGGAAAGAC --cut_right --cut_window_size 4 --cut_mean_quality 20 --length_required 36 --length_limit 150 --average_qual 19 --thread 8 --json /home/data/acropora_db/adapter_trim/AM_A-1_S33_fastp.json --html /home/data/acropora_db/adapter_trim/AM_A-1_S33_fastp.html 
fastp v0.23.4, time used: 1 seconds

[2024-10-05 18:01:11,257] INFO database_accessor.py adapter_trim :
所有样本的接头修剪已完成
[2024-10-05 18:01:11,257] INFO database_accessor.py logging_title :

#########################
#### fastq 转换为 fasta ####
#########################
[2024-10-05 18:01:11,258] INFO database_accessor.py execute_cmd :
[cmd] seqkit fq2fa -o /home/data/acropora_db/fasta/AG_GAs11-67_S67.fasta.gz /home/data/acropora_db/adapter_trim/AG_GAs11-67_S67_at_R1.fastq.gz /home/data/acropora_db/adapter_trim/AG_GAs11-67_S67_at_R2.fastq.gz
[2024-10-05 18:01:11,367] INFO database_accessor.py execute_cmd :
[cmd] seqkit fq2fa -o /home/data/acropora_db/fasta/AP_TS1_S1.fasta.gz /home/data/acropora_db/adapter_trim/AP_TS1_S1_at_R1.fastq.gz /home/data/acropora_db/adapter_trim/AP_TS1_S1_at_R2.fastq.gz
[2024-10-05 18:01:11,712] INFO database_accessor.py execute_cmd :
[cmd] seqkit fq2fa -o /home/data/acropora_db/fasta/AS_ASTUS31_S161.fasta.gz /home/data/acropora_db/adapter_trim/AS_ASTUS31_S161_at_R1.fastq.gz /home/data/acropora_db/adapter_trim/AS_ASTUS31_S161_at_R2.fastq.gz
[2024-10-05 18:01:11,960] INFO database_accessor.py execute_cmd :
[cmd] seqkit fq2fa -o /home/data/acropora_db/fasta/AM_A-1_S33.fasta.gz /home/data/acropora_db/adapter_trim/AM_A-1_S33_at_R1.fastq.gz /home/data/acropora_db/adapter_trim/AM_A-1_S33_at_R2.fastq.gz
[2024-10-05 18:01:12,101] INFO database_accessor.py fastq_to_fasta :
所有样本的 FASTQ 到 FASTA 转换已完成
[2024-10-05 18:01:12,101] INFO database_accessor.py execute_cmd :
[cmd] seqkit seq -m 80 -M 80 /home/data/acropora_db/fasta/AG_GAs11-67_S67.fasta.gz | gzip > /home/data/acropora_db/fasta/AG_GAs11-67_S67_uniform.fasta.gz
[2024-10-05 18:01:12,491] INFO database_accessor.py execute_cmd :
[33m[WARN][0m you may switch on flag -g/--remove-gaps to remove spaces

[2024-10-05 18:01:12,491] INFO database_accessor.py execute_cmd :
[cmd] seqkit seq -m 80 -M 80 /home/data/acropora_db/fasta/AP_TS1_S1.fasta.gz | gzip > /home/data/acropora_db/fasta/AP_TS1_S1_uniform.fasta.gz
[2024-10-05 18:01:13,398] INFO database_accessor.py execute_cmd :
[33m[WARN][0m you may switch on flag -g/--remove-gaps to remove spaces

[2024-10-05 18:01:13,398] INFO database_accessor.py execute_cmd :
[cmd] seqkit seq -m 80 -M 80 /home/data/acropora_db/fasta/AS_ASTUS31_S161.fasta.gz | gzip > /home/data/acropora_db/fasta/AS_ASTUS31_S161_uniform.fasta.gz
[2024-10-05 18:01:13,906] INFO database_accessor.py execute_cmd :
[33m[WARN][0m you may switch on flag -g/--remove-gaps to remove spaces

[2024-10-05 18:01:13,906] INFO database_accessor.py execute_cmd :
[cmd] seqkit seq -m 80 -M 80 /home/data/acropora_db/fasta/AM_A-1_S33.fasta.gz | gzip > /home/data/acropora_db/fasta/AM_A-1_S33_uniform.fasta.gz
[2024-10-05 18:01:14,375] INFO database_accessor.py execute_cmd :
[33m[WARN][0m you may switch on flag -g/--remove-gaps to remove spaces

[2024-10-05 18:01:14,375] INFO database_accessor.py logging_title :

#################
#### ustacks ####
#################
[2024-10-05 18:01:14,376] INFO database_accessor.py stacks :
Running ustacks for sample: AG_GAs11-67_S67
[2024-10-05 18:01:14,376] INFO database_accessor.py stacks :
Command: ustacks -f /home/data/acropora_db/fasta/AG_GAs11-67_S67_uniform.fasta.gz -o /home/data/acropora_db/ustacks --name AG_GAs11-67_S67 -i 1 -m 3 -M 2 -p 8
[2024-10-05 18:01:14,376] INFO database_accessor.py execute_cmd :
[cmd] ustacks -f /home/data/acropora_db/fasta/AG_GAs11-67_S67_uniform.fasta.gz -o /home/data/acropora_db/ustacks --name AG_GAs11-67_S67 -i 1 -m 3 -M 2 -p 8
[2024-10-05 18:01:14,835] INFO database_accessor.py execute_cmd :
ustacks parameters selected:
  Input file: '/home/data/acropora_db/fasta/AG_GAs11-67_S67_uniform.fasta.gz'
  Sample ID: 1
  Min depth of coverage to create a stack (m): 3
  Repeat removal algorithm: enabled
  Max distance allowed between stacks (M): 2
  Max distance allowed to align secondary reads: 4
  Max number of stacks allowed per de novo locus: 3
  Deleveraging algorithm: disabled
  Gapped assembly: enabled
  Minimum alignment length: 0.8
  Model type: SNP
  Alpha significance level for model: 0.05

Loading RAD-Tags...
Warning: Input reads contained 1 uncalled nucleotides.

Loaded 42595 reads; formed:
  1734 stacks representing 29473 primary reads (69.2%)
  11868 secondary stacks representing 13122 secondary reads (30.8%)

Stack coverage: mean=17.00; stdev=60.60; max=1955; n_reads=29473(69.2%)
Removing repetitive stacks: cov > 199 (mean+3*stdev)...
  Blacklisted 121 stacks.
Coverage after repeat removal: mean=13.16; stdev=21.91; max=190; n_reads=21222(49.8%)

Assembling stacks (max. dist. M=2)...
  Assembled 1613 stacks into 1408; blacklisted 17 stacks.
Coverage after assembling stacks: mean=13.95; stdev=22.82; max=194; n_reads=19161(45.0%)

Merging secondary stacks (max. dist. N=4 from consensus)...
  Merged 4822 out of 13122 secondary reads (36.7%), 638 merged with gapped alignments.
Coverage after merging secondary stacks: mean=17.45; stdev=27.76; max=227; n_reads=23983(56.3%)

Assembling stacks, allowing for gaps (min. match length 80.0%)...
  Assembled 1408 stacks into 1304 stacks.
Coverage after gapped assembly: mean=18.88; stdev=29.71; max=227; n_reads=23983(56.3%)

Merging secondary stacks, allowing for gaps (min. match length 80.0%)...
  Merged 1512 out of 8300 secondary reads (18.2%).
Coverage after merging gapped secondary stacks: mean=20.07; stdev=30.67; max=228; n_reads=25495(59.9%)

Final number of stacks built: 1304
Final coverage: mean=20.07; stdev=30.67; max=228; n_reads=25495(59.9%)
Calling consensus sequences and haplotypes for catalog assembly...
Writing tags, SNPs, and alleles files to '/home/data/acropora_db/ustacks/AG_GAs11-67_S67'...done.
ustacks is done.

[2024-10-05 18:01:14,836] INFO database_accessor.py stacks :
ustacks successfully processed sample: AG_GAs11-67_S67
[2024-10-05 18:01:14,836] INFO database_accessor.py stacks :
Running ustacks for sample: AP_TS1_S1
[2024-10-05 18:01:14,836] INFO database_accessor.py stacks :
Command: ustacks -f /home/data/acropora_db/fasta/AP_TS1_S1_uniform.fasta.gz -o /home/data/acropora_db/ustacks --name AP_TS1_S1 -i 2 -m 3 -M 2 -p 8
[2024-10-05 18:01:14,836] INFO database_accessor.py execute_cmd :
[cmd] ustacks -f /home/data/acropora_db/fasta/AP_TS1_S1_uniform.fasta.gz -o /home/data/acropora_db/ustacks --name AP_TS1_S1 -i 2 -m 3 -M 2 -p 8
[2024-10-05 18:01:15,985] INFO database_accessor.py execute_cmd :
ustacks parameters selected:
  Input file: '/home/data/acropora_db/fasta/AP_TS1_S1_uniform.fasta.gz'
  Sample ID: 2
  Min depth of coverage to create a stack (m): 3
  Repeat removal algorithm: enabled
  Max distance allowed between stacks (M): 2
  Max distance allowed to align secondary reads: 4
  Max number of stacks allowed per de novo locus: 3
  Deleveraging algorithm: disabled
  Gapped assembly: enabled
  Minimum alignment length: 0.8
  Model type: SNP
  Alpha significance level for model: 0.05

Loading RAD-Tags...

Loaded 132844 reads; formed:
  4103 stacks representing 106978 primary reads (80.5%)
  23273 secondary stacks representing 25866 secondary reads (19.5%)

Stack coverage: mean=26.07; stdev=162.96; max=3789; n_reads=106978(80.5%)
Removing repetitive stacks: cov > 515 (mean+3*stdev)...
  Blacklisted 810 stacks.
Coverage after repeat removal: mean=18.76; stdev=45.94; max=503; n_reads=61763(46.5%)

Assembling stacks (max. dist. M=2)...
  Assembled 3293 stacks into 2828; blacklisted 37 stacks.
Coverage after assembling stacks: mean=18.73; stdev=41.41; max=505; n_reads=51877(39.1%)

Merging secondary stacks (max. dist. N=4 from consensus)...
  Merged 10842 out of 25866 secondary reads (41.9%), 1929 merged with gapped alignments.
Coverage after merging secondary stacks: mean=22.64; stdev=48.36; max=558; n_reads=62719(47.2%)

Assembling stacks, allowing for gaps (min. match length 80.0%)...
  Assembled 2828 stacks into 2188 stacks.
Coverage after gapped assembly: mean=29.45; stdev=59.63; max=729; n_reads=62719(47.2%)

Merging secondary stacks, allowing for gaps (min. match length 80.0%)...
  Merged 5527 out of 15024 secondary reads (36.8%).
Coverage after merging gapped secondary stacks: mean=32.04; stdev=61.68; max=735; n_reads=68246(51.4%)

Final number of stacks built: 2188
Final coverage: mean=32.04; stdev=61.68; max=735; n_reads=68246(51.4%)
Calling consensus sequences and haplotypes for catalog assembly...
Writing tags, SNPs, and alleles files to '/home/data/acropora_db/ustacks/AP_TS1_S1'...done.
ustacks is done.

[2024-10-05 18:01:15,986] INFO database_accessor.py stacks :
ustacks successfully processed sample: AP_TS1_S1
[2024-10-05 18:01:15,986] INFO database_accessor.py stacks :
Running ustacks for sample: AS_ASTUS31_S161
[2024-10-05 18:01:15,986] INFO database_accessor.py stacks :
Command: ustacks -f /home/data/acropora_db/fasta/AS_ASTUS31_S161_uniform.fasta.gz -o /home/data/acropora_db/ustacks --name AS_ASTUS31_S161 -i 3 -m 3 -M 2 -p 8
[2024-10-05 18:01:15,986] INFO database_accessor.py execute_cmd :
[cmd] ustacks -f /home/data/acropora_db/fasta/AS_ASTUS31_S161_uniform.fasta.gz -o /home/data/acropora_db/ustacks --name AS_ASTUS31_S161 -i 3 -m 3 -M 2 -p 8
[2024-10-05 18:01:16,610] INFO database_accessor.py execute_cmd :
ustacks parameters selected:
  Input file: '/home/data/acropora_db/fasta/AS_ASTUS31_S161_uniform.fasta.gz'
  Sample ID: 3
  Min depth of coverage to create a stack (m): 3
  Repeat removal algorithm: enabled
  Max distance allowed between stacks (M): 2
  Max distance allowed to align secondary reads: 4
  Max number of stacks allowed per de novo locus: 3
  Deleveraging algorithm: disabled
  Gapped assembly: enabled
  Minimum alignment length: 0.8
  Model type: SNP
  Alpha significance level for model: 0.05

Loading RAD-Tags...
Warning: Input reads contained 28 uncalled nucleotides.

Loaded 53942 reads; formed:
  2358 stacks representing 34094 primary reads (63.2%)
  18039 secondary stacks representing 19848 secondary reads (36.8%)

Stack coverage: mean=14.46; stdev=53.71; max=1311; n_reads=34094(63.2%)
Removing repetitive stacks: cov > 176 (mean+3*stdev)...
  Blacklisted 206 stacks.
Coverage after repeat removal: mean=10.86; stdev=17.90; max=174; n_reads=23378(43.3%)

Assembling stacks (max. dist. M=2)...
  Assembled 2152 stacks into 1737; blacklisted 36 stacks.
Coverage after assembling stacks: mean=11.62; stdev=17.83; max=181; n_reads=19559(36.3%)

Merging secondary stacks (max. dist. N=4 from consensus)...
  Merged 7119 out of 19848 secondary reads (35.9%), 1155 merged with gapped alignments.
Coverage after merging secondary stacks: mean=15.85; stdev=23.02; max=217; n_reads=26678(49.5%)

Assembling stacks, allowing for gaps (min. match length 80.0%)...
  Assembled 1737 stacks into 1624 stacks.
Coverage after gapped assembly: mean=16.99; stdev=24.40; max=225; n_reads=26678(49.5%)

Merging secondary stacks, allowing for gaps (min. match length 80.0%)...
  Merged 2854 out of 12729 secondary reads (22.4%).
Coverage after merging gapped secondary stacks: mean=18.81; stdev=27.05; max=228; n_reads=29532(54.7%)

Final number of stacks built: 1624
Final coverage: mean=18.81; stdev=27.05; max=228; n_reads=29532(54.7%)
Calling consensus sequences and haplotypes for catalog assembly...
Writing tags, SNPs, and alleles files to '/home/data/acropora_db/ustacks/AS_ASTUS31_S161'...done.
ustacks is done.

[2024-10-05 18:01:16,610] INFO database_accessor.py stacks :
ustacks successfully processed sample: AS_ASTUS31_S161
[2024-10-05 18:01:16,610] INFO database_accessor.py stacks :
Running ustacks for sample: AM_A-1_S33
[2024-10-05 18:01:16,610] INFO database_accessor.py stacks :
Command: ustacks -f /home/data/acropora_db/fasta/AM_A-1_S33_uniform.fasta.gz -o /home/data/acropora_db/ustacks --name AM_A-1_S33 -i 4 -m 3 -M 2 -p 8
[2024-10-05 18:01:16,611] INFO database_accessor.py execute_cmd :
[cmd] ustacks -f /home/data/acropora_db/fasta/AM_A-1_S33_uniform.fasta.gz -o /home/data/acropora_db/ustacks --name AM_A-1_S33 -i 4 -m 3 -M 2 -p 8
[2024-10-05 18:01:17,164] INFO database_accessor.py execute_cmd :
ustacks parameters selected:
  Input file: '/home/data/acropora_db/fasta/AM_A-1_S33_uniform.fasta.gz'
  Sample ID: 4
  Min depth of coverage to create a stack (m): 3
  Repeat removal algorithm: enabled
  Max distance allowed between stacks (M): 2
  Max distance allowed to align secondary reads: 4
  Max number of stacks allowed per de novo locus: 3
  Deleveraging algorithm: disabled
  Gapped assembly: enabled
  Minimum alignment length: 0.8
  Model type: SNP
  Alpha significance level for model: 0.05

Loading RAD-Tags...

Loaded 50057 reads; formed:
  2023 stacks representing 35081 primary reads (70.1%)
  13554 secondary stacks representing 14976 secondary reads (29.9%)

Stack coverage: mean=17.34; stdev=44.82; max=818; n_reads=35081(70.1%)
Removing repetitive stacks: cov > 152 (mean+3*stdev)...
  Blacklisted 98 stacks.
Coverage after repeat removal: mean=13.00; stdev=19.48; max=149; n_reads=25028(50.0%)

Assembling stacks (max. dist. M=2)...
  Assembled 1925 stacks into 1721; blacklisted 16 stacks.
Coverage after assembling stacks: mean=13.89; stdev=22.36; max=262; n_reads=23288(46.5%)

Merging secondary stacks (max. dist. N=4 from consensus)...
  Merged 5032 out of 14976 secondary reads (33.6%), 440 merged with gapped alignments.
Coverage after merging secondary stacks: mean=16.89; stdev=26.65; max=305; n_reads=28320(56.6%)

Assembling stacks, allowing for gaps (min. match length 80.0%)...
  Assembled 1721 stacks into 1565 stacks.
Coverage after gapped assembly: mean=18.62; stdev=28.96; max=305; n_reads=28320(56.6%)

Merging secondary stacks, allowing for gaps (min. match length 80.0%)...
  Merged 2580 out of 9944 secondary reads (25.9%).
Coverage after merging gapped secondary stacks: mean=20.32; stdev=30.63; max=306; n_reads=30900(61.7%)

Final number of stacks built: 1565
Final coverage: mean=20.32; stdev=30.63; max=306; n_reads=30900(61.7%)
Calling consensus sequences and haplotypes for catalog assembly...
Writing tags, SNPs, and alleles files to '/home/data/acropora_db/ustacks/AM_A-1_S33'...done.
ustacks is done.

[2024-10-05 18:01:17,164] INFO database_accessor.py stacks :
ustacks successfully processed sample: AM_A-1_S33
[2024-10-05 18:01:17,164] INFO database_accessor.py run :
stacks 处理完成
[2024-10-05 18:01:17,164] INFO database_accessor.py run :
当前 files_to_process: {'AG_GAs11-67_S67': '/home/data/acropora_db/ustacks/AG_GAs11-67_S67.tags.tsv.gz', 'AP_TS1_S1': '/home/data/acropora_db/ustacks/AP_TS1_S1.tags.tsv.gz', 'AS_ASTUS31_S161': '/home/data/acropora_db/ustacks/AS_ASTUS31_S161.tags.tsv.gz', 'AM_A-1_S33': '/home/data/acropora_db/ustacks/AM_A-1_S33.tags.tsv.gz'}
[2024-10-05 18:01:17,164] INFO database_accessor.py logging_title :

#################################
#### extract consensus fasta ####
#################################
[2024-10-05 18:01:17,165] INFO database_accessor.py extract_consensus_fasta :
[cmd] zcat /home/data/acropora_db/ustacks/AG_GAs11-67_S67.tags.tsv.gz | awk '{if($3=="consensus") {printf ">AG_GAs11-67_S67_%d\n%s\n", NR, $4}}' > /home/data/acropora_db/consensus_fasta/AG_GAs11-67_S67.fa
[2024-10-05 18:01:17,165] INFO database_accessor.py execute_cmd :
[cmd] zcat /home/data/acropora_db/ustacks/AG_GAs11-67_S67.tags.tsv.gz | awk '{if($3=="consensus") {printf ">AG_GAs11-67_S67_%d\n%s\n", NR, $4}}' > /home/data/acropora_db/consensus_fasta/AG_GAs11-67_S67.fa
[2024-10-05 18:01:17,185] INFO database_accessor.py extract_consensus_fasta :
成功生成共识序列文件: /home/data/acropora_db/consensus_fasta/AG_GAs11-67_S67.fa
[2024-10-05 18:01:17,185] INFO database_accessor.py extract_consensus_fasta :
检查生成的 FASTA 文件: /home/data/acropora_db/consensus_fasta/AG_GAs11-67_S67.fa
[2024-10-05 18:01:17,186] INFO database_accessor.py execute_cmd :
[cmd] head -n 10 /home/data/acropora_db/consensus_fasta/AG_GAs11-67_S67.fa
[2024-10-05 18:01:17,186] INFO database_accessor.py execute_cmd :
>AG_GAs11-67_S67_2
CAATAAAGGGCCGCCGGCGAGAGAAGAGCCCACAACCAGTTCACCTCCAGAGAGAGAACCACCAAGTGCGATCCATGCCAG
>AG_GAs11-67_S67_64
GACATCCCTGTGTTCTGACTAGACTACAAACTACCTGCCACTTAAAACATTCGAACTCGTAACATACCTACAGTCATGTTCTA
>AG_GAs11-67_S67_125
TTCTGGTCCTCCTTCTCCTTCTCGTTCTCGTTCTTGTTCTTGTTCGTGTTGTCGTTGCCGTTGTCGTTGTCCTTGTTGTCGTCATT
>AG_GAs11-67_S67_145
TCAATTTTGCAGCTGCTGCTGTTGTTGTTGTACACCCTGATGAATGAGTTGTAACTTTCCTTTGTCTTTTTTTTTTTTTGGCAG
>AG_GAs11-67_S67_193
CGCCATTTGAAACAAACCAGGTGAGATGAATTGATTATTACTGATGATGGAAATTAAAATTCCTTTTATGAAGGCATTCGTG

[2024-10-05 18:01:17,186] INFO database_accessor.py extract_consensus_fasta :
[cmd] zcat /home/data/acropora_db/ustacks/AP_TS1_S1.tags.tsv.gz | awk '{if($3=="consensus") {printf ">AP_TS1_S1_%d\n%s\n", NR, $4}}' > /home/data/acropora_db/consensus_fasta/AP_TS1_S1.fa
[2024-10-05 18:01:17,186] INFO database_accessor.py execute_cmd :
[cmd] zcat /home/data/acropora_db/ustacks/AP_TS1_S1.tags.tsv.gz | awk '{if($3=="consensus") {printf ">AP_TS1_S1_%d\n%s\n", NR, $4}}' > /home/data/acropora_db/consensus_fasta/AP_TS1_S1.fa
[2024-10-05 18:01:17,253] INFO database_accessor.py extract_consensus_fasta :
成功生成共识序列文件: /home/data/acropora_db/consensus_fasta/AP_TS1_S1.fa
[2024-10-05 18:01:17,253] INFO database_accessor.py extract_consensus_fasta :
检查生成的 FASTA 文件: /home/data/acropora_db/consensus_fasta/AP_TS1_S1.fa
[2024-10-05 18:01:17,253] INFO database_accessor.py execute_cmd :
[cmd] head -n 10 /home/data/acropora_db/consensus_fasta/AP_TS1_S1.fa
[2024-10-05 18:01:17,254] INFO database_accessor.py execute_cmd :
>AP_TS1_S1_2
TTGTAACCTGAAACCCATGGAGTTTTCCCCAATTCCAACCCATCGACCATGGCTAGTTCTGGTTCTTTGGGCTTCCAGAAA
>AP_TS1_S1_32
TGGGATTCCTTCAATGCGTTAGCTCGCAGGAGTTCCAGCTCTCGTTCTTTTTGAGCGACTATTTTTTCGTTTTCCAGCTTTCA
>AP_TS1_S1_99
AGTGTTACCATAATAGTTTTTTTTTTAAATCTTGTGAGAGCGATGTTTCTAAAGCCTTTATGCAGAAATGATTTACTTAAAAG
>AP_TS1_S1_273
TTCTGCCACTGTTCCACTAGGGCGAGGCCGGCTCAAATTGGCTTGAAGACTATATACTTGTCTTGTCTCTTCATTTTGTGG
>AP_TS1_S1_314
CTGACTTGGCAGTGTAGCACTCGGAGCTGAACTTATTGAGCCAAACTTACTATAAACTGAGCCATAACCTGATGAATCCAA

[2024-10-05 18:01:17,254] INFO database_accessor.py extract_consensus_fasta :
[cmd] zcat /home/data/acropora_db/ustacks/AS_ASTUS31_S161.tags.tsv.gz | awk '{if($3=="consensus") {printf ">AS_ASTUS31_S161_%d\n%s\n", NR, $4}}' > /home/data/acropora_db/consensus_fasta/AS_ASTUS31_S161.fa
[2024-10-05 18:01:17,254] INFO database_accessor.py execute_cmd :
[cmd] zcat /home/data/acropora_db/ustacks/AS_ASTUS31_S161.tags.tsv.gz | awk '{if($3=="consensus") {printf ">AS_ASTUS31_S161_%d\n%s\n", NR, $4}}' > /home/data/acropora_db/consensus_fasta/AS_ASTUS31_S161.fa
[2024-10-05 18:01:17,280] INFO database_accessor.py extract_consensus_fasta :
成功生成共识序列文件: /home/data/acropora_db/consensus_fasta/AS_ASTUS31_S161.fa
[2024-10-05 18:01:17,280] INFO database_accessor.py extract_consensus_fasta :
检查生成的 FASTA 文件: /home/data/acropora_db/consensus_fasta/AS_ASTUS31_S161.fa
[2024-10-05 18:01:17,280] INFO database_accessor.py execute_cmd :
[cmd] head -n 10 /home/data/acropora_db/consensus_fasta/AS_ASTUS31_S161.fa
[2024-10-05 18:01:17,281] INFO database_accessor.py execute_cmd :
>AS_ASTUS31_S161_2
ATCATCATCATCATCATCATCATCATCACCATCATCACCATCACCATCATCACGATCATCCGTCATCATCAAAATCGTCACCATCATCA
>AS_ASTUS31_S161_14
CCTTCTCAAAACTTAGAACTGCTTATACAAATCTTCGAAAATGAAACAGGCTCGGAAATAAATGATTAACTTGTTCCCTTT
>AS_ASTUS31_S161_29
CAGTTCCTTTGCGATGGTTTCAGGTTCGGAAAGCGCAGAAAAATGATTGAAAGAAATCATGGGAGTACGTTCACCGTGAAAA
>AS_ASTUS31_S161_107
CTTGTCTTGAAAATATAAGACGATGTAAGGTGTTTCAATAGGTTTTGAAACTTCATTAGGCTTGATTTACAAATAGTTCTT
>AS_ASTUS31_S161_189
CCATGAACAGAAAGCGGTAGAGGTGCCTTGATGTCAACGGAGCGCAATGATCGTTGAACTTCTCTTCTACAGCCTTAATCTT

[2024-10-05 18:01:17,281] INFO database_accessor.py extract_consensus_fasta :
[cmd] zcat /home/data/acropora_db/ustacks/AM_A-1_S33.tags.tsv.gz | awk '{if($3=="consensus") {printf ">AM_A-1_S33_%d\n%s\n", NR, $4}}' > /home/data/acropora_db/consensus_fasta/AM_A-1_S33.fa
[2024-10-05 18:01:17,281] INFO database_accessor.py execute_cmd :
[cmd] zcat /home/data/acropora_db/ustacks/AM_A-1_S33.tags.tsv.gz | awk '{if($3=="consensus") {printf ">AM_A-1_S33_%d\n%s\n", NR, $4}}' > /home/data/acropora_db/consensus_fasta/AM_A-1_S33.fa
[2024-10-05 18:01:17,306] INFO database_accessor.py extract_consensus_fasta :
成功生成共识序列文件: /home/data/acropora_db/consensus_fasta/AM_A-1_S33.fa
[2024-10-05 18:01:17,306] INFO database_accessor.py extract_consensus_fasta :
检查生成的 FASTA 文件: /home/data/acropora_db/consensus_fasta/AM_A-1_S33.fa
[2024-10-05 18:01:17,306] INFO database_accessor.py execute_cmd :
[cmd] head -n 10 /home/data/acropora_db/consensus_fasta/AM_A-1_S33.fa
[2024-10-05 18:01:17,306] INFO database_accessor.py execute_cmd :
>AM_A-1_S33_2
CATGCTCAGTTCATTCAGAAAATAATGATTTACATGTGCTTAATAGATACTATTTTCAATCCTTTAATACTTCACCTATGAAGCTA
>AM_A-1_S33_56
ATGTAACTGCTACAGGGAAGGGTAAAGTGCCCCCCACCCCGCGTGTGGAAAACTGGGAGTTGAAACCATCTTCCTGTCTGGAACAACA
>AM_A-1_S33_144
CATTGATGCGAATTTCGTCCACACCAAACACGATAGTCTGTTCGTACGCACTCTTATTGGTGTCTCTCCATCTCGGGTTAG
>AM_A-1_S33_180
CCTGCATTGCTTTCAGTTTTTCCTCCATGTACTCCTAGAGGACAAAAGCAACAAGAAAAGAAAACAAAAGAATTTAGCTGGG
>AM_A-1_S33_205
CCTTGTCTCTTGGTTGCTTGTTTGGTTGTCACTTGTTTGTTGCTGACTTGTTTGTTACTTGTTACTGAATCATTTCTTTGTA

[2024-10-05 18:01:17,307] INFO database_accessor.py logging_title :

######################
#### make blastdb ####
######################
[2024-10-05 18:01:17,307] INFO database_accessor.py make_blastdb :
合并 FASTA 文件到: /home/data/acropora_db/blastdb/merged_consensus.fasta
[2024-10-05 18:01:17,307] INFO database_accessor.py execute_cmd :
[cmd] cat /home/data/acropora_db/consensus_fasta/AG_GAs11-67_S67.fa /home/data/acropora_db/consensus_fasta/AP_TS1_S1.fa /home/data/acropora_db/consensus_fasta/AS_ASTUS31_S161.fa /home/data/acropora_db/consensus_fasta/AM_A-1_S33.fa > /home/data/acropora_db/blastdb/merged_consensus.fasta
[2024-10-05 18:01:17,309] INFO database_accessor.py make_blastdb :
检查合并后的 FASTA 文件格式
[2024-10-05 18:01:17,309] INFO database_accessor.py execute_cmd :
[cmd] head -n 10 /home/data/acropora_db/blastdb/merged_consensus.fasta
[2024-10-05 18:01:17,310] INFO database_accessor.py execute_cmd :
>AG_GAs11-67_S67_2
CAATAAAGGGCCGCCGGCGAGAGAAGAGCCCACAACCAGTTCACCTCCAGAGAGAGAACCACCAAGTGCGATCCATGCCAG
>AG_GAs11-67_S67_64
GACATCCCTGTGTTCTGACTAGACTACAAACTACCTGCCACTTAAAACATTCGAACTCGTAACATACCTACAGTCATGTTCTA
>AG_GAs11-67_S67_125
TTCTGGTCCTCCTTCTCCTTCTCGTTCTCGTTCTTGTTCTTGTTCGTGTTGTCGTTGCCGTTGTCGTTGTCCTTGTTGTCGTCATT
>AG_GAs11-67_S67_145
TCAATTTTGCAGCTGCTGCTGTTGTTGTTGTACACCCTGATGAATGAGTTGTAACTTTCCTTTGTCTTTTTTTTTTTTTGGCAG
>AG_GAs11-67_S67_193
CGCCATTTGAAACAAACCAGGTGAGATGAATTGATTATTACTGATGATGGAAATTAAAATTCCTTTTATGAAGGCATTCGTG

[2024-10-05 18:01:17,310] INFO database_accessor.py make_blastdb :
创建 BLAST 数据库: /home/data/acropora_db/blastdb/
[2024-10-05 18:01:17,310] INFO database_accessor.py execute_cmd :
[cmd] makeblastdb -in /home/data/acropora_db/blastdb/merged_consensus.fasta -out /home/data/acropora_db/blastdb/ -dbtype nucl -parse_seqids
[2024-10-05 18:01:17,372] INFO database_accessor.py execute_cmd :


Building a new DB, current time: 10/05/2024 18:01:17
New DB name:   /home/data/acropora_db/blastdb
New DB title:  /home/data/acropora_db/blastdb/merged_consensus.fasta
Sequence type: Nucleotide
Deleted existing Nucleotide BLAST database named /home/data/acropora_db/blastdb
Keep MBits: T
Maximum file size: 1000000000B
Adding sequences from FASTA; added 6681 sequences in 0.0393629 seconds.



[2024-10-05 18:01:17,372] ERROR database_accessor.py make_blastdb :
BLAST 数据库创建失败: /home/data/acropora_db/blastdb/
[2024-10-05 18:01:17,372] ERROR database_accessor.py make_blastdb :
缺少以下文件: /home/data/acropora_db/blastdb/.nhr, /home/data/acropora_db/blastdb/.nin, /home/data/acropora_db/blastdb/.nsq
[2024-10-05 18:01:17,372] INFO database_accessor.py make_blastdb :
BLAST 数据库目录内容:
[2024-10-05 18:01:17,372] INFO database_accessor.py execute_cmd :
[cmd] ls -l /home/data/acropora_db/blastdb
[2024-10-05 18:01:17,374] INFO database_accessor.py execute_cmd :
total 1920
-rw-r--r-- 1 root root 303104 Oct  5 17:58 acropora_db.ndb
-rw-r--r-- 1 root root 379385 Oct  5 17:58 acropora_db.nhr
-rw-r--r-- 1 root root  80348 Oct  5 17:58 acropora_db.nin
-rw-r--r-- 1 root root  26768 Oct  5 17:58 acropora_db.nog
-rw-r--r-- 1 root root 178873 Oct  5 17:58 acropora_db.nos
-rw-r--r-- 1 root root  80216 Oct  5 17:58 acropora_db.not
-rw-r--r-- 1 root root 140807 Oct  5 17:58 acropora_db.nsq
-rw-r--r-- 1 root root  16384 Oct  5 17:58 acropora_db.ntf
-rw-r--r-- 1 root root  26740 Oct  5 17:58 acropora_db.nto
-rw-r--r-- 1 root root 679926 Oct  5 18:01 merged_consensus.fasta

[2024-10-05 18:01:17,374] INFO database_accessor.py run :
处理完成
[2024-10-05 18:01:17,374] INFO ACF.py execute_cmd :
[cmd] cd /home/data/acropora_db/ && tree . > tree.txt
[2024-10-05 18:01:17,378] INFO ACF.py write_analysis_complete_flag :
ANCAT_ANALYSIS_COMPLETED
[2024-10-05 18:02:13,074] INFO database_accessor.py execute_cmd :
[cmd] cp mkdb_acropora.conf /home/data/acropora_db/
[2024-10-05 18:02:13,075] INFO database_accessor.py logging_title :

########################
#### load fastq dir ####
########################
[2024-10-05 18:02:13,076] INFO database_accessor.py logging_title :

#################################
#### quality control : fastq ####
#################################
[2024-10-05 18:02:13,076] INFO database_accessor.py quality_control :
Processing sample: AP_TS1_S1
[2024-10-05 18:02:13,077] INFO database_accessor.py execute_cmd :
[cmd] fastp -i /home/data/acropora/AP_TS1_S1_L001_R1_001.fastq.gz -I /home/data/acropora/AP_TS1_S1_L001_R2_001.fastq.gz -o /home/data/acropora_db/quality_control/AP_TS1_S1_qc_R1.fastq.gz -O /home/data/acropora_db/quality_control/AP_TS1_S1_qc_R2.fastq.gz -q 30 -f 0 -F 15 --cut_right --thread 8 --json /home/data/acropora_db/quality_control/AP_TS1_S1_fastp.json --html /home/data/acropora_db/quality_control/AP_TS1_S1_fastp.html
[2024-10-05 18:02:13,803] INFO database_accessor.py execute_cmd :
Read1 before filtering:
total reads: 248601
total bases: 19888080
Q20 bases: 19480257(97.9494%)
Q30 bases: 18588142(93.4637%)

Read2 before filtering:
total reads: 248601
total bases: 23617095
Q20 bases: 22812090(96.5914%)
Q30 bases: 21475937(90.9339%)

Read1 after filtering:
total reads: 231712
total bases: 17580299
Q20 bases: 17414800(99.0586%)
Q30 bases: 16830589(95.7355%)

Read2 after filtering:
total reads: 231712
total bases: 16739640
Q20 bases: 16514648(98.6559%)
Q30 bases: 15824490(94.533%)

Filtering result:
reads passed filter: 463424
reads failed due to low quality: 12162
reads failed due to too many N: 0
reads failed due to too short: 21616
reads with adapter trimmed: 99544
bases trimmed due to adapters: 1530502

Duplication rate: 64.4881%

Insert size peak (evaluated by paired-end reads): 71

JSON report: /home/data/acropora_db/quality_control/AP_TS1_S1_fastp.json
HTML report: /home/data/acropora_db/quality_control/AP_TS1_S1_fastp.html

fastp -i /home/data/acropora/AP_TS1_S1_L001_R1_001.fastq.gz -I /home/data/acropora/AP_TS1_S1_L001_R2_001.fastq.gz -o /home/data/acropora_db/quality_control/AP_TS1_S1_qc_R1.fastq.gz -O /home/data/acropora_db/quality_control/AP_TS1_S1_qc_R2.fastq.gz -q 30 -f 0 -F 15 --cut_right --thread 8 --json /home/data/acropora_db/quality_control/AP_TS1_S1_fastp.json --html /home/data/acropora_db/quality_control/AP_TS1_S1_fastp.html 
fastp v0.23.4, time used: 0 seconds

[2024-10-05 18:02:13,803] WARNING database_accessor.py quality_control :
fastp for AP_TS1_S1 produced warnings: Read1 before filtering:
total reads: 248601
total bases: 19888080
Q20 bases: 19480257(97.9494%)
Q30 bases: 18588142(93.4637%)

Read2 before filtering:
total reads: 248601
total bases: 23617095
Q20 bases: 22812090(96.5914%)
Q30 bases: 21475937(90.9339%)

Read1 after filtering:
total reads: 231712
total bases: 17580299
Q20 bases: 17414800(99.0586%)
Q30 bases: 16830589(95.7355%)

Read2 after filtering:
total reads: 231712
total bases: 16739640
Q20 bases: 16514648(98.6559%)
Q30 bases: 15824490(94.533%)

Filtering result:
reads passed filter: 463424
reads failed due to low quality: 12162
reads failed due to too many N: 0
reads failed due to too short: 21616
reads with adapter trimmed: 99544
bases trimmed due to adapters: 1530502

Duplication rate: 64.4881%

Insert size peak (evaluated by paired-end reads): 71

JSON report: /home/data/acropora_db/quality_control/AP_TS1_S1_fastp.json
HTML report: /home/data/acropora_db/quality_control/AP_TS1_S1_fastp.html

fastp -i /home/data/acropora/AP_TS1_S1_L001_R1_001.fastq.gz -I /home/data/acropora/AP_TS1_S1_L001_R2_001.fastq.gz -o /home/data/acropora_db/quality_control/AP_TS1_S1_qc_R1.fastq.gz -O /home/data/acropora_db/quality_control/AP_TS1_S1_qc_R2.fastq.gz -q 30 -f 0 -F 15 --cut_right --thread 8 --json /home/data/acropora_db/quality_control/AP_TS1_S1_fastp.json --html /home/data/acropora_db/quality_control/AP_TS1_S1_fastp.html 
fastp v0.23.4, time used: 0 seconds

[2024-10-05 18:02:13,803] INFO database_accessor.py quality_control :
Finished processing sample: AP_TS1_S1
[2024-10-05 18:02:13,803] INFO database_accessor.py quality_control :
Processing sample: AM_A-1_S33
[2024-10-05 18:02:13,804] INFO database_accessor.py execute_cmd :
[cmd] fastp -i /home/data/acropora/AM_A-1_S33_L001_R1_001.fastq.gz -I /home/data/acropora/AM_A-1_S33_L001_R2_001.fastq.gz -o /home/data/acropora_db/quality_control/AM_A-1_S33_qc_R1.fastq.gz -O /home/data/acropora_db/quality_control/AM_A-1_S33_qc_R2.fastq.gz -q 30 -f 0 -F 15 --cut_right --thread 8 --json /home/data/acropora_db/quality_control/AM_A-1_S33_fastp.json --html /home/data/acropora_db/quality_control/AM_A-1_S33_fastp.html
[2024-10-05 18:02:14,274] INFO database_accessor.py execute_cmd :
Read1 before filtering:
total reads: 97107
total bases: 7768560
Q20 bases: 7647822(98.4458%)
Q30 bases: 7362598(94.7743%)

Read2 before filtering:
total reads: 97107
total bases: 9128058
Q20 bases: 8907264(97.5812%)
Q30 bases: 8496983(93.0864%)

Read1 after filtering:
total reads: 93866
total bases: 7066298
Q20 bases: 7008421(99.1809%)
Q30 bases: 6804930(96.3012%)

Read2 after filtering:
total reads: 93866
total bases: 6587867
Q20 bases: 6517391(98.9302%)
Q30 bases: 6285324(95.4076%)

Filtering result:
reads passed filter: 187732
reads failed due to low quality: 2370
reads failed due to too many N: 0
reads failed due to too short: 4112
reads with adapter trimmed: 50244
bases trimmed due to adapters: 883198

Duplication rate: 53.0343%

Insert size peak (evaluated by paired-end reads): 57

JSON report: /home/data/acropora_db/quality_control/AM_A-1_S33_fastp.json
HTML report: /home/data/acropora_db/quality_control/AM_A-1_S33_fastp.html

fastp -i /home/data/acropora/AM_A-1_S33_L001_R1_001.fastq.gz -I /home/data/acropora/AM_A-1_S33_L001_R2_001.fastq.gz -o /home/data/acropora_db/quality_control/AM_A-1_S33_qc_R1.fastq.gz -O /home/data/acropora_db/quality_control/AM_A-1_S33_qc_R2.fastq.gz -q 30 -f 0 -F 15 --cut_right --thread 8 --json /home/data/acropora_db/quality_control/AM_A-1_S33_fastp.json --html /home/data/acropora_db/quality_control/AM_A-1_S33_fastp.html 
fastp v0.23.4, time used: 1 seconds

[2024-10-05 18:02:14,274] WARNING database_accessor.py quality_control :
fastp for AM_A-1_S33 produced warnings: Read1 before filtering:
total reads: 97107
total bases: 7768560
Q20 bases: 7647822(98.4458%)
Q30 bases: 7362598(94.7743%)

Read2 before filtering:
total reads: 97107
total bases: 9128058
Q20 bases: 8907264(97.5812%)
Q30 bases: 8496983(93.0864%)

Read1 after filtering:
total reads: 93866
total bases: 7066298
Q20 bases: 7008421(99.1809%)
Q30 bases: 6804930(96.3012%)

Read2 after filtering:
total reads: 93866
total bases: 6587867
Q20 bases: 6517391(98.9302%)
Q30 bases: 6285324(95.4076%)

Filtering result:
reads passed filter: 187732
reads failed due to low quality: 2370
reads failed due to too many N: 0
reads failed due to too short: 4112
reads with adapter trimmed: 50244
bases trimmed due to adapters: 883198

Duplication rate: 53.0343%

Insert size peak (evaluated by paired-end reads): 57

JSON report: /home/data/acropora_db/quality_control/AM_A-1_S33_fastp.json
HTML report: /home/data/acropora_db/quality_control/AM_A-1_S33_fastp.html

fastp -i /home/data/acropora/AM_A-1_S33_L001_R1_001.fastq.gz -I /home/data/acropora/AM_A-1_S33_L001_R2_001.fastq.gz -o /home/data/acropora_db/quality_control/AM_A-1_S33_qc_R1.fastq.gz -O /home/data/acropora_db/quality_control/AM_A-1_S33_qc_R2.fastq.gz -q 30 -f 0 -F 15 --cut_right --thread 8 --json /home/data/acropora_db/quality_control/AM_A-1_S33_fastp.json --html /home/data/acropora_db/quality_control/AM_A-1_S33_fastp.html 
fastp v0.23.4, time used: 1 seconds

[2024-10-05 18:02:14,274] INFO database_accessor.py quality_control :
Finished processing sample: AM_A-1_S33
[2024-10-05 18:02:14,274] INFO database_accessor.py quality_control :
Processing sample: AG_GAs11-67_S67
[2024-10-05 18:02:14,274] INFO database_accessor.py execute_cmd :
[cmd] fastp -i /home/data/acropora/AG_GAs11-67_S67_L001_R1_001.fastq.gz -I /home/data/acropora/AG_GAs11-67_S67_L001_R2_001.fastq.gz -o /home/data/acropora_db/quality_control/AG_GAs11-67_S67_qc_R1.fastq.gz -O /home/data/acropora_db/quality_control/AG_GAs11-67_S67_qc_R2.fastq.gz -q 30 -f 0 -F 15 --cut_right --thread 8 --json /home/data/acropora_db/quality_control/AG_GAs11-67_S67_fastp.json --html /home/data/acropora_db/quality_control/AG_GAs11-67_S67_fastp.html
[2024-10-05 18:02:14,732] INFO database_accessor.py execute_cmd :
Read1 before filtering:
total reads: 82521
total bases: 6601680
Q20 bases: 6416163(97.1899%)
Q30 bases: 6082997(92.1432%)

Read2 before filtering:
total reads: 82521
total bases: 7756974
Q20 bases: 7322026(94.3928%)
Q30 bases: 6779442(87.398%)

Read1 after filtering:
total reads: 79298
total bases: 5996604
Q20 bases: 5914403(98.6292%)
Q30 bases: 5679288(94.7084%)

Read2 after filtering:
total reads: 79298
total bases: 5490991
Q20 bases: 5383923(98.0501%)
Q30 bases: 5084929(92.6049%)

Filtering result:
reads passed filter: 158596
reads failed due to low quality: 2226
reads failed due to too many N: 0
reads failed due to too short: 4220
reads with adapter trimmed: 15980
bases trimmed due to adapters: 278157

Duplication rate: 41.8899%

Insert size peak (evaluated by paired-end reads): 64

JSON report: /home/data/acropora_db/quality_control/AG_GAs11-67_S67_fastp.json
HTML report: /home/data/acropora_db/quality_control/AG_GAs11-67_S67_fastp.html

fastp -i /home/data/acropora/AG_GAs11-67_S67_L001_R1_001.fastq.gz -I /home/data/acropora/AG_GAs11-67_S67_L001_R2_001.fastq.gz -o /home/data/acropora_db/quality_control/AG_GAs11-67_S67_qc_R1.fastq.gz -O /home/data/acropora_db/quality_control/AG_GAs11-67_S67_qc_R2.fastq.gz -q 30 -f 0 -F 15 --cut_right --thread 8 --json /home/data/acropora_db/quality_control/AG_GAs11-67_S67_fastp.json --html /home/data/acropora_db/quality_control/AG_GAs11-67_S67_fastp.html 
fastp v0.23.4, time used: 0 seconds

[2024-10-05 18:02:14,733] WARNING database_accessor.py quality_control :
fastp for AG_GAs11-67_S67 produced warnings: Read1 before filtering:
total reads: 82521
total bases: 6601680
Q20 bases: 6416163(97.1899%)
Q30 bases: 6082997(92.1432%)

Read2 before filtering:
total reads: 82521
total bases: 7756974
Q20 bases: 7322026(94.3928%)
Q30 bases: 6779442(87.398%)

Read1 after filtering:
total reads: 79298
total bases: 5996604
Q20 bases: 5914403(98.6292%)
Q30 bases: 5679288(94.7084%)

Read2 after filtering:
total reads: 79298
total bases: 5490991
Q20 bases: 5383923(98.0501%)
Q30 bases: 5084929(92.6049%)

Filtering result:
reads passed filter: 158596
reads failed due to low quality: 2226
reads failed due to too many N: 0
reads failed due to too short: 4220
reads with adapter trimmed: 15980
bases trimmed due to adapters: 278157

Duplication rate: 41.8899%

Insert size peak (evaluated by paired-end reads): 64

JSON report: /home/data/acropora_db/quality_control/AG_GAs11-67_S67_fastp.json
HTML report: /home/data/acropora_db/quality_control/AG_GAs11-67_S67_fastp.html

fastp -i /home/data/acropora/AG_GAs11-67_S67_L001_R1_001.fastq.gz -I /home/data/acropora/AG_GAs11-67_S67_L001_R2_001.fastq.gz -o /home/data/acropora_db/quality_control/AG_GAs11-67_S67_qc_R1.fastq.gz -O /home/data/acropora_db/quality_control/AG_GAs11-67_S67_qc_R2.fastq.gz -q 30 -f 0 -F 15 --cut_right --thread 8 --json /home/data/acropora_db/quality_control/AG_GAs11-67_S67_fastp.json --html /home/data/acropora_db/quality_control/AG_GAs11-67_S67_fastp.html 
fastp v0.23.4, time used: 0 seconds

[2024-10-05 18:02:14,733] INFO database_accessor.py quality_control :
Finished processing sample: AG_GAs11-67_S67
[2024-10-05 18:02:14,733] INFO database_accessor.py quality_control :
Processing sample: AS_ASTUS31_S161
[2024-10-05 18:02:14,733] INFO database_accessor.py execute_cmd :
[cmd] fastp -i /home/data/acropora/AS_ASTUS31_S161_L001_R1_001.fastq.gz -I /home/data/acropora/AS_ASTUS31_S161_L001_R2_001.fastq.gz -o /home/data/acropora_db/quality_control/AS_ASTUS31_S161_qc_R1.fastq.gz -O /home/data/acropora_db/quality_control/AS_ASTUS31_S161_qc_R2.fastq.gz -q 30 -f 0 -F 15 --cut_right --thread 8 --json /home/data/acropora_db/quality_control/AS_ASTUS31_S161_fastp.json --html /home/data/acropora_db/quality_control/AS_ASTUS31_S161_fastp.html
[2024-10-05 18:02:15,447] INFO database_accessor.py execute_cmd :
Read1 before filtering:
total reads: 162226
total bases: 12978080
Q20 bases: 12762049(98.3354%)
Q30 bases: 12317675(94.9114%)

Read2 before filtering:
total reads: 162226
total bases: 15249244
Q20 bases: 14935119(97.9401%)
Q30 bases: 14342176(94.0517%)

Read1 after filtering:
total reads: 158521
total bases: 12084495
Q20 bases: 11964325(99.0056%)
Q30 bases: 11633921(96.2715%)

Read2 after filtering:
total reads: 158521
total bases: 11411898
Q20 bases: 11287906(98.9135%)
Q30 bases: 10913654(95.634%)

Filtering result:
reads passed filter: 317042
reads failed due to low quality: 2624
reads failed due to too many N: 0
reads failed due to too short: 4786
reads with adapter trimmed: 58926
bases trimmed due to adapters: 1142077

Duplication rate: 56.3621%

Insert size peak (evaluated by paired-end reads): 95

JSON report: /home/data/acropora_db/quality_control/AS_ASTUS31_S161_fastp.json
HTML report: /home/data/acropora_db/quality_control/AS_ASTUS31_S161_fastp.html

fastp -i /home/data/acropora/AS_ASTUS31_S161_L001_R1_001.fastq.gz -I /home/data/acropora/AS_ASTUS31_S161_L001_R2_001.fastq.gz -o /home/data/acropora_db/quality_control/AS_ASTUS31_S161_qc_R1.fastq.gz -O /home/data/acropora_db/quality_control/AS_ASTUS31_S161_qc_R2.fastq.gz -q 30 -f 0 -F 15 --cut_right --thread 8 --json /home/data/acropora_db/quality_control/AS_ASTUS31_S161_fastp.json --html /home/data/acropora_db/quality_control/AS_ASTUS31_S161_fastp.html 
fastp v0.23.4, time used: 1 seconds

[2024-10-05 18:02:15,447] WARNING database_accessor.py quality_control :
fastp for AS_ASTUS31_S161 produced warnings: Read1 before filtering:
total reads: 162226
total bases: 12978080
Q20 bases: 12762049(98.3354%)
Q30 bases: 12317675(94.9114%)

Read2 before filtering:
total reads: 162226
total bases: 15249244
Q20 bases: 14935119(97.9401%)
Q30 bases: 14342176(94.0517%)

Read1 after filtering:
total reads: 158521
total bases: 12084495
Q20 bases: 11964325(99.0056%)
Q30 bases: 11633921(96.2715%)

Read2 after filtering:
total reads: 158521
total bases: 11411898
Q20 bases: 11287906(98.9135%)
Q30 bases: 10913654(95.634%)

Filtering result:
reads passed filter: 317042
reads failed due to low quality: 2624
reads failed due to too many N: 0
reads failed due to too short: 4786
reads with adapter trimmed: 58926
bases trimmed due to adapters: 1142077

Duplication rate: 56.3621%

Insert size peak (evaluated by paired-end reads): 95

JSON report: /home/data/acropora_db/quality_control/AS_ASTUS31_S161_fastp.json
HTML report: /home/data/acropora_db/quality_control/AS_ASTUS31_S161_fastp.html

fastp -i /home/data/acropora/AS_ASTUS31_S161_L001_R1_001.fastq.gz -I /home/data/acropora/AS_ASTUS31_S161_L001_R2_001.fastq.gz -o /home/data/acropora_db/quality_control/AS_ASTUS31_S161_qc_R1.fastq.gz -O /home/data/acropora_db/quality_control/AS_ASTUS31_S161_qc_R2.fastq.gz -q 30 -f 0 -F 15 --cut_right --thread 8 --json /home/data/acropora_db/quality_control/AS_ASTUS31_S161_fastp.json --html /home/data/acropora_db/quality_control/AS_ASTUS31_S161_fastp.html 
fastp v0.23.4, time used: 1 seconds

[2024-10-05 18:02:15,447] INFO database_accessor.py quality_control :
Finished processing sample: AS_ASTUS31_S161
[2024-10-05 18:02:15,447] INFO database_accessor.py quality_control :
Quality control completed for all samples
[2024-10-05 18:02:15,447] INFO database_accessor.py logging_title :

####################
#### 接头修剪：fastq ####
####################
[2024-10-05 18:02:15,448] INFO database_accessor.py execute_cmd :
[cmd] fastp -i /home/data/acropora_db/quality_control/AP_TS1_S1_qc_R1.fastq.gz -I /home/data/acropora_db/quality_control/AP_TS1_S1_qc_R2.fastq.gz -o /home/data/acropora_db/adapter_trim/AP_TS1_S1_at_R1.fastq.gz -O /home/data/acropora_db/adapter_trim/AP_TS1_S1_at_R2.fastq.gz --adapter_sequence GTCAGATCGGAAGAGCACACGTCTGAACTCCAGTCAC --adapter_sequence_r2 CAGAGATCGGAAGAGCGTCGTGTAGGGAAAGAC --cut_right --cut_window_size 4 --cut_mean_quality 20 --length_required 36 --length_limit 150 --average_qual 19 --thread 8 --json /home/data/acropora_db/adapter_trim/AP_TS1_S1_fastp.json --html /home/data/acropora_db/adapter_trim/AP_TS1_S1_fastp.html
[2024-10-05 18:02:16,139] INFO database_accessor.py execute_cmd :
Read1 before filtering:
total reads: 231712
total bases: 17580299
Q20 bases: 17414800(99.0586%)
Q30 bases: 16830589(95.7355%)

Read2 before filtering:
total reads: 231712
total bases: 16739640
Q20 bases: 16514648(98.6559%)
Q30 bases: 15824490(94.533%)

Read1 after filtering:
total reads: 119529
total bases: 8749001
Q20 bases: 8688635(99.31%)
Q30 bases: 8447878(96.5582%)

Read2 after filtering:
total reads: 119529
total bases: 8129678
Q20 bases: 8057783(99.1156%)
Q30 bases: 7796800(95.9054%)

Filtering result:
reads passed filter: 239058
reads failed due to low quality: 20
reads failed due to too many N: 0
reads failed due to too short: 224346
reads failed due to too long: 0
reads with adapter trimmed: 223016
bases trimmed due to adapters: 11817632

Duplication rate: 68.6382%

Insert size peak (evaluated by paired-end reads): 56

JSON report: /home/data/acropora_db/adapter_trim/AP_TS1_S1_fastp.json
HTML report: /home/data/acropora_db/adapter_trim/AP_TS1_S1_fastp.html

fastp -i /home/data/acropora_db/quality_control/AP_TS1_S1_qc_R1.fastq.gz -I /home/data/acropora_db/quality_control/AP_TS1_S1_qc_R2.fastq.gz -o /home/data/acropora_db/adapter_trim/AP_TS1_S1_at_R1.fastq.gz -O /home/data/acropora_db/adapter_trim/AP_TS1_S1_at_R2.fastq.gz --adapter_sequence GTCAGATCGGAAGAGCACACGTCTGAACTCCAGTCAC --adapter_sequence_r2 CAGAGATCGGAAGAGCGTCGTGTAGGGAAAGAC --cut_right --cut_window_size 4 --cut_mean_quality 20 --length_required 36 --length_limit 150 --average_qual 19 --thread 8 --json /home/data/acropora_db/adapter_trim/AP_TS1_S1_fastp.json --html /home/data/acropora_db/adapter_trim/AP_TS1_S1_fastp.html 
fastp v0.23.4, time used: 1 seconds

[2024-10-05 18:02:16,139] INFO database_accessor.py execute_cmd :
[cmd] fastp -i /home/data/acropora_db/quality_control/AM_A-1_S33_qc_R1.fastq.gz -I /home/data/acropora_db/quality_control/AM_A-1_S33_qc_R2.fastq.gz -o /home/data/acropora_db/adapter_trim/AM_A-1_S33_at_R1.fastq.gz -O /home/data/acropora_db/adapter_trim/AM_A-1_S33_at_R2.fastq.gz --adapter_sequence GTCAGATCGGAAGAGCACACGTCTGAACTCCAGTCAC --adapter_sequence_r2 CAGAGATCGGAAGAGCGTCGTGTAGGGAAAGAC --cut_right --cut_window_size 4 --cut_mean_quality 20 --length_required 36 --length_limit 150 --average_qual 19 --thread 8 --json /home/data/acropora_db/adapter_trim/AM_A-1_S33_fastp.json --html /home/data/acropora_db/adapter_trim/AM_A-1_S33_fastp.html
[2024-10-05 18:02:16,683] INFO database_accessor.py execute_cmd :
Read1 before filtering:
total reads: 93866
total bases: 7066298
Q20 bases: 7008421(99.1809%)
Q30 bases: 6804930(96.3012%)

Read2 before filtering:
total reads: 93866
total bases: 6587867
Q20 bases: 6517391(98.9302%)
Q30 bases: 6285324(95.4076%)

Read1 after filtering:
total reads: 70057
total bases: 5238507
Q20 bases: 5207195(99.4023%)
Q30 bases: 5082504(97.022%)

Read2 after filtering:
total reads: 70057
total bases: 4876236
Q20 bases: 4840109(99.2591%)
Q30 bases: 4707250(96.5345%)

Filtering result:
reads passed filter: 140114
reads failed due to low quality: 2
reads failed due to too many N: 0
reads failed due to too short: 47616
reads failed due to too long: 0
reads with adapter trimmed: 44894
bases trimmed due to adapters: 2404472

Duplication rate: 56.4027%

Insert size peak (evaluated by paired-end reads): 42

JSON report: /home/data/acropora_db/adapter_trim/AM_A-1_S33_fastp.json
HTML report: /home/data/acropora_db/adapter_trim/AM_A-1_S33_fastp.html

fastp -i /home/data/acropora_db/quality_control/AM_A-1_S33_qc_R1.fastq.gz -I /home/data/acropora_db/quality_control/AM_A-1_S33_qc_R2.fastq.gz -o /home/data/acropora_db/adapter_trim/AM_A-1_S33_at_R1.fastq.gz -O /home/data/acropora_db/adapter_trim/AM_A-1_S33_at_R2.fastq.gz --adapter_sequence GTCAGATCGGAAGAGCACACGTCTGAACTCCAGTCAC --adapter_sequence_r2 CAGAGATCGGAAGAGCGTCGTGTAGGGAAAGAC --cut_right --cut_window_size 4 --cut_mean_quality 20 --length_required 36 --length_limit 150 --average_qual 19 --thread 8 --json /home/data/acropora_db/adapter_trim/AM_A-1_S33_fastp.json --html /home/data/acropora_db/adapter_trim/AM_A-1_S33_fastp.html 
fastp v0.23.4, time used: 0 seconds

[2024-10-05 18:02:16,684] INFO database_accessor.py execute_cmd :
[cmd] fastp -i /home/data/acropora_db/quality_control/AG_GAs11-67_S67_qc_R1.fastq.gz -I /home/data/acropora_db/quality_control/AG_GAs11-67_S67_qc_R2.fastq.gz -o /home/data/acropora_db/adapter_trim/AG_GAs11-67_S67_at_R1.fastq.gz -O /home/data/acropora_db/adapter_trim/AG_GAs11-67_S67_at_R2.fastq.gz --adapter_sequence GTCAGATCGGAAGAGCACACGTCTGAACTCCAGTCAC --adapter_sequence_r2 CAGAGATCGGAAGAGCGTCGTGTAGGGAAAGAC --cut_right --cut_window_size 4 --cut_mean_quality 20 --length_required 36 --length_limit 150 --average_qual 19 --thread 8 --json /home/data/acropora_db/adapter_trim/AG_GAs11-67_S67_fastp.json --html /home/data/acropora_db/adapter_trim/AG_GAs11-67_S67_fastp.html
[2024-10-05 18:02:17,100] INFO database_accessor.py execute_cmd :
Read1 before filtering:
total reads: 79298
total bases: 5996604
Q20 bases: 5914403(98.6292%)
Q30 bases: 5679288(94.7084%)

Read2 before filtering:
total reads: 79298
total bases: 5490991
Q20 bases: 5383923(98.0501%)
Q30 bases: 5084929(92.6049%)

Read1 after filtering:
total reads: 51622
total bases: 3958367
Q20 bases: 3921935(99.0796%)
Q30 bases: 3800062(96.0007%)

Read2 after filtering:
total reads: 51622
total bases: 3772927
Q20 bases: 3718987(98.5703%)
Q30 bases: 3556932(94.2751%)

Filtering result:
reads passed filter: 103244
reads failed due to low quality: 0
reads failed due to too many N: 0
reads failed due to too short: 55352
reads failed due to too long: 0
reads with adapter trimmed: 51133
bases trimmed due to adapters: 2655651

Duplication rate: 46.0642%

Insert size peak (evaluated by paired-end reads): 49

JSON report: /home/data/acropora_db/adapter_trim/AG_GAs11-67_S67_fastp.json
HTML report: /home/data/acropora_db/adapter_trim/AG_GAs11-67_S67_fastp.html

fastp -i /home/data/acropora_db/quality_control/AG_GAs11-67_S67_qc_R1.fastq.gz -I /home/data/acropora_db/quality_control/AG_GAs11-67_S67_qc_R2.fastq.gz -o /home/data/acropora_db/adapter_trim/AG_GAs11-67_S67_at_R1.fastq.gz -O /home/data/acropora_db/adapter_trim/AG_GAs11-67_S67_at_R2.fastq.gz --adapter_sequence GTCAGATCGGAAGAGCACACGTCTGAACTCCAGTCAC --adapter_sequence_r2 CAGAGATCGGAAGAGCGTCGTGTAGGGAAAGAC --cut_right --cut_window_size 4 --cut_mean_quality 20 --length_required 36 --length_limit 150 --average_qual 19 --thread 8 --json /home/data/acropora_db/adapter_trim/AG_GAs11-67_S67_fastp.json --html /home/data/acropora_db/adapter_trim/AG_GAs11-67_S67_fastp.html 
fastp v0.23.4, time used: 1 seconds

[2024-10-05 18:02:17,100] INFO database_accessor.py execute_cmd :
[cmd] fastp -i /home/data/acropora_db/quality_control/AS_ASTUS31_S161_qc_R1.fastq.gz -I /home/data/acropora_db/quality_control/AS_ASTUS31_S161_qc_R2.fastq.gz -o /home/data/acropora_db/adapter_trim/AS_ASTUS31_S161_at_R1.fastq.gz -O /home/data/acropora_db/adapter_trim/AS_ASTUS31_S161_at_R2.fastq.gz --adapter_sequence GTCAGATCGGAAGAGCACACGTCTGAACTCCAGTCAC --adapter_sequence_r2 CAGAGATCGGAAGAGCGTCGTGTAGGGAAAGAC --cut_right --cut_window_size 4 --cut_mean_quality 20 --length_required 36 --length_limit 150 --average_qual 19 --thread 8 --json /home/data/acropora_db/adapter_trim/AS_ASTUS31_S161_fastp.json --html /home/data/acropora_db/adapter_trim/AS_ASTUS31_S161_fastp.html
[2024-10-05 18:02:17,742] INFO database_accessor.py execute_cmd :
Read1 before filtering:
total reads: 158521
total bases: 12084495
Q20 bases: 11964325(99.0056%)
Q30 bases: 11633921(96.2715%)

Read2 before filtering:
total reads: 158521
total bases: 11411898
Q20 bases: 11287906(98.9135%)
Q30 bases: 10913654(95.634%)

Read1 after filtering:
total reads: 79051
total bases: 5841951
Q20 bases: 5798389(99.2543%)
Q30 bases: 5670180(97.0597%)

Read2 after filtering:
total reads: 79051
total bases: 5438862
Q20 bases: 5399343(99.2734%)
Q30 bases: 5262418(96.7559%)

Filtering result:
reads passed filter: 158102
reads failed due to low quality: 0
reads failed due to too many N: 0
reads failed due to too short: 158940
reads failed due to too long: 0
reads with adapter trimmed: 154518
bases trimmed due to adapters: 8207681

Duplication rate: 58.0768%

Insert size peak (evaluated by paired-end reads): 80

JSON report: /home/data/acropora_db/adapter_trim/AS_ASTUS31_S161_fastp.json
HTML report: /home/data/acropora_db/adapter_trim/AS_ASTUS31_S161_fastp.html

fastp -i /home/data/acropora_db/quality_control/AS_ASTUS31_S161_qc_R1.fastq.gz -I /home/data/acropora_db/quality_control/AS_ASTUS31_S161_qc_R2.fastq.gz -o /home/data/acropora_db/adapter_trim/AS_ASTUS31_S161_at_R1.fastq.gz -O /home/data/acropora_db/adapter_trim/AS_ASTUS31_S161_at_R2.fastq.gz --adapter_sequence GTCAGATCGGAAGAGCACACGTCTGAACTCCAGTCAC --adapter_sequence_r2 CAGAGATCGGAAGAGCGTCGTGTAGGGAAAGAC --cut_right --cut_window_size 4 --cut_mean_quality 20 --length_required 36 --length_limit 150 --average_qual 19 --thread 8 --json /home/data/acropora_db/adapter_trim/AS_ASTUS31_S161_fastp.json --html /home/data/acropora_db/adapter_trim/AS_ASTUS31_S161_fastp.html 
fastp v0.23.4, time used: 0 seconds

[2024-10-05 18:02:17,743] INFO database_accessor.py adapter_trim :
所有样本的接头修剪已完成
[2024-10-05 18:02:17,743] INFO database_accessor.py logging_title :

#########################
#### fastq 转换为 fasta ####
#########################
[2024-10-05 18:02:17,743] INFO database_accessor.py execute_cmd :
[cmd] seqkit fq2fa -o /home/data/acropora_db/fasta/AP_TS1_S1.fasta.gz /home/data/acropora_db/adapter_trim/AP_TS1_S1_at_R1.fastq.gz /home/data/acropora_db/adapter_trim/AP_TS1_S1_at_R2.fastq.gz
[2024-10-05 18:02:18,108] INFO database_accessor.py execute_cmd :
[cmd] seqkit fq2fa -o /home/data/acropora_db/fasta/AM_A-1_S33.fasta.gz /home/data/acropora_db/adapter_trim/AM_A-1_S33_at_R1.fastq.gz /home/data/acropora_db/adapter_trim/AM_A-1_S33_at_R2.fastq.gz
[2024-10-05 18:02:18,265] INFO database_accessor.py execute_cmd :
[cmd] seqkit fq2fa -o /home/data/acropora_db/fasta/AG_GAs11-67_S67.fasta.gz /home/data/acropora_db/adapter_trim/AG_GAs11-67_S67_at_R1.fastq.gz /home/data/acropora_db/adapter_trim/AG_GAs11-67_S67_at_R2.fastq.gz
[2024-10-05 18:02:18,385] INFO database_accessor.py execute_cmd :
[cmd] seqkit fq2fa -o /home/data/acropora_db/fasta/AS_ASTUS31_S161.fasta.gz /home/data/acropora_db/adapter_trim/AS_ASTUS31_S161_at_R1.fastq.gz /home/data/acropora_db/adapter_trim/AS_ASTUS31_S161_at_R2.fastq.gz
[2024-10-05 18:02:18,680] INFO database_accessor.py fastq_to_fasta :
所有样本的 FASTQ 到 FASTA 转换已完成
[2024-10-05 18:02:18,680] INFO database_accessor.py execute_cmd :
[cmd] seqkit seq -m 80 -M 80 /home/data/acropora_db/fasta/AP_TS1_S1.fasta.gz | gzip > /home/data/acropora_db/fasta/AP_TS1_S1_uniform.fasta.gz
[2024-10-05 18:02:19,588] INFO database_accessor.py execute_cmd :
[33m[WARN][0m you may switch on flag -g/--remove-gaps to remove spaces

[2024-10-05 18:02:19,588] INFO database_accessor.py execute_cmd :
[cmd] seqkit seq -m 80 -M 80 /home/data/acropora_db/fasta/AM_A-1_S33.fasta.gz | gzip > /home/data/acropora_db/fasta/AM_A-1_S33_uniform.fasta.gz
[2024-10-05 18:02:20,064] INFO database_accessor.py execute_cmd :
[33m[WARN][0m you may switch on flag -g/--remove-gaps to remove spaces

[2024-10-05 18:02:20,064] INFO database_accessor.py execute_cmd :
[cmd] seqkit seq -m 80 -M 80 /home/data/acropora_db/fasta/AG_GAs11-67_S67.fasta.gz | gzip > /home/data/acropora_db/fasta/AG_GAs11-67_S67_uniform.fasta.gz
[2024-10-05 18:02:20,454] INFO database_accessor.py execute_cmd :
[33m[WARN][0m you may switch on flag -g/--remove-gaps to remove spaces

[2024-10-05 18:02:20,454] INFO database_accessor.py execute_cmd :
[cmd] seqkit seq -m 80 -M 80 /home/data/acropora_db/fasta/AS_ASTUS31_S161.fasta.gz | gzip > /home/data/acropora_db/fasta/AS_ASTUS31_S161_uniform.fasta.gz
[2024-10-05 18:02:20,960] INFO database_accessor.py execute_cmd :
[33m[WARN][0m you may switch on flag -g/--remove-gaps to remove spaces

[2024-10-05 18:02:20,960] INFO database_accessor.py logging_title :

#################
#### ustacks ####
#################
[2024-10-05 18:02:20,960] INFO database_accessor.py stacks :
Running ustacks for sample: AP_TS1_S1
[2024-10-05 18:02:20,960] INFO database_accessor.py stacks :
Command: ustacks -f /home/data/acropora_db/fasta/AP_TS1_S1_uniform.fasta.gz -o /home/data/acropora_db/ustacks --name AP_TS1_S1 -i 1 -m 3 -M 2 -p 8
[2024-10-05 18:02:20,960] INFO database_accessor.py execute_cmd :
[cmd] ustacks -f /home/data/acropora_db/fasta/AP_TS1_S1_uniform.fasta.gz -o /home/data/acropora_db/ustacks --name AP_TS1_S1 -i 1 -m 3 -M 2 -p 8
[2024-10-05 18:02:22,210] INFO database_accessor.py execute_cmd :
ustacks parameters selected:
  Input file: '/home/data/acropora_db/fasta/AP_TS1_S1_uniform.fasta.gz'
  Sample ID: 1
  Min depth of coverage to create a stack (m): 3
  Repeat removal algorithm: enabled
  Max distance allowed between stacks (M): 2
  Max distance allowed to align secondary reads: 4
  Max number of stacks allowed per de novo locus: 3
  Deleveraging algorithm: disabled
  Gapped assembly: enabled
  Minimum alignment length: 0.8
  Model type: SNP
  Alpha significance level for model: 0.05

Loading RAD-Tags...

Loaded 132844 reads; formed:
  4103 stacks representing 106978 primary reads (80.5%)
  23273 secondary stacks representing 25866 secondary reads (19.5%)

Stack coverage: mean=26.07; stdev=162.96; max=3789; n_reads=106978(80.5%)
Removing repetitive stacks: cov > 515 (mean+3*stdev)...
  Blacklisted 810 stacks.
Coverage after repeat removal: mean=18.76; stdev=45.94; max=503; n_reads=61763(46.5%)

Assembling stacks (max. dist. M=2)...
  Assembled 3293 stacks into 2828; blacklisted 37 stacks.
Coverage after assembling stacks: mean=18.73; stdev=41.41; max=505; n_reads=51877(39.1%)

Merging secondary stacks (max. dist. N=4 from consensus)...
  Merged 10842 out of 25866 secondary reads (41.9%), 1929 merged with gapped alignments.
Coverage after merging secondary stacks: mean=22.64; stdev=48.36; max=558; n_reads=62719(47.2%)

Assembling stacks, allowing for gaps (min. match length 80.0%)...
  Assembled 2828 stacks into 2189 stacks.
Coverage after gapped assembly: mean=29.43; stdev=59.87; max=729; n_reads=62719(47.2%)

Merging secondary stacks, allowing for gaps (min. match length 80.0%)...
  Merged 5526 out of 15024 secondary reads (36.8%).
Coverage after merging gapped secondary stacks: mean=32.02; stdev=61.94; max=735; n_reads=68245(51.4%)

Final number of stacks built: 2189
Final coverage: mean=32.02; stdev=61.94; max=735; n_reads=68245(51.4%)
Calling consensus sequences and haplotypes for catalog assembly...
Writing tags, SNPs, and alleles files to '/home/data/acropora_db/ustacks/AP_TS1_S1'...done.
ustacks is done.

[2024-10-05 18:02:22,210] INFO database_accessor.py stacks :
ustacks successfully processed sample: AP_TS1_S1
[2024-10-05 18:02:22,211] INFO database_accessor.py stacks :
Running ustacks for sample: AM_A-1_S33
[2024-10-05 18:02:22,211] INFO database_accessor.py stacks :
Command: ustacks -f /home/data/acropora_db/fasta/AM_A-1_S33_uniform.fasta.gz -o /home/data/acropora_db/ustacks --name AM_A-1_S33 -i 2 -m 3 -M 2 -p 8
[2024-10-05 18:02:22,211] INFO database_accessor.py execute_cmd :
[cmd] ustacks -f /home/data/acropora_db/fasta/AM_A-1_S33_uniform.fasta.gz -o /home/data/acropora_db/ustacks --name AM_A-1_S33 -i 2 -m 3 -M 2 -p 8
[2024-10-05 18:02:22,773] INFO database_accessor.py execute_cmd :
ustacks parameters selected:
  Input file: '/home/data/acropora_db/fasta/AM_A-1_S33_uniform.fasta.gz'
  Sample ID: 2
  Min depth of coverage to create a stack (m): 3
  Repeat removal algorithm: enabled
  Max distance allowed between stacks (M): 2
  Max distance allowed to align secondary reads: 4
  Max number of stacks allowed per de novo locus: 3
  Deleveraging algorithm: disabled
  Gapped assembly: enabled
  Minimum alignment length: 0.8
  Model type: SNP
  Alpha significance level for model: 0.05

Loading RAD-Tags...

Loaded 50057 reads; formed:
  2023 stacks representing 35081 primary reads (70.1%)
  13554 secondary stacks representing 14976 secondary reads (29.9%)

Stack coverage: mean=17.34; stdev=44.82; max=818; n_reads=35081(70.1%)
Removing repetitive stacks: cov > 152 (mean+3*stdev)...
  Blacklisted 98 stacks.
Coverage after repeat removal: mean=13.00; stdev=19.48; max=149; n_reads=25028(50.0%)

Assembling stacks (max. dist. M=2)...
  Assembled 1925 stacks into 1721; blacklisted 16 stacks.
Coverage after assembling stacks: mean=13.89; stdev=22.36; max=262; n_reads=23288(46.5%)

Merging secondary stacks (max. dist. N=4 from consensus)...
  Merged 5032 out of 14976 secondary reads (33.6%), 440 merged with gapped alignments.
Coverage after merging secondary stacks: mean=16.89; stdev=26.65; max=305; n_reads=28320(56.6%)

Assembling stacks, allowing for gaps (min. match length 80.0%)...
  Assembled 1721 stacks into 1565 stacks.
Coverage after gapped assembly: mean=18.62; stdev=28.79; max=305; n_reads=28320(56.6%)

Merging secondary stacks, allowing for gaps (min. match length 80.0%)...
  Merged 2582 out of 9944 secondary reads (26.0%).
Coverage after merging gapped secondary stacks: mean=20.32; stdev=30.47; max=306; n_reads=30902(61.7%)

Final number of stacks built: 1565
Final coverage: mean=20.32; stdev=30.47; max=306; n_reads=30902(61.7%)
Calling consensus sequences and haplotypes for catalog assembly...
Writing tags, SNPs, and alleles files to '/home/data/acropora_db/ustacks/AM_A-1_S33'...done.
ustacks is done.

[2024-10-05 18:02:22,773] INFO database_accessor.py stacks :
ustacks successfully processed sample: AM_A-1_S33
[2024-10-05 18:02:22,773] INFO database_accessor.py stacks :
Running ustacks for sample: AG_GAs11-67_S67
[2024-10-05 18:02:22,773] INFO database_accessor.py stacks :
Command: ustacks -f /home/data/acropora_db/fasta/AG_GAs11-67_S67_uniform.fasta.gz -o /home/data/acropora_db/ustacks --name AG_GAs11-67_S67 -i 3 -m 3 -M 2 -p 8
[2024-10-05 18:02:22,774] INFO database_accessor.py execute_cmd :
[cmd] ustacks -f /home/data/acropora_db/fasta/AG_GAs11-67_S67_uniform.fasta.gz -o /home/data/acropora_db/ustacks --name AG_GAs11-67_S67 -i 3 -m 3 -M 2 -p 8
[2024-10-05 18:02:23,247] INFO database_accessor.py execute_cmd :
ustacks parameters selected:
  Input file: '/home/data/acropora_db/fasta/AG_GAs11-67_S67_uniform.fasta.gz'
  Sample ID: 3
  Min depth of coverage to create a stack (m): 3
  Repeat removal algorithm: enabled
  Max distance allowed between stacks (M): 2
  Max distance allowed to align secondary reads: 4
  Max number of stacks allowed per de novo locus: 3
  Deleveraging algorithm: disabled
  Gapped assembly: enabled
  Minimum alignment length: 0.8
  Model type: SNP
  Alpha significance level for model: 0.05

Loading RAD-Tags...
Warning: Input reads contained 1 uncalled nucleotides.

Loaded 42595 reads; formed:
  1734 stacks representing 29473 primary reads (69.2%)
  11868 secondary stacks representing 13122 secondary reads (30.8%)

Stack coverage: mean=17.00; stdev=60.60; max=1955; n_reads=29473(69.2%)
Removing repetitive stacks: cov > 199 (mean+3*stdev)...
  Blacklisted 121 stacks.
Coverage after repeat removal: mean=13.16; stdev=21.91; max=190; n_reads=21222(49.8%)

Assembling stacks (max. dist. M=2)...
  Assembled 1613 stacks into 1408; blacklisted 17 stacks.
Coverage after assembling stacks: mean=13.95; stdev=22.82; max=194; n_reads=19161(45.0%)

Merging secondary stacks (max. dist. N=4 from consensus)...
  Merged 4822 out of 13122 secondary reads (36.7%), 638 merged with gapped alignments.
Coverage after merging secondary stacks: mean=17.45; stdev=27.76; max=227; n_reads=23983(56.3%)

Assembling stacks, allowing for gaps (min. match length 80.0%)...
  Assembled 1408 stacks into 1304 stacks.
Coverage after gapped assembly: mean=18.88; stdev=29.77; max=227; n_reads=23983(56.3%)

Merging secondary stacks, allowing for gaps (min. match length 80.0%)...
  Merged 1510 out of 8300 secondary reads (18.2%).
Coverage after merging gapped secondary stacks: mean=20.07; stdev=30.71; max=228; n_reads=25493(59.8%)

Final number of stacks built: 1304
Final coverage: mean=20.07; stdev=30.71; max=228; n_reads=25493(59.8%)
Calling consensus sequences and haplotypes for catalog assembly...
Writing tags, SNPs, and alleles files to '/home/data/acropora_db/ustacks/AG_GAs11-67_S67'...done.
ustacks is done.

[2024-10-05 18:02:23,248] INFO database_accessor.py stacks :
ustacks successfully processed sample: AG_GAs11-67_S67
[2024-10-05 18:02:23,248] INFO database_accessor.py stacks :
Running ustacks for sample: AS_ASTUS31_S161
[2024-10-05 18:02:23,248] INFO database_accessor.py stacks :
Command: ustacks -f /home/data/acropora_db/fasta/AS_ASTUS31_S161_uniform.fasta.gz -o /home/data/acropora_db/ustacks --name AS_ASTUS31_S161 -i 4 -m 3 -M 2 -p 8
[2024-10-05 18:02:23,248] INFO database_accessor.py execute_cmd :
[cmd] ustacks -f /home/data/acropora_db/fasta/AS_ASTUS31_S161_uniform.fasta.gz -o /home/data/acropora_db/ustacks --name AS_ASTUS31_S161 -i 4 -m 3 -M 2 -p 8
[2024-10-05 18:02:23,906] INFO database_accessor.py execute_cmd :
ustacks parameters selected:
  Input file: '/home/data/acropora_db/fasta/AS_ASTUS31_S161_uniform.fasta.gz'
  Sample ID: 4
  Min depth of coverage to create a stack (m): 3
  Repeat removal algorithm: enabled
  Max distance allowed between stacks (M): 2
  Max distance allowed to align secondary reads: 4
  Max number of stacks allowed per de novo locus: 3
  Deleveraging algorithm: disabled
  Gapped assembly: enabled
  Minimum alignment length: 0.8
  Model type: SNP
  Alpha significance level for model: 0.05

Loading RAD-Tags...
Warning: Input reads contained 28 uncalled nucleotides.

Loaded 53942 reads; formed:
  2358 stacks representing 34094 primary reads (63.2%)
  18039 secondary stacks representing 19848 secondary reads (36.8%)

Stack coverage: mean=14.46; stdev=53.71; max=1311; n_reads=34094(63.2%)
Removing repetitive stacks: cov > 176 (mean+3*stdev)...
  Blacklisted 206 stacks.
Coverage after repeat removal: mean=10.86; stdev=17.90; max=174; n_reads=23378(43.3%)

Assembling stacks (max. dist. M=2)...
  Assembled 2152 stacks into 1737; blacklisted 36 stacks.
Coverage after assembling stacks: mean=11.62; stdev=17.83; max=181; n_reads=19559(36.3%)

Merging secondary stacks (max. dist. N=4 from consensus)...
  Merged 7119 out of 19848 secondary reads (35.9%), 1155 merged with gapped alignments.
Coverage after merging secondary stacks: mean=15.85; stdev=23.02; max=217; n_reads=26678(49.5%)

Assembling stacks, allowing for gaps (min. match length 80.0%)...
  Assembled 1737 stacks into 1626 stacks.
Coverage after gapped assembly: mean=16.97; stdev=24.30; max=225; n_reads=26678(49.5%)

Merging secondary stacks, allowing for gaps (min. match length 80.0%)...
  Merged 2847 out of 12729 secondary reads (22.4%).
Coverage after merging gapped secondary stacks: mean=18.78; stdev=27.32; max=292; n_reads=29525(54.7%)

Final number of stacks built: 1626
Final coverage: mean=18.78; stdev=27.32; max=292; n_reads=29525(54.7%)
Calling consensus sequences and haplotypes for catalog assembly...
Writing tags, SNPs, and alleles files to '/home/data/acropora_db/ustacks/AS_ASTUS31_S161'...done.
ustacks is done.

[2024-10-05 18:02:23,906] INFO database_accessor.py stacks :
ustacks successfully processed sample: AS_ASTUS31_S161
[2024-10-05 18:02:23,907] INFO database_accessor.py run :
stacks 处理完成
[2024-10-05 18:02:23,907] INFO database_accessor.py run :
当前 files_to_process: {'AP_TS1_S1': '/home/data/acropora_db/ustacks/AP_TS1_S1.tags.tsv.gz', 'AM_A-1_S33': '/home/data/acropora_db/ustacks/AM_A-1_S33.tags.tsv.gz', 'AG_GAs11-67_S67': '/home/data/acropora_db/ustacks/AG_GAs11-67_S67.tags.tsv.gz', 'AS_ASTUS31_S161': '/home/data/acropora_db/ustacks/AS_ASTUS31_S161.tags.tsv.gz'}
[2024-10-05 18:02:23,907] INFO database_accessor.py logging_title :

#################################
#### extract consensus fasta ####
#################################
[2024-10-05 18:02:23,907] INFO database_accessor.py extract_consensus_fasta :
[cmd] zcat /home/data/acropora_db/ustacks/AP_TS1_S1.tags.tsv.gz | awk '{if($3=="consensus") {printf ">AP_TS1_S1_%d\n%s\n", NR, $4}}' > /home/data/acropora_db/consensus_fasta/AP_TS1_S1.fa
[2024-10-05 18:02:23,907] INFO database_accessor.py execute_cmd :
[cmd] zcat /home/data/acropora_db/ustacks/AP_TS1_S1.tags.tsv.gz | awk '{if($3=="consensus") {printf ">AP_TS1_S1_%d\n%s\n", NR, $4}}' > /home/data/acropora_db/consensus_fasta/AP_TS1_S1.fa
[2024-10-05 18:02:23,976] INFO database_accessor.py extract_consensus_fasta :
成功生成共识序列文件: /home/data/acropora_db/consensus_fasta/AP_TS1_S1.fa
[2024-10-05 18:02:23,976] INFO database_accessor.py extract_consensus_fasta :
检查生成的 FASTA 文件: /home/data/acropora_db/consensus_fasta/AP_TS1_S1.fa
[2024-10-05 18:02:23,976] INFO database_accessor.py execute_cmd :
[cmd] head -n 10 /home/data/acropora_db/consensus_fasta/AP_TS1_S1.fa
[2024-10-05 18:02:23,977] INFO database_accessor.py execute_cmd :
>AP_TS1_S1_2
TGTTCTACCACACCCTGAACACTCCAATGTCTATGTTTCCCAACCTTATGAAGCGATACCGGACCAACTCCATATTTTGCAGG
>AP_TS1_S1_57
TCGTTTCCAAAGACTTCGCGCTCGCGTCGGTTTTTTGGTTTTTTTCCGACTAAGTTCGGGTTCCTCGTCTTCTTCTTCGGAAC
>AP_TS1_S1_155
CTTCTCTCTTCCAGTCTCTGCCTGTATTTTTCATGAGCTCGTCTAATGCATGAAATAAACTCCTTGTTGAAGTCCATGGCATG
>AP_TS1_S1_190
ACACAACATTCGACAGAAGGAACATGGATGAATATGGCCCCTTACTGGAATTGAACATCTGCAAAATAGGTCCGGTACAAGG
>AP_TS1_S1_230
CCCTTTTTACTCAGAACAAATGTAAGATGGCTGGAATTTCGTTAGTTCAAATTACCATATGACTTGATCTGCATTCGCTTT

[2024-10-05 18:02:23,977] INFO database_accessor.py extract_consensus_fasta :
[cmd] zcat /home/data/acropora_db/ustacks/AM_A-1_S33.tags.tsv.gz | awk '{if($3=="consensus") {printf ">AM_A-1_S33_%d\n%s\n", NR, $4}}' > /home/data/acropora_db/consensus_fasta/AM_A-1_S33.fa
[2024-10-05 18:02:23,977] INFO database_accessor.py execute_cmd :
[cmd] zcat /home/data/acropora_db/ustacks/AM_A-1_S33.tags.tsv.gz | awk '{if($3=="consensus") {printf ">AM_A-1_S33_%d\n%s\n", NR, $4}}' > /home/data/acropora_db/consensus_fasta/AM_A-1_S33.fa
[2024-10-05 18:02:24,002] INFO database_accessor.py extract_consensus_fasta :
成功生成共识序列文件: /home/data/acropora_db/consensus_fasta/AM_A-1_S33.fa
[2024-10-05 18:02:24,002] INFO database_accessor.py extract_consensus_fasta :
检查生成的 FASTA 文件: /home/data/acropora_db/consensus_fasta/AM_A-1_S33.fa
[2024-10-05 18:02:24,002] INFO database_accessor.py execute_cmd :
[cmd] head -n 10 /home/data/acropora_db/consensus_fasta/AM_A-1_S33.fa
[2024-10-05 18:02:24,003] INFO database_accessor.py execute_cmd :
>AM_A-1_S33_2
CTCGAAAAAGTCGCCTTTTCCATCAATTACGCTTTAAGAGTAACATGTTATTCTGGTTTAAGTCAAGAAACAAAAATTTTAAC
>AM_A-1_S33_30
TATTCGGACAAATTTCCCTAAAATGTTTTGCAGTTCGTGCGGTGGGGAATGCCCTTCAACCGCAAATTTCTGTCATCAATGT
>AM_A-1_S33_71
CACTGAGTAACAGTGCAAAAATTGGAGTTTTCAAAACCACAATTTTCTGTGATGAAGTTTCACTTCTGTTGCTTCATGACCCA
>AM_A-1_S33_165
CCGGTTGGTTTGGCAGAGACAGCAGCGTCTTGCATGCTTTTAGCTTGACCGGTGATCTCGTGGCCATGTGCATTGCTTTTGG
>AM_A-1_S33_217
CCGGGCTTTCCTCAACAGAAACTGTGGCTTGAAAAAATATAGGTTGTTACATTATGTTGACAAGCAAGAAAAAGAAGTAACC

[2024-10-05 18:02:24,003] INFO database_accessor.py extract_consensus_fasta :
[cmd] zcat /home/data/acropora_db/ustacks/AG_GAs11-67_S67.tags.tsv.gz | awk '{if($3=="consensus") {printf ">AG_GAs11-67_S67_%d\n%s\n", NR, $4}}' > /home/data/acropora_db/consensus_fasta/AG_GAs11-67_S67.fa
[2024-10-05 18:02:24,003] INFO database_accessor.py execute_cmd :
[cmd] zcat /home/data/acropora_db/ustacks/AG_GAs11-67_S67.tags.tsv.gz | awk '{if($3=="consensus") {printf ">AG_GAs11-67_S67_%d\n%s\n", NR, $4}}' > /home/data/acropora_db/consensus_fasta/AG_GAs11-67_S67.fa
[2024-10-05 18:02:24,024] INFO database_accessor.py extract_consensus_fasta :
成功生成共识序列文件: /home/data/acropora_db/consensus_fasta/AG_GAs11-67_S67.fa
[2024-10-05 18:02:24,024] INFO database_accessor.py extract_consensus_fasta :
检查生成的 FASTA 文件: /home/data/acropora_db/consensus_fasta/AG_GAs11-67_S67.fa
[2024-10-05 18:02:24,024] INFO database_accessor.py execute_cmd :
[cmd] head -n 10 /home/data/acropora_db/consensus_fasta/AG_GAs11-67_S67.fa
[2024-10-05 18:02:24,025] INFO database_accessor.py execute_cmd :
>AG_GAs11-67_S67_2
ACGAAGTACACGAGCGACACATTCACGGAGATTTTCTTTTGGGCGTGTTACGTGGTTTGTTGCAAGCGCGCGCAGATCTCAAG
>AG_GAs11-67_S67_199
GTCCACTTCGTCAAAATCGTCCAATTCTAGAGCTACACTCGCGGTTTATAATCCCTCTGAATGCTGTTCGACTTCAGAAGCTGA
>AG_GAs11-67_S67_213
TCATGCCTTTTTTGGGAGATGAGAGTCAAAGGACACTCTGTAATAAAAATTATGCACTGGAATGCATATCAGCATTGCCCTACT
>AG_GAs11-67_S67_342
TGCCGTTTTGTGTTTTTTTTTTTATTTTGCCTTAATGCATTGTGTGTAATCACTTGATCAAAGTGATGTATTTAATGATTCT
>AG_GAs11-67_S67_371
CGCTGAAGTTAAACTTTCTTTTCAGGAGTCGTTCAAAATCGCGTTCCAGATCTCGTTCTGGCTCCAAGTCTCGCTCAAGAA

[2024-10-05 18:02:24,025] INFO database_accessor.py extract_consensus_fasta :
[cmd] zcat /home/data/acropora_db/ustacks/AS_ASTUS31_S161.tags.tsv.gz | awk '{if($3=="consensus") {printf ">AS_ASTUS31_S161_%d\n%s\n", NR, $4}}' > /home/data/acropora_db/consensus_fasta/AS_ASTUS31_S161.fa
[2024-10-05 18:02:24,025] INFO database_accessor.py execute_cmd :
[cmd] zcat /home/data/acropora_db/ustacks/AS_ASTUS31_S161.tags.tsv.gz | awk '{if($3=="consensus") {printf ">AS_ASTUS31_S161_%d\n%s\n", NR, $4}}' > /home/data/acropora_db/consensus_fasta/AS_ASTUS31_S161.fa
[2024-10-05 18:02:24,051] INFO database_accessor.py extract_consensus_fasta :
成功生成共识序列文件: /home/data/acropora_db/consensus_fasta/AS_ASTUS31_S161.fa
[2024-10-05 18:02:24,051] INFO database_accessor.py extract_consensus_fasta :
检查生成的 FASTA 文件: /home/data/acropora_db/consensus_fasta/AS_ASTUS31_S161.fa
[2024-10-05 18:02:24,051] INFO database_accessor.py execute_cmd :
[cmd] head -n 10 /home/data/acropora_db/consensus_fasta/AS_ASTUS31_S161.fa
[2024-10-05 18:02:24,051] INFO database_accessor.py execute_cmd :
>AS_ASTUS31_S161_2
GACGTAGCATAATGATTCAGTTTCAGTTTTTACAAATATCACTCTCGCTGCAGATAAACTGAGAAAGCAAAAACAAAGACAGGAA
>AS_ASTUS31_S161_164
CCTGCATGTTGGCTAGCAATTGCCCGCACCGGTGTTGGAACTAAGCCAGCCTTGGGTGGCACCACAGTATTTTCAACATCTT
>AS_ASTUS31_S161_191
CCTGCAATGCTTTCAGTTTTTCCTCCATGTACTCCTAGAGGACAAAAGCAACAAGAAAAGAAAAGAAAAAAGAATTTAGCTG
>AS_ASTUS31_S161_253
CCAAAAAGTTCTCAAAAAAACAAAATTTTAACTATGGATTAATTATTTTTATCTTTTTTCTAAGGACCCATTTCTGAGGTACAAGGAG
>AS_ASTUS31_S161_270
CCTTTTTTGGCGAATGAACCAGTATTATCCGCCCCAGTTAAGGTATGGAAAGAAGGTAGTGCTGCTGTTTTTAAAGGGCCAA

[2024-10-05 18:02:24,052] INFO database_accessor.py logging_title :

######################
#### make blastdb ####
######################
[2024-10-05 18:02:24,052] INFO database_accessor.py make_blastdb :
合并 FASTA 文件到: /home/data/acropora_db/blastdb/merged_consensus.fasta
[2024-10-05 18:02:24,052] INFO database_accessor.py execute_cmd :
[cmd] cat /home/data/acropora_db/consensus_fasta/AP_TS1_S1.fa /home/data/acropora_db/consensus_fasta/AM_A-1_S33.fa /home/data/acropora_db/consensus_fasta/AG_GAs11-67_S67.fa /home/data/acropora_db/consensus_fasta/AS_ASTUS31_S161.fa > /home/data/acropora_db/blastdb/merged_consensus.fasta
[2024-10-05 18:02:24,054] INFO database_accessor.py make_blastdb :
检查合并后的 FASTA 文件格式
[2024-10-05 18:02:24,054] INFO database_accessor.py execute_cmd :
[cmd] head -n 10 /home/data/acropora_db/blastdb/merged_consensus.fasta
[2024-10-05 18:02:24,055] INFO database_accessor.py execute_cmd :
>AP_TS1_S1_2
TGTTCTACCACACCCTGAACACTCCAATGTCTATGTTTCCCAACCTTATGAAGCGATACCGGACCAACTCCATATTTTGCAGG
>AP_TS1_S1_57
TCGTTTCCAAAGACTTCGCGCTCGCGTCGGTTTTTTGGTTTTTTTCCGACTAAGTTCGGGTTCCTCGTCTTCTTCTTCGGAAC
>AP_TS1_S1_155
CTTCTCTCTTCCAGTCTCTGCCTGTATTTTTCATGAGCTCGTCTAATGCATGAAATAAACTCCTTGTTGAAGTCCATGGCATG
>AP_TS1_S1_190
ACACAACATTCGACAGAAGGAACATGGATGAATATGGCCCCTTACTGGAATTGAACATCTGCAAAATAGGTCCGGTACAAGG
>AP_TS1_S1_230
CCCTTTTTACTCAGAACAAATGTAAGATGGCTGGAATTTCGTTAGTTCAAATTACCATATGACTTGATCTGCATTCGCTTT

[2024-10-05 18:02:24,055] INFO database_accessor.py make_blastdb :
创建 BLAST 数据库: /home/data/acropora_db/blastdb/acropora_db
[2024-10-05 18:02:24,055] INFO database_accessor.py execute_cmd :
[cmd] makeblastdb -in /home/data/acropora_db/blastdb/merged_consensus.fasta -out /home/data/acropora_db/blastdb/acropora_db -dbtype nucl -parse_seqids
[2024-10-05 18:02:24,117] INFO database_accessor.py execute_cmd :


Building a new DB, current time: 10/05/2024 18:02:24
New DB name:   /home/data/acropora_db/blastdb/acropora_db
New DB title:  /home/data/acropora_db/blastdb/merged_consensus.fasta
Sequence type: Nucleotide
Deleted existing Nucleotide BLAST database named /home/data/acropora_db/blastdb/acropora_db
Keep MBits: T
Maximum file size: 1000000000B
Adding sequences from FASTA; added 6684 sequences in 0.0388889 seconds.



[2024-10-05 18:02:24,118] INFO database_accessor.py make_blastdb :
BLAST 数据库创建成功: /home/data/acropora_db/blastdb/acropora_db
[2024-10-05 18:02:24,118] INFO database_accessor.py make_blastdb :
BLAST 数据库目录内容:
[2024-10-05 18:02:24,118] INFO database_accessor.py execute_cmd :
[cmd] ls -l /home/data/acropora_db/blastdb
[2024-10-05 18:02:24,119] INFO database_accessor.py execute_cmd :
total 1908
-rw-r--r-- 1 root root 303104 Oct  5 18:02 acropora_db.ndb
-rw-r--r-- 1 root root 379459 Oct  5 18:02 acropora_db.nhr
-rw-r--r-- 1 root root  80348 Oct  5 18:02 acropora_db.nin
-rw-r--r-- 1 root root  26768 Oct  5 18:02 acropora_db.nog
-rw-r--r-- 1 root root 178947 Oct  5 18:02 acropora_db.nos
-rw-r--r-- 1 root root  80216 Oct  5 18:02 acropora_db.not
-rw-r--r-- 1 root root 140808 Oct  5 18:02 acropora_db.nsq
-rw-r--r-- 1 root root  16384 Oct  5 18:02 acropora_db.ntf
-rw-r--r-- 1 root root  26740 Oct  5 18:02 acropora_db.nto
-rw-r--r-- 1 root root 680423 Oct  5 18:02 merged_consensus.fasta

[2024-10-05 18:02:24,119] INFO database_accessor.py run :
处理完成
[2024-10-05 18:02:24,120] INFO ACF.py execute_cmd :
[cmd] cd /home/data/acropora_db/ && tree . > tree.txt
[2024-10-05 18:02:24,124] INFO ACF.py write_analysis_complete_flag :
ANCAT_ANALYSIS_COMPLETED
